function q(a){throw a}function y(a,b,c){4!==b.length&&q(new sjcl.exception.invalid("invalid aes block size"));var d=a.a[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,i,j,k,l=d.length/4-2,m=4,n=[0,0,0,0];h=a.j[c],a=h[0];var o=h[1],p=h[2],r=h[3],s=h[4];for(k=0;l>k;k++)h=a[e>>>24]^o[255&f>>16]^p[255&g>>8]^r[255&b]^d[m],i=a[f>>>24]^o[255&g>>16]^p[255&b>>8]^r[255&e]^d[m+1],j=a[g>>>24]^o[255&b>>16]^p[255&e>>8]^r[255&f]^d[m+2],b=a[b>>>24]^o[255&e>>16]^p[255&f>>8]^r[255&g]^d[m+3],m+=4,e=h,f=i,g=j;for(k=0;4>k;k++)n[c?3&-k:k]=s[e>>>24]<<24^s[255&f>>16]<<16^s[255&g>>8]<<8^s[255&b]^d[m++],h=e,e=f,f=g,g=b,b=h;return n}function z(a,b){var c,d,e,f=b.slice(0),g=a.q,h=a.a,i=g[0],j=g[1],k=g[2],l=g[3],m=g[4],n=g[5],o=g[6],p=g[7];for(c=0;64>c;c++)16>c?d=f[c]:(d=f[15&c+1],e=f[15&c+14],d=f[15&c]=0|(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+f[15&c]+f[15&c+9]),d=d+p+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(o^m&(n^o))+h[c],p=o,o=n,n=m,m=0|l+d,l=k,k=j,j=i,i=0|d+(j&k^l&(j^k))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10);g[0]=0|g[0]+i,g[1]=0|g[1]+j,g[2]=0|g[2]+k,g[3]=0|g[3]+l,g[4]=0|g[4]+m,g[5]=0|g[5]+n,g[6]=0|g[6]+o,g[7]=0|g[7]+p}function C(a,b){var c,d=sjcl.random.z[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function A(a){a.a=B(a).concat(B(a)),a.A=new sjcl.cipher.aes(a.a)}function B(a){for(var b=0;4>b&&(a.e[b]=0|a.e[b]+1,!a.e[b]);b++);return a.A.encrypt(a.e)}define("coffee-script",{}),define("cs",{load:function(a){throw new Error("Dynamic load not allowed: "+a)}}),define("common.config",{baseURL:"https://point.herokuapp.com/",notifBaseURL:"https://pointnotifier.herokuapp.com/",avatarsBaseUrl:"https://pointavatars.herokuapp.com/",mixpanelToken:"4141c15f6104afc65b1732b8566c7ddd",register:{}}),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b="length"in a&&a.length,c=_.type(a);return"function"===c||_.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(_.isFunction(b))return _.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return _.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(hb.test(b))return _.filter(b,a,c);b=_.filter(b,a)}return _.grep(a,function(a){return U.call(b,a)>=0!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=ob[a]={};return _.each(a.match(nb)||[],function(a,c){b[c]=!0}),b}function g(){Z.removeEventListener("DOMContentLoaded",g,!1),a.removeEventListener("load",g,!1),_.ready()}function h(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=_.expando+h.uid++}function i(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ub,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:tb.test(c)?_.parseJSON(c):c}catch(e){}sb.set(a,b,c)}else c=void 0;return c}function j(){return!0}function k(){return!1}function l(){try{return Z.activeElement}catch(a){}}function m(a,b){return _.nodeName(a,"table")&&_.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function n(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function o(a){var b=Kb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function p(a,b){for(var c=0,d=a.length;d>c;c++)rb.set(a[c],"globalEval",!b||rb.get(b[c],"globalEval"))}function q(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(rb.hasData(a)&&(f=rb.access(a),g=rb.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)_.event.add(b,e,j[e][c])}sb.hasData(a)&&(h=sb.access(a),i=_.extend({},h),sb.set(b,i))}}function r(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&_.nodeName(a,b)?_.merge([a],c):c}function s(a,b){var c=b.nodeName.toLowerCase();"input"===c&&yb.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}function t(b,c){var d,e=_(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:_.css(e[0],"display");return e.detach(),f}function u(a){var b=Z,c=Ob[a];return c||(c=t(a,b),"none"!==c&&c||(Nb=(Nb||_("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Nb[0].contentDocument,b.write(),b.close(),c=t(a,b),Nb.detach()),Ob[a]=c),c}function v(a,b,c){var d,e,f,g,h=a.style;return c=c||Rb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||_.contains(a.ownerDocument,a)||(g=_.style(a,b)),Qb.test(g)&&Pb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function w(a,b){return{get:function(){return a()?(delete this.get,void 0):(this.get=b).apply(this,arguments)}}}function x(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Xb.length;e--;)if(b=Xb[e]+c,b in a)return b;return d}function y(a,b,c){var d=Tb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=_.css(a,c+wb[f],!0,e)),d?("content"===c&&(g-=_.css(a,"padding"+wb[f],!0,e)),"margin"!==c&&(g-=_.css(a,"border"+wb[f]+"Width",!0,e))):(g+=_.css(a,"padding"+wb[f],!0,e),"padding"!==c&&(g+=_.css(a,"border"+wb[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Rb(a),g="border-box"===_.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=v(a,b,f),(0>e||null==e)&&(e=a.style[b]),Qb.test(e))return e;d=g&&(Y.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=rb.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&xb(d)&&(f[g]=rb.access(d,"olddisplay",u(d.nodeName)))):(e=xb(d),"none"===c&&e||rb.set(d,"olddisplay",e?c:_.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function C(a,b,c,d,e){return new C.prototype.init(a,b,c,d,e)}function D(){return setTimeout(function(){Yb=void 0}),Yb=_.now()}function E(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=wb[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function F(a,b,c){for(var d,e=(cc[b]||[]).concat(cc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function G(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&xb(a),p=rb.get(a,"fxshow");c.queue||(h=_._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,_.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=_.css(a,"display"),k="none"===j?rb.get(a,"olddisplay")||u(a.nodeName):j,"inline"===k&&"none"===_.css(a,"float")&&(n.display="inline-block")),c.overflow&&(n.overflow="hidden",l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],$b.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||_.style(a,d)}else j=void 0;if(_.isEmptyObject(m))"inline"===("none"===j?u(a.nodeName):j)&&(n.display=j);else{p?"hidden"in p&&(o=p.hidden):p=rb.access(a,"fxshow",{}),f&&(p.hidden=!o),o?_(a).show():l.done(function(){_(a).hide()}),l.done(function(){var b;rb.remove(a,"fxshow");for(b in m)_.style(a,b,m[b])});for(d in m)g=F(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function H(a,b){var c,d,e,f,g;for(c in a)if(d=_.camelCase(c),e=b[d],f=a[c],_.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=_.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function I(a,b,c){var d,e,f=0,g=bc.length,h=_.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Yb||D(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:_.extend({},b),opts:_.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Yb||D(),duration:c.duration,tweens:[],createTween:function(b,c){var d=_.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(H(k,j.opts.specialEasing);g>f;f++)if(d=bc[f].call(j,a,k,j.opts))return d;return _.map(k,F,j),_.isFunction(j.opts.start)&&j.opts.start.call(a,j),_.fx.timer(_.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function J(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(nb)||[];if(_.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function K(a,b,c,d){function e(h){var i;return f[h]=!0,_.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===tc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function L(a,b){var c,d,e=_.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&_.extend(!0,a,d),a}function M(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function N(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function O(a,b,c,d){var e;if(_.isArray(b))_.each(b,function(b,e){c||yc.test(a)?d(a,e):O(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==_.type(b))d(a,b);else for(e in b)O(a+"["+e+"]",b[e],c,d)}function P(a){return _.isWindow(a)?a:9===a.nodeType&&a.defaultView}var Q=[],R=Q.slice,S=Q.concat,T=Q.push,U=Q.indexOf,V={},W=V.toString,X=V.hasOwnProperty,Y={},Z=a.document,$="2.1.4",_=function(a,b){return new _.fn.init(a,b)},ab=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bb=/^-ms-/,cb=/-([\da-z])/gi,db=function(a,b){return b.toUpperCase()};_.fn=_.prototype={jquery:$,constructor:_,selector:"",length:0,toArray:function(){return R.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:R.call(this)},pushStack:function(a){var b=_.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return _.each(this,a,b)},map:function(a){return this.pushStack(_.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(R.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:T,sort:Q.sort,splice:Q.splice},_.extend=_.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||_.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(_.isPlainObject(d)||(e=_.isArray(d)))?(e?(e=!1,f=c&&_.isArray(c)?c:[]):f=c&&_.isPlainObject(c)?c:{},g[b]=_.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},_.extend({expando:"jQuery"+($+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===_.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!_.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==_.type(a)||a.nodeType||_.isWindow(a)?!1:a.constructor&&!X.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?V[W.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=_.trim(a),a&&(1===a.indexOf("use strict")?(b=Z.createElement("script"),b.text=a,Z.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(bb,"ms-").replace(cb,db)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(ab,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?_.merge(d,"string"==typeof a?[a]:a):T.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:U.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return S.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),_.isFunction(a)?(d=R.call(arguments,2),e=function(){return a.apply(b||this,d.concat(R.call(arguments)))},e.guid=a.guid=a.guid||_.guid++,e):void 0},now:Date.now,support:Y}),_.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});var eb=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],h=b.nodeType,"string"!=typeof a||!a||1!==h&&9!==h&&11!==h)return c;if(!d&&I){if(11!==h&&(e=sb.exec(a)))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return $.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&v.getElementsByClassName)return $.apply(c,b.getElementsByClassName(g)),c}if(v.qsa&&(!J||!J.test(a))){if(n=l=N,o=b,p=1!==h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=z(a),(l=b.getAttribute("id"))?n=l.replace(ub,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=tb.test(a)&&k(b.parentNode)||b,p=j.join(",")}if(p)try{return $.apply(c,o.querySelectorAll(p)),c}catch(q){}finally{l||b.removeAttribute("id")}}}return B(a.replace(ib,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||V)-(~a.sourceIndex||V);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?ab(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):$.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return ab(b,a)>-1},g,!0),k=[function(a,c,d){var e=!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];e>h;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ib,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Y.call(i));r=q(r)}$.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+1*new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V=1<<31,W={}.hasOwnProperty,X=[],Y=X.pop,Z=X.push,$=X.push,_=X.slice,ab=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},bb="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",cb="[\\x20\\t\\r\\n\\f]",db="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",eb=db.replace("w","w#"),fb="\\["+cb+"*("+db+")(?:"+cb+"*([*^$|!~]?=)"+cb+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+eb+"))|)"+cb+"*\\]",gb=":("+db+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+fb+")*)|"+".*"+")\\)|)",hb=new RegExp(cb+"+","g"),ib=new RegExp("^"+cb+"+|((?:^|[^\\\\])(?:\\\\.)*)"+cb+"+$","g"),jb=new RegExp("^"+cb+"*,"+cb+"*"),kb=new RegExp("^"+cb+"*([>+~]|"+cb+")"+cb+"*"),lb=new RegExp("="+cb+"*([^\\]'\"]*?)"+cb+"*\\]","g"),mb=new RegExp(gb),nb=new RegExp("^"+eb+"$"),ob={ID:new RegExp("^#("+db+")"),CLASS:new RegExp("^\\.("+db+")"),TAG:new RegExp("^("+db.replace("w","w*")+")"),ATTR:new RegExp("^"+fb),PSEUDO:new RegExp("^"+gb),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+cb+"*(even|odd|(([+-]|)(\\d*)n|)"+cb+"*(?:([+-]|)"+cb+"*(\\d+)|))"+cb+"*\\)|)","i"),bool:new RegExp("^(?:"+bb+")$","i"),needsContext:new RegExp("^"+cb+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+cb+"*((?:-\\d)?\\d*)"+cb+"*\\)|)(?=[^-]|$)","i")},pb=/^(?:input|select|textarea|button)$/i,qb=/^h\d$/i,rb=/^[^{]+\{\s*\[native \w/,sb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tb=/[+~]/,ub=/'|\\/g,vb=new RegExp("\\\\([\\da-f]{1,6}"+cb+"?|("+cb+")|.)","ig"),wb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(55296|d>>10,56320|1023&d)},xb=function(){F()};try{$.apply(X=_.call(O.childNodes),O.childNodes),X[O.childNodes.length].nodeType}catch(yb){$={apply:X.length?function(a,b){Z.apply(a,_.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:O;return d!==G&&9===d.nodeType&&d.documentElement?(G=d,H=d.documentElement,c=d.defaultView,c&&c!==c.top&&(c.addEventListener?c.addEventListener("unload",xb,!1):c.attachEvent&&c.attachEvent("onunload",xb)),I=!y(d),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=rb.test(d.getElementsByClassName),v.getById=e(function(a){return H.appendChild(a).id=N,!d.getElementsByName||!d.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},w.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):v.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){return I?b.getElementsByClassName(a):void 0},K=[],J=[],(v.qsa=rb.test(d.querySelectorAll))&&(e(function(a){H.appendChild(a).innerHTML="<a id='"+N+"'></a>"+"<select id='"+N+"-\f]' msallowcapture=''>"+"<option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&J.push("[*^$]="+cb+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+cb+"*(?:value|"+bb+")"),a.querySelectorAll("[id~="+N+"-]").length||J.push("~="),a.querySelectorAll(":checked").length||J.push(":checked"),a.querySelectorAll("a#"+N+"+*").length||J.push(".#.+[+~]")}),e(function(a){var b=d.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+cb+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=rb.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",gb)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=rb.test(H.compareDocumentPosition),M=b||rb.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c?c:(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!v.sortDetached&&b.compareDocumentPosition(a)===c?a===d||a.ownerDocument===O&&M(O,a)?-1:b===d||b.ownerDocument===O&&M(O,b)?1:D?ab(D,a)-ab(D,b):0:4&c?-1:1)}:function(a,b){if(a===b)return E=!0,0;var c,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===d?-1:b===d?1:f?-1:h?1:D?ab(D,a)-ab(D,b):0;if(f===h)return g(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},d):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(lb,"='$1']"),!(!v.matchesSelector||!I||K&&K.test(c)||J&&J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&W.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:ob,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(vb,wb),a[3]=(a[3]||a[4]||a[5]||"").replace(vb,wb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return ob.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&mb.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(vb,wb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+cb+")"+a+"("+cb+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(hb," ")+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||0===m%d&&m/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=ab(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ib,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(vb,wb),function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return nb.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(vb,wb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return qb.test(a.nodeName)},input:function(a){return pb.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){(!d||(e=jb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=kb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ib," ")}),h=h.slice(d.length));for(g in w.filter)!(e=ob[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(b=(w.find.ID(g.matches[0].replace(vb,wb),b)||[])[0],!b)return c;
j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=ob.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(vb,wb),tb.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return $.apply(c,d),c;break}}return(j||A(a,l))(d,b,!I,c,tb.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),v.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(bb,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);_.find=eb,_.expr=eb.selectors,_.expr[":"]=_.expr.pseudos,_.unique=eb.uniqueSort,_.text=eb.getText,_.isXMLDoc=eb.isXML,_.contains=eb.contains;var fb=_.expr.match.needsContext,gb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,hb=/^.[^:#\[\.,]*$/;_.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?_.find.matchesSelector(d,a)?[d]:[]:_.find.matches(a,_.grep(b,function(a){return 1===a.nodeType}))},_.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(_(a).filter(function(){for(b=0;c>b;b++)if(_.contains(e[b],this))return!0}));for(b=0;c>b;b++)_.find(a,e[b],d);return d=this.pushStack(c>1?_.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&fb.test(a)?_(a):a||[],!1).length}});var ib,jb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,kb=_.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:jb.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ib).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof _?b[0]:b,_.merge(this,_.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:Z,!0)),gb.test(c[1])&&_.isPlainObject(b))for(c in b)_.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=Z.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=Z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):_.isFunction(a)?"undefined"!=typeof ib.ready?ib.ready(a):a(_):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),_.makeArray(a,this))};kb.prototype=_.fn,ib=_(Z);var lb=/^(?:parents|prev(?:Until|All))/,mb={children:!0,contents:!0,next:!0,prev:!0};_.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&_(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),_.fn.extend({has:function(a){var b=_(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(_.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=fb.test(a)||"string"!=typeof a?_(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&_.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?_.unique(f):f)},index:function(a){return a?"string"==typeof a?U.call(_(a),this[0]):U.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(_.unique(_.merge(this.get(),_(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),_.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return _.dir(a,"parentNode")},parentsUntil:function(a,b,c){return _.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return _.dir(a,"nextSibling")},prevAll:function(a){return _.dir(a,"previousSibling")},nextUntil:function(a,b,c){return _.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return _.dir(a,"previousSibling",c)},siblings:function(a){return _.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return _.sibling(a.firstChild)},contents:function(a){return a.contentDocument||_.merge([],a.childNodes)}},function(a,b){_.fn[a]=function(c,d){var e=_.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=_.filter(d,e)),this.length>1&&(mb[a]||_.unique(e),lb.test(a)&&e.reverse()),this.pushStack(e)}});var nb=/\S+/g,ob={};_.Callbacks=function(a){a="string"==typeof a?ob[a]||f(a):_.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(b=a.memory&&f,c=!0,h=e||0,e=0,g=i.length,d=!0;i&&g>h;h++)if(i[h].apply(f[0],f[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function f(b){_.each(b,function(b,c){var d=_.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),d?g=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&_.each(arguments,function(a,b){for(var c;(c=_.inArray(b,i,c))>-1;)i.splice(c,1),d&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?_.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],g=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},_.extend({Deferred:function(a){var b=[["resolve","done",_.Callbacks("once memory"),"resolved"],["reject","fail",_.Callbacks("once memory"),"rejected"],["notify","progress",_.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return _.Deferred(function(c){_.each(b,function(b,f){var g=_.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&_.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?_.extend(a,d):d}},e={};return d.pipe=d.then,_.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=R.call(arguments),g=f.length,h=1!==g||a&&_.isFunction(a.promise)?g:0,i=1===h?a:_.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?R.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&_.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var pb;_.fn.ready=function(a){return _.ready.promise().done(a),this},_.extend({isReady:!1,readyWait:1,holdReady:function(a){a?_.readyWait++:_.ready(!0)},ready:function(a){(a===!0?--_.readyWait:_.isReady)||(_.isReady=!0,a!==!0&&--_.readyWait>0||(pb.resolveWith(Z,[_]),_.fn.triggerHandler&&(_(Z).triggerHandler("ready"),_(Z).off("ready"))))}}),_.ready.promise=function(b){return pb||(pb=_.Deferred(),"complete"===Z.readyState?setTimeout(_.ready):(Z.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1))),pb.promise(b)},_.ready.promise();var qb=_.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===_.type(c)){e=!0;for(h in c)_.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,_.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(_(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};_.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},h.uid=1,h.accepts=_.acceptData,h.prototype={key:function(a){if(!h.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=h.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,_.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(_.isEmptyObject(f))_.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,_.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{_.isArray(b)?d=b.concat(b.map(_.camelCase)):(e=_.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(nb)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!_.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var rb=new h,sb=new h,tb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ub=/([A-Z])/g;_.extend({hasData:function(a){return sb.hasData(a)||rb.hasData(a)},data:function(a,b,c){return sb.access(a,b,c)},removeData:function(a,b){sb.remove(a,b)},_data:function(a,b,c){return rb.access(a,b,c)},_removeData:function(a,b){rb.remove(a,b)}}),_.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=sb.get(f),1===f.nodeType&&!rb.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=_.camelCase(d.slice(5)),i(f,d,e[d])));rb.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){sb.set(this,a)}):qb(this,function(b){var c,d=_.camelCase(a);if(f&&void 0===b){if(c=sb.get(f,a),void 0!==c)return c;if(c=sb.get(f,d),void 0!==c)return c;if(c=i(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=sb.get(this,d);sb.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&sb.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){sb.remove(this,a)})}}),_.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=rb.get(a,b),c&&(!d||_.isArray(c)?d=rb.access(a,b,_.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=_.queue(a,b),d=c.length,e=c.shift(),f=_._queueHooks(a,b),g=function(){_.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return rb.get(a,c)||rb.access(a,c,{empty:_.Callbacks("once memory").add(function(){rb.remove(a,[b+"queue",c])})})}}),_.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?_.queue(this[0],a):void 0===b?this:this.each(function(){var c=_.queue(this,a,b);_._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&_.dequeue(this,a)})},dequeue:function(a){return this.each(function(){_.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=_.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=rb.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var vb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,wb=["Top","Right","Bottom","Left"],xb=function(a,b){return a=b||a,"none"===_.css(a,"display")||!_.contains(a.ownerDocument,a)},yb=/^(?:checkbox|radio)$/i;!function(){var a=Z.createDocumentFragment(),b=a.appendChild(Z.createElement("div")),c=Z.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),Y.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",Y.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var zb="undefined";Y.focusinBubbles="onfocusin"in a;var Ab=/^key/,Bb=/^(?:mouse|pointer|contextmenu)|click/,Cb=/^(?:focusinfocus|focusoutblur)$/,Db=/^([^.]*)(?:\.(.+)|)$/;_.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=rb.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=_.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return typeof _!==zb&&_.event.triggered!==b.type?_.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(nb)||[""],j=b.length;j--;)h=Db.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=_.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=_.event.special[n]||{},k=_.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&_.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),_.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=rb.hasData(a)&&rb.get(a);if(q&&(i=q.events)){for(b=(b||"").match(nb)||[""],j=b.length;j--;)if(h=Db.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=_.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||_.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)_.event.remove(a,n+b[j],c,d,!0);_.isEmptyObject(i)&&(delete q.handle,rb.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||Z],n=X.call(b,"type")?b.type:b,o=X.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||Z,3!==d.nodeType&&8!==d.nodeType&&!Cb.test(n+_.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[_.expando]?b:new _.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:_.makeArray(c,[b]),l=_.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!_.isWindow(d)){for(i=l.delegateType||n,Cb.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||Z)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(rb.get(g,"events")||{})[b.type]&&rb.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&_.acceptData(g)&&(b.result=k.apply(g,c),b.result===!1&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!_.acceptData(d)||j&&_.isFunction(d[n])&&!_.isWindow(d)&&(h=d[j],h&&(d[j]=null),_.event.triggered=n,d[n](),_.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=_.event.fix(a);var b,c,d,e,f,g=[],h=R.call(arguments),i=(rb.get(this,"events")||{})[a.type]||[],j=_.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=_.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(f.namespace))&&(a.handleObj=f,a.data=f.data,d=((_.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?_(e,this).index(i)>=0:_.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||Z,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[_.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Bb.test(e)?this.mouseHooks:Ab.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new _.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=Z),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&_.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return _.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=_.extend(new _.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?_.event.trigger(e,null,b):_.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},_.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},_.Event=function(a,b){return this instanceof _.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?j:k):this.type=a,b&&_.extend(this,b),this.timeStamp=a&&a.timeStamp||_.now(),this[_.expando]=!0,void 0):new _.Event(a,b)},_.Event.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=j,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=j,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=j,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},_.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){_.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!_.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),Y.focusinBubbles||_.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){_.event.simulate(b,a.target,_.event.fix(a),!0)};_.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=rb.access(d,b);e||d.addEventListener(a,c,!0),rb.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=rb.access(d,b)-1;e?rb.access(d,b,e):(d.removeEventListener(a,c,!0),rb.remove(d,b))}}}),_.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=k;else if(!d)return this;return 1===e&&(f=d,d=function(a){return _().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=_.guid++)),this.each(function(){_.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,_(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=k),this.each(function(){_.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){_.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?_.event.trigger(a,b,c,!0):void 0}});var Eb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Fb=/<([\w:]+)/,Gb=/<|&#?\w+;/,Hb=/<(?:script|style|link)/i,Ib=/checked\s*(?:[^=]|=\s*.checked.)/i,Jb=/^$|\/(?:java|ecma)script/i,Kb=/^true\/(.*)/,Lb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Mb={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Mb.optgroup=Mb.option,Mb.tbody=Mb.tfoot=Mb.colgroup=Mb.caption=Mb.thead,Mb.th=Mb.td,_.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=_.contains(a.ownerDocument,a);if(!(Y.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||_.isXMLDoc(a)))for(g=r(h),f=r(a),d=0,e=f.length;e>d;d++)s(f[d],g[d]);if(b)if(c)for(f=f||r(a),g=g||r(h),d=0,e=f.length;e>d;d++)q(f[d],g[d]);else q(a,h);return g=r(h,"script"),g.length>0&&p(g,!i&&r(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;n>m;m++)if(e=a[m],e||0===e)if("object"===_.type(e))_.merge(l,e.nodeType?[e]:e);else if(Gb.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Fb.exec(e)||["",""])[1].toLowerCase(),h=Mb[g]||Mb._default,f.innerHTML=h[1]+e.replace(Eb,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;_.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===_.inArray(e,d))&&(i=_.contains(e.ownerDocument,e),f=r(k.appendChild(e),"script"),i&&p(f),c))for(j=0;e=f[j++];)Jb.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=_.event.special,g=0;void 0!==(c=a[g]);g++){if(_.acceptData(c)&&(e=c[rb.expando],e&&(b=rb.cache[e]))){if(b.events)for(d in b.events)f[d]?_.event.remove(c,d):_.removeEvent(c,d,b.handle);rb.cache[e]&&delete rb.cache[e]}delete sb.cache[c[sb.expando]]}}}),_.fn.extend({text:function(a){return qb(this,function(a){return void 0===a?_.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?_.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||_.cleanData(r(c)),c.parentNode&&(b&&_.contains(c.ownerDocument,c)&&p(r(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(_.cleanData(r(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return _.clone(this,a,b)})},html:function(a){return qb(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Hb.test(a)&&!Mb[(Fb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Eb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(_.cleanData(r(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,_.cleanData(r(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],p=_.isFunction(m);if(p||j>1&&"string"==typeof m&&!Y.checkClone&&Ib.test(m))return this.each(function(c){var d=k.eq(c);p&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=_.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=_.map(r(c,"script"),n),f=e.length;j>i;i++)g=c,i!==l&&(g=_.clone(g,!0,!0),f&&_.merge(e,r(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,_.map(e,o),i=0;f>i;i++)g=e[i],Jb.test(g.type||"")&&!rb.access(g,"globalEval")&&_.contains(h,g)&&(g.src?_._evalUrl&&_._evalUrl(g.src):_.globalEval(g.textContent.replace(Lb,"")))}return this}}),_.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){_.fn[a]=function(a){for(var c,d=[],e=_(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),_(e[g])[b](c),T.apply(d,c.get());return this.pushStack(d)}});var Nb,Ob={},Pb=/^margin/,Qb=new RegExp("^("+vb+")(?!px)[a-z%]+$","i"),Rb=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};!function(){function b(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",g.innerHTML="",e.appendChild(f);var b=a.getComputedStyle(g,null);c="1%"!==b.top,d="4px"===b.width,e.removeChild(f)}var c,d,e=Z.documentElement,f=Z.createElement("div"),g=Z.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",Y.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),a.getComputedStyle&&_.extend(Y,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=g.appendChild(Z.createElement("div"));return c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",g.style.width="1px",e.appendChild(f),b=!parseFloat(a.getComputedStyle(c,null).marginRight),e.removeChild(f),g.removeChild(c),b}}))}(),_.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Sb=/^(none|table(?!-c[ea]).+)/,Tb=new RegExp("^("+vb+")(.*)$","i"),Ub=new RegExp("^([+-])=("+vb+")","i"),Vb={position:"absolute",visibility:"hidden",display:"block"},Wb={letterSpacing:"0",fontWeight:"400"},Xb=["Webkit","O","Moz","ms"];_.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=v(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=_.camelCase(b),i=a.style;return b=_.cssProps[h]||(_.cssProps[h]=x(i,h)),g=_.cssHooks[b]||_.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ub.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(_.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||_.cssNumber[h]||(c+="px"),Y.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=_.camelCase(b);return b=_.cssProps[h]||(_.cssProps[h]=x(a.style,h)),g=_.cssHooks[b]||_.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=v(a,b,d)),"normal"===e&&b in Wb&&(e=Wb[b]),""===c||c?(f=parseFloat(e),c===!0||_.isNumeric(f)?f||0:e):e}}),_.each(["height","width"],function(a,b){_.cssHooks[b]={get:function(a,c,d){return c?Sb.test(_.css(a,"display"))&&0===a.offsetWidth?_.swap(a,Vb,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Rb(a);return y(a,c,d?z(a,b,d,"border-box"===_.css(a,"boxSizing",!1,e),e):0)}}}),_.cssHooks.marginRight=w(Y.reliableMarginRight,function(a,b){return b?_.swap(a,{display:"inline-block"},v,[a,"marginRight"]):void 0}),_.each({margin:"",padding:"",border:"Width"},function(a,b){_.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+wb[d]+b]=f[d]||f[d-2]||f[0];return e}},Pb.test(a)||(_.cssHooks[a+b].set=y)}),_.fn.extend({css:function(a,b){return qb(this,function(a,b,c){var d,e,f={},g=0;if(_.isArray(b)){for(d=Rb(a),e=b.length;e>g;g++)f[b[g]]=_.css(a,b[g],!1,d);return f}return void 0!==c?_.style(a,b,c):_.css(a,b)},a,b,arguments.length>1)},show:function(){return B(this,!0)},hide:function(){return B(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){xb(this)?_(this).show():_(this).hide()})}}),_.Tween=C,C.prototype={constructor:C,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(_.cssNumber[c]?"":"px")},cur:function(){var a=C.propHooks[this.prop];return a&&a.get?a.get(this):C.propHooks._default.get(this)},run:function(a){var b,c=C.propHooks[this.prop];return this.pos=b=this.options.duration?_.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=_.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){_.fx.step[a.prop]?_.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[_.cssProps[a.prop]]||_.cssHooks[a.prop])?_.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},_.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},_.fx=C.prototype.init,_.fx.step={};var Yb,Zb,$b=/^(?:toggle|show|hide)$/,_b=new RegExp("^(?:([+-])=|)("+vb+")([a-z%]*)$","i"),ac=/queueHooks$/,bc=[G],cc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=_b.exec(b),f=e&&e[3]||(_.cssNumber[a]?"":"px"),g=(_.cssNumber[a]||"px"!==f&&+d)&&_b.exec(_.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,_.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};_.Animation=_.extend(I,{tweener:function(a,b){_.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");
for(var c,d=0,e=a.length;e>d;d++)c=a[d],cc[c]=cc[c]||[],cc[c].unshift(b)},prefilter:function(a,b){b?bc.unshift(a):bc.push(a)}}),_.speed=function(a,b,c){var d=a&&"object"==typeof a?_.extend({},a):{complete:c||!c&&b||_.isFunction(a)&&a,duration:a,easing:c&&b||b&&!_.isFunction(b)&&b};return d.duration=_.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in _.fx.speeds?_.fx.speeds[d.duration]:_.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){_.isFunction(d.old)&&d.old.call(this),d.queue&&_.dequeue(this,d.queue)},d},_.fn.extend({fadeTo:function(a,b,c,d){return this.filter(xb).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=_.isEmptyObject(a),f=_.speed(b,c,d),g=function(){var b=I(this,_.extend({},a),f);(e||rb.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=_.timers,g=rb.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ac.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&_.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=rb.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=_.timers,g=d?d.length:0;for(c.finish=!0,_.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),_.each(["toggle","show","hide"],function(a,b){var c=_.fn[b];_.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(E(b,!0),a,d,e)}}),_.each({slideDown:E("show"),slideUp:E("hide"),slideToggle:E("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){_.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),_.timers=[],_.fx.tick=function(){var a,b=0,c=_.timers;for(Yb=_.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||_.fx.stop(),Yb=void 0},_.fx.timer=function(a){_.timers.push(a),a()?_.fx.start():_.timers.pop()},_.fx.interval=13,_.fx.start=function(){Zb||(Zb=setInterval(_.fx.tick,_.fx.interval))},_.fx.stop=function(){clearInterval(Zb),Zb=null},_.fx.speeds={slow:600,fast:200,_default:400},_.fn.delay=function(a,b){return a=_.fx?_.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=Z.createElement("input"),b=Z.createElement("select"),c=b.appendChild(Z.createElement("option"));a.type="checkbox",Y.checkOn=""!==a.value,Y.optSelected=c.selected,b.disabled=!0,Y.optDisabled=!c.disabled,a=Z.createElement("input"),a.value="t",a.type="radio",Y.radioValue="t"===a.value}();var dc,ec,fc=_.expr.attrHandle;_.fn.extend({attr:function(a,b){return qb(this,_.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){_.removeAttr(this,a)})}}),_.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===zb?_.prop(a,b,c):(1===f&&_.isXMLDoc(a)||(b=b.toLowerCase(),d=_.attrHooks[b]||(_.expr.match.bool.test(b)?ec:dc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=_.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):(_.removeAttr(a,b),void 0))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(nb);if(f&&1===a.nodeType)for(;c=f[e++];)d=_.propFix[c]||c,_.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!Y.radioValue&&"radio"===b&&_.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),ec={set:function(a,b,c){return b===!1?_.removeAttr(a,c):a.setAttribute(c,c),c}},_.each(_.expr.match.bool.source.match(/\w+/g),function(a,b){var c=fc[b]||_.find.attr;fc[b]=function(a,b,d){var e,f;return d||(f=fc[b],fc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,fc[b]=f),e}});var gc=/^(?:input|select|textarea|button)$/i;_.fn.extend({prop:function(a,b){return qb(this,_.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[_.propFix[a]||a]})}}),_.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!_.isXMLDoc(a),f&&(b=_.propFix[b]||b,e=_.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||gc.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),Y.optSelected||(_.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),_.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_.propFix[this.toLowerCase()]=this});var hc=/[\t\r\n\f]/g;_.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(_.isFunction(a))return this.each(function(b){_(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(nb)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hc," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=_.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(_.isFunction(a))return this.each(function(b){_(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(nb)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hc," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?_.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):_.isFunction(a)?this.each(function(c){_(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=_(this),f=a.match(nb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===zb||"boolean"===c)&&(this.className&&rb.set(this,"__className__",this.className),this.className=this.className||a===!1?"":rb.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(hc," ").indexOf(b)>=0)return!0;return!1}});var ic=/\r/g;_.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=_.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,_(this).val()):a,null==e?e="":"number"==typeof e?e+="":_.isArray(e)&&(e=_.map(e,function(a){return null==a?"":a+""})),b=_.valHooks[this.type]||_.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=_.valHooks[e.type]||_.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ic,""):null==c?"":c)}}}),_.extend({valHooks:{option:{get:function(a){var b=_.find.attr(a,"value");return null!=b?b:_.trim(_.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(Y.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&_.nodeName(c.parentNode,"optgroup"))){if(b=_(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=_.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=_.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),_.each(["radio","checkbox"],function(){_.valHooks[this]={set:function(a,b){return _.isArray(b)?a.checked=_.inArray(_(a).val(),b)>=0:void 0}},Y.checkOn||(_.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),_.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){_.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),_.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var jc=_.now(),kc=/\?/;_.parseJSON=function(a){return JSON.parse(a+"")},_.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&_.error("Invalid XML: "+a),b};var lc=/#.*$/,mc=/([?&])_=[^&]*/,nc=/^(.*?):[ \t]*([^\r\n]*)$/gm,oc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,pc=/^(?:GET|HEAD)$/,qc=/^\/\//,rc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,sc={},tc={},uc="*/".concat("*"),vc=a.location.href,wc=rc.exec(vc.toLowerCase())||[];_.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:vc,type:"GET",isLocal:oc.test(wc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":uc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":_.parseJSON,"text xml":_.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?L(L(a,_.ajaxSettings),b):L(_.ajaxSettings,a)},ajaxPrefilter:J(sc),ajaxTransport:J(tc),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&300>a||304===a,c&&(s=M(l,v,c)),s=N(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(_.lastModified[e]=u),u=v.getResponseHeader("etag"),u&&(_.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,(a||!w)&&(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--_.active||_.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=_.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?_(m):_.event,o=_.Deferred(),p=_.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=nc.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||vc)+"").replace(lc,"").replace(qc,wc[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=_.trim(l.dataType||"*").toLowerCase().match(nb)||[""],null==l.crossDomain&&(i=rc.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===wc[1]&&i[2]===wc[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(wc[3]||("http:"===wc[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=_.param(l.data,l.traditional)),K(sc,l,b,v),2===t)return v;j=_.event&&l.global,j&&0===_.active++&&_.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!pc.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(kc.test(e)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=mc.test(e)?e.replace(mc,"$1_="+jc++):e+(kc.test(e)?"&":"?")+"_="+jc++)),l.ifModified&&(_.lastModified[e]&&v.setRequestHeader("If-Modified-Since",_.lastModified[e]),_.etag[e]&&v.setRequestHeader("If-None-Match",_.etag[e])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+uc+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=K(tc,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return _.get(a,b,c,"json")},getScript:function(a,b){return _.get(a,void 0,b,"script")}}),_.each(["get","post"],function(a,b){_[b]=function(a,c,d,e){return _.isFunction(c)&&(e=e||d,d=c,c=void 0),_.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),_._evalUrl=function(a){return _.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},_.fn.extend({wrapAll:function(a){var b;return _.isFunction(a)?this.each(function(b){_(this).wrapAll(a.call(this,b))}):(this[0]&&(b=_(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return _.isFunction(a)?this.each(function(b){_(this).wrapInner(a.call(this,b))}):this.each(function(){var b=_(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=_.isFunction(a);return this.each(function(c){_(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){_.nodeName(this,"body")||_(this).replaceWith(this.childNodes)}).end()}}),_.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},_.expr.filters.visible=function(a){return!_.expr.filters.hidden(a)};var xc=/%20/g,yc=/\[\]$/,zc=/\r?\n/g,Ac=/^(?:submit|button|image|reset|file)$/i,Bc=/^(?:input|select|textarea|keygen)/i;_.param=function(a,b){var c,d=[],e=function(a,b){b=_.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=_.ajaxSettings&&_.ajaxSettings.traditional),_.isArray(a)||a.jquery&&!_.isPlainObject(a))_.each(a,function(){e(this.name,this.value)});else for(c in a)O(c,a[c],b,e);return d.join("&").replace(xc,"+")},_.fn.extend({serialize:function(){return _.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=_.prop(this,"elements");return a?_.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!_(this).is(":disabled")&&Bc.test(this.nodeName)&&!Ac.test(a)&&(this.checked||!yb.test(a))}).map(function(a,b){var c=_(this).val();return null==c?null:_.isArray(c)?_.map(c,function(a){return{name:b.name,value:a.replace(zc,"\r\n")}}):{name:b.name,value:c.replace(zc,"\r\n")}}).get()}}),_.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Cc=0,Dc={},Ec={0:200,1223:204},Fc=_.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Dc)Dc[a]()}),Y.cors=!!Fc&&"withCredentials"in Fc,Y.ajax=Fc=!!Fc,_.ajaxTransport(function(a){var b;return Y.cors||Fc&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Cc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Dc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Ec[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Dc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),_.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return _.globalEval(a),a}}}),_.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),_.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=_("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),Z.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Gc=[],Hc=/(=)\?(?=&|$)|\?\?/;_.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Gc.pop()||_.expando+"_"+jc++;return this[a]=!0,a}}),_.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Hc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Hc.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=_.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Hc,"$1"+e):b.jsonp!==!1&&(b.url+=(kc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||_.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Gc.push(e)),g&&_.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),_.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||Z;var d=gb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=_.buildFragment([a],b,e),e&&e.length&&_(e).remove(),_.merge([],d.childNodes))};var Ic=_.fn.load;_.fn.load=function(a,b,c){if("string"!=typeof a&&Ic)return Ic.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=_.trim(a.slice(h)),a=a.slice(0,h)),_.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&_.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?_("<div>").append(_.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},_.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){_.fn[b]=function(a){return this.on(b,a)}}),_.expr.filters.animated=function(a){return _.grep(_.timers,function(b){return a===b.elem}).length};var Jc=a.document.documentElement;_.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=_.css(a,"position"),l=_(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=_.css(a,"top"),i=_.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),_.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},_.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){_.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,_.contains(b,d)?(typeof d.getBoundingClientRect!==zb&&(e=d.getBoundingClientRect()),c=P(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===_.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),_.nodeName(a[0],"html")||(d=a.offset()),d.top+=_.css(a[0],"borderTopWidth",!0),d.left+=_.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-_.css(c,"marginTop",!0),left:b.left-d.left-_.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Jc;a&&!_.nodeName(a,"html")&&"static"===_.css(a,"position");)a=a.offsetParent;return a||Jc})}}),_.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;_.fn[b]=function(e){return qb(this,function(b,e,f){var g=P(b);return void 0===f?g?g[c]:b[e]:(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f,void 0)},b,e,arguments.length,null)}}),_.each(["top","left"],function(a,b){_.cssHooks[b]=w(Y.pixelPosition,function(a,c){return c?(c=v(a,b),Qb.test(c)?_(a).position()[b]+"px":c):void 0})}),_.each({Height:"height",Width:"width"},function(a,b){_.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){_.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return qb(this,function(b,c,d){var e;return _.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?_.css(b,c,g):_.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),_.fn.size=function(){return this.length},_.fn.andSelf=_.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return _});var Kc=a.jQuery,Lc=a.$;return _.noConflict=function(b){return a.$===_&&(a.$=Lc),b&&a.jQuery===_&&(a.jQuery=Kc),_},typeof b===zb&&(a.jQuery=a.$=_),_}),function(){var a=this,b=a._,c=Array.prototype,d=Object.prototype,e=Function.prototype,f=c.push,g=c.slice,h=c.concat,i=d.toString,j=d.hasOwnProperty,k=Array.isArray,l=Object.keys,m=e.bind,n=function(a){return a instanceof n?a:this instanceof n?void(this._wrapped=a):new n(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):a._=n,n.VERSION="1.7.0";var o=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}};n.iteratee=function(a,b,c){return null==a?n.identity:n.isFunction(a)?o(a,b,c):n.isObject(a)?n.matches(a):n.property(a)},n.each=n.forEach=function(a,b,c){if(null==a)return a;b=o(b,c);var d,e=a.length;if(e===+e)for(d=0;e>d;d++)b(a[d],d,a);else{var f=n.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},n.map=n.collect=function(a,b,c){if(null==a)return[];b=n.iteratee(b,c);for(var d,e=a.length!==+a.length&&n.keys(a),f=(e||a).length,g=Array(f),h=0;f>h;h++)d=e?e[h]:h,g[h]=b(a[d],d,a);return g};var p="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(a,b,c,d){null==a&&(a=[]),b=o(b,d,4);var e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length,h=0;if(arguments.length<3){if(!g)throw new TypeError(p);c=a[f?f[h++]:h++]}for(;g>h;h++)e=f?f[h]:h,c=b(c,a[e],e,a);return c},n.reduceRight=n.foldr=function(a,b,c,d){null==a&&(a=[]),b=o(b,d,4);var e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;if(arguments.length<3){if(!g)throw new TypeError(p);c=a[f?f[--g]:--g]}for(;g--;)e=f?f[g]:g,c=b(c,a[e],e,a);return c},n.find=n.detect=function(a,b,c){var d;return b=n.iteratee(b,c),n.some(a,function(a,c,e){return b(a,c,e)?(d=a,!0):void 0}),d},n.filter=n.select=function(a,b,c){var d=[];return null==a?d:(b=n.iteratee(b,c),n.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d)},n.reject=function(a,b,c){return n.filter(a,n.negate(n.iteratee(b)),c)},n.every=n.all=function(a,b,c){if(null==a)return!0;b=n.iteratee(b,c);var d,e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,!b(a[e],e,a))return!1;return!0},n.some=n.any=function(a,b,c){if(null==a)return!1;b=n.iteratee(b,c);var d,e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,b(a[e],e,a))return!0;return!1},n.contains=n.include=function(a,b){return null==a?!1:(a.length!==+a.length&&(a=n.values(a)),n.indexOf(a,b)>=0)},n.invoke=function(a,b){var c=g.call(arguments,2),d=n.isFunction(b);return n.map(a,function(a){return(d?b:a[b]).apply(a,c)})},n.pluck=function(a,b){return n.map(a,n.property(b))},n.where=function(a,b){return n.filter(a,n.matches(b))},n.findWhere=function(a,b){return n.find(a,n.matches(b))},n.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b&&null!=a){a=a.length===+a.length?a:n.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=n.iteratee(b,c),n.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},n.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=a.length===+a.length?a:n.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=n.iteratee(b,c),n.each(a,function(a,c,d){e=b(a,c,d),(g>e||1/0===e&&1/0===f)&&(f=a,g=e)});return f},n.shuffle=function(a){for(var b,c=a&&a.length===+a.length?a:n.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=n.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},n.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=n.values(a)),a[n.random(a.length-1)]):n.shuffle(a).slice(0,Math.max(0,b))},n.sortBy=function(a,b,c){return b=n.iteratee(b,c),n.pluck(n.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var q=function(a){return function(b,c,d){var e={};return c=n.iteratee(c,d),n.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};n.groupBy=q(function(a,b,c){n.has(a,c)?a[c].push(b):a[c]=[b]}),n.indexBy=q(function(a,b,c){a[c]=b}),n.countBy=q(function(a,b,c){n.has(a,c)?a[c]++:a[c]=1}),n.sortedIndex=function(a,b,c,d){c=n.iteratee(c,d,1);for(var e=c(b),f=0,g=a.length;g>f;){var h=f+g>>>1;c(a[h])<e?f=h+1:g=h}return f},n.toArray=function(a){return a?n.isArray(a)?g.call(a):a.length===+a.length?n.map(a,n.identity):n.values(a):[]},n.size=function(a){return null==a?0:a.length===+a.length?a.length:n.keys(a).length},n.partition=function(a,b,c){b=n.iteratee(b,c);var d=[],e=[];return n.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},n.first=n.head=n.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:g.call(a,0,b)},n.initial=function(a,b,c){return g.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},n.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:g.call(a,Math.max(a.length-b,0))},n.rest=n.tail=n.drop=function(a,b,c){return g.call(a,null==b||c?1:b)},n.compact=function(a){return n.filter(a,n.identity)};var r=function(a,b,c,d){if(b&&n.every(a,n.isArray))return h.apply(d,a);for(var e=0,g=a.length;g>e;e++){var i=a[e];n.isArray(i)||n.isArguments(i)?b?f.apply(d,i):r(i,b,c,d):c||d.push(i)}return d};n.flatten=function(a,b){return r(a,b,!1,[])},n.without=function(a){return n.difference(a,g.call(arguments,1))},n.uniq=n.unique=function(a,b,c,d){if(null==a)return[];n.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=n.iteratee(c,d));for(var e=[],f=[],g=0,h=a.length;h>g;g++){var i=a[g];if(b)g&&f===i||e.push(i),f=i;else if(c){var j=c(i,g,a);n.indexOf(f,j)<0&&(f.push(j),e.push(i))}else n.indexOf(e,i)<0&&e.push(i)}return e},n.union=function(){return n.uniq(r(arguments,!0,!0,[]))},n.intersection=function(a){if(null==a)return[];for(var b=[],c=arguments.length,d=0,e=a.length;e>d;d++){var f=a[d];if(!n.contains(b,f)){for(var g=1;c>g&&n.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},n.difference=function(a){var b=r(g.call(arguments,1),!0,!0,[]);return n.filter(a,function(a){return!n.contains(b,a)})},n.zip=function(a){if(null==a)return[];for(var b=n.max(arguments,"length").length,c=Array(b),d=0;b>d;d++)c[d]=n.pluck(arguments,d);return c},n.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},n.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=n.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}for(;e>d;d++)if(a[d]===b)return d;return-1},n.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=a.length;for("number"==typeof c&&(d=0>c?d+c+1:Math.min(d,c+1));--d>=0;)if(a[d]===b)return d;return-1},n.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var s=function(){};n.bind=function(a,b){var c,d;if(m&&a.bind===m)return m.apply(a,g.call(arguments,1));if(!n.isFunction(a))throw new TypeError("Bind must be called on a function");return c=g.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(g.call(arguments)));s.prototype=a.prototype;var e=new s;s.prototype=null;var f=a.apply(e,c.concat(g.call(arguments)));return n.isObject(f)?f:e}},n.partial=function(a){var b=g.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===n&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},n.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=n.bind(a[c],a);return a},n.memoize=function(a,b){var c=function(d){var e=c.cache,f=b?b.apply(this,arguments):d;return n.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},n.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},n.defer=function(a){return n.delay.apply(n,[a,1].concat(g.call(arguments,1)))},n.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:n.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=n.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},n.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=n.now()-g;b>j&&j>0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=n.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},n.wrap=function(a,b){return n.partial(b,a)},n.negate=function(a){return function(){return!a.apply(this,arguments)}},n.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},n.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},n.before=function(a,b){var c;return function(){return--a>0?c=b.apply(this,arguments):b=null,c}},n.once=n.partial(n.before,2),n.keys=function(a){if(!n.isObject(a))return[];if(l)return l(a);var b=[];for(var c in a)n.has(a,c)&&b.push(c);return b},n.values=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},n.pairs=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},n.invert=function(a){for(var b={},c=n.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},n.functions=n.methods=function(a){var b=[];for(var c in a)n.isFunction(a[c])&&b.push(c);return b.sort()},n.extend=function(a){if(!n.isObject(a))return a;for(var b,c,d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)j.call(b,c)&&(a[c]=b[c])}return a},n.pick=function(a,b,c){var d,e={};if(null==a)return e;if(n.isFunction(b)){b=o(b,c);for(d in a){var f=a[d];b(f,d,a)&&(e[d]=f)}}else{var i=h.apply([],g.call(arguments,1));a=new Object(a);for(var j=0,k=i.length;k>j;j++)d=i[j],d in a&&(e[d]=a[d])}return e},n.omit=function(a,b,c){if(n.isFunction(b))b=n.negate(b);else{var d=n.map(h.apply([],g.call(arguments,1)),String);b=function(a,b){return!n.contains(d,b)
}}return n.pick(a,b,c)},n.defaults=function(a){if(!n.isObject(a))return a;for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)void 0===a[e]&&(a[e]=d[e])}return a},n.clone=function(a){return n.isObject(a)?n.isArray(a)?a.slice():n.extend({},a):a},n.tap=function(a,b){return b(a),a};var t=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof n&&(a=a._wrapped),b instanceof n&&(b=b._wrapped);var e=i.call(a);if(e!==i.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]===a)return d[f]===b;var g=a.constructor,h=b.constructor;if(g!==h&&"constructor"in a&&"constructor"in b&&!(n.isFunction(g)&&g instanceof g&&n.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var j,k;if("[object Array]"===e){if(j=a.length,k=j===b.length)for(;j--&&(k=t(a[j],b[j],c,d)););}else{var l,m=n.keys(a);if(j=m.length,k=n.keys(b).length===j)for(;j--&&(l=m[j],k=n.has(b,l)&&t(a[l],b[l],c,d)););}return c.pop(),d.pop(),k};n.isEqual=function(a,b){return t(a,b,[],[])},n.isEmpty=function(a){if(null==a)return!0;if(n.isArray(a)||n.isString(a)||n.isArguments(a))return 0===a.length;for(var b in a)if(n.has(a,b))return!1;return!0},n.isElement=function(a){return!(!a||1!==a.nodeType)},n.isArray=k||function(a){return"[object Array]"===i.call(a)},n.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},n.each(["Arguments","Function","String","Number","Date","RegExp"],function(a){n["is"+a]=function(b){return i.call(b)==="[object "+a+"]"}}),n.isArguments(arguments)||(n.isArguments=function(a){return n.has(a,"callee")}),"function"!=typeof/./&&(n.isFunction=function(a){return"function"==typeof a||!1}),n.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},n.isNaN=function(a){return n.isNumber(a)&&a!==+a},n.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===i.call(a)},n.isNull=function(a){return null===a},n.isUndefined=function(a){return void 0===a},n.has=function(a,b){return null!=a&&j.call(a,b)},n.noConflict=function(){return a._=b,this},n.identity=function(a){return a},n.constant=function(a){return function(){return a}},n.noop=function(){},n.property=function(a){return function(b){return b[a]}},n.matches=function(a){var b=n.pairs(a),c=b.length;return function(a){if(null==a)return!c;a=new Object(a);for(var d=0;c>d;d++){var e=b[d],f=e[0];if(e[1]!==a[f]||!(f in a))return!1}return!0}},n.times=function(a,b,c){var d=Array(Math.max(0,a));b=o(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},n.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},n.now=Date.now||function(){return(new Date).getTime()};var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},v=n.invert(u),w=function(a){var b=function(b){return a[b]},c="(?:"+n.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};n.escape=w(u),n.unescape=w(v),n.result=function(a,b){if(null==a)return void 0;var c=a[b];return n.isFunction(c)?a[b]():c};var x=0;n.uniqueId=function(a){var b=++x+"";return a?a+b:b},n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},A=/\\|'|\r|\n|\u2028|\u2029/g,B=function(a){return"\\"+z[a]};n.template=function(a,b,c){!b&&c&&(b=c),b=n.defaults({},b,n.templateSettings);var d=RegExp([(b.escape||y).source,(b.interpolate||y).source,(b.evaluate||y).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(A,B),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,n)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},n.chain=function(a){var b=n(a);return b._chain=!0,b};var C=function(a){return this._chain?n(a).chain():a};n.mixin=function(a){n.each(n.functions(a),function(b){var c=n[b]=a[b];n.prototype[b]=function(){var a=[this._wrapped];return f.apply(a,arguments),C.call(this,c.apply(n,a))}})},n.mixin(n),n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=c[a];n.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],C.call(this,c)}}),n.each(["concat","join","slice"],function(a){var b=c[a];n.prototype[a]=function(){return C.call(this,b.apply(this._wrapped,arguments))}}),n.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return n})}.call(this),function(){var a=this,b=a.Backbone,c=[];c.push;var d=c.slice;c.splice;var e;e="undefined"!=typeof exports?exports:a.Backbone={},e.VERSION="1.1.0";var f=a._;f||"undefined"==typeof require||(f=require("underscore")),e.$=a.jQuery||a.Zepto||a.ender||a.$,e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1;var g=e.Events={on:function(a,b,c){if(!i(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!i(this,"once",a,[b,c])||!b)return this;var d=this,e=f.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,g,h,j,k,l,m;if(!this._events||!i(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:f.keys(this._events),j=0,k=h.length;k>j;j++)if(a=h[j],g=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=g.length;m>l;l++)e=g[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=d.call(arguments,1);if(!i(this,"trigger",a,b))return this;var c=this._events[a],e=this._events.all;return c&&j(c,b),e&&j(e,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var g in d)a=d[g],a.off(b,c,this),(e||f.isEmpty(a._events))&&delete this._listeningTo[g];return this}},h=/\s+/,i=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(h.test(c)){for(var f=c.split(h),g=0,i=f.length;i>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},j=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},k={listenTo:"on",listenToOnce:"once"};f.each(k,function(a,b){g[b]=function(b,c,d){var e=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=f.uniqueId("l"));return e[g]=b,d||"object"!=typeof c||(d=this),b[a](c,d,this),this}}),g.bind=g.on,g.unbind=g.off,f.extend(e,g);var l=e.Model=function(a,b){var c=a||{};b||(b={}),this.cid=f.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(c=this.parse(c,b)||{}),c=f.defaults({},c,f.result(this,"defaults")),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)};f.extend(l.prototype,g,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return f.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;g=c.unset,i=c.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=f.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],f.isEqual(l[d],b)||h.push(d),f.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete l[d]:l[d]=b;if(!i){h.length&&(this._pending=!0);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,f.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,f.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)f.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),b.trigger("sync",b,d,a),void 0):!1},K(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,g,h=this.attributes;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,c=f.extend({validate:!0},c),d&&!c.wait){if(!this.set(d,c))return!1}else if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=f.extend({},h,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=h;var b=i.parse(a,c);return c.wait&&(b=f.extend(d||{},b)),f.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),i.trigger("sync",i,a,c),void 0)},K(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),g=this.sync(e,this,c),d&&c.wait&&(this.attributes=h),g},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;K(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=f.result(this,"urlRoot")||f.result(this.collection,"url")||J();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},f.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,f.extend(b,{validationError:c})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];f.each(m,function(a){l.prototype[a]=function(){var b=d.call(arguments);return b.unshift(this.attributes),f[a].apply(f,b)}});var n=e.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,f.extend({silent:!0},b))},o={add:!0,remove:!0,merge:!0},p={add:!0,remove:!1};f.extend(n.prototype,g,{model:l,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return e.sync.apply(this,arguments)},add:function(a,b){return this.set(a,f.extend({merge:!1},b,p))},remove:function(a,b){var c=!f.isArray(a);a=c?[a]:f.clone(a),b||(b={});var d,e,g,h;for(d=0,e=a.length;e>d;d++)h=a[d]=this.get(a[d]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h));return c?a[0]:a},set:function(a,b){b=f.defaults({},b,o),b.parse&&(a=this.parse(a,b));var c=!f.isArray(a);a=c?a?[a]:[]:f.clone(a);var d,e,g,h,i,j,k,m=b.at,n=this.model,p=this.comparator&&null==m&&b.sort!==!1,q=f.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!p&&u&&w?[]:!1;for(d=0,e=a.length;e>d;d++){if(i=a[d],g=i instanceof l?h=i:i[n.prototype.idAttribute],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),p&&!k&&j.hasChanged(q)&&(k=!0)),a[d]=j;else if(u){if(h=a[d]=this._prepareModel(i,b),!h)continue;r.push(h),h.on("all",this._onModelEvent,this),this._byId[h.cid]=h,null!=h.id&&(this._byId[h.id]=h)}x&&x.push(j||h)}if(w){for(d=0,e=this.length;e>d;++d)t[(h=this.models[d]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(p&&(k=!0),this.length+=r.length,null!=m)for(d=0,e=r.length;e>d;d++)this.models.splice(m+d,0,r[d]);else{x&&(this.models.length=0);var y=x||r;for(d=0,e=y.length;e>d;d++)this.models.push(y[d])}if(k&&this.sort({silent:!0}),!b.silent){for(d=0,e=r.length;e>d;d++)(h=r[d]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),a=this.add(a,f.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,f.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,f.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return d.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a.id]||this._byId[a.cid]||this._byId[a]},at:function(a){return this.models[a]},where:function(a,b){return f.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),f.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(f.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return f.invoke(this.models,"get",a)},fetch:function(a){a=a?f.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},K(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?f.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof l)return a.collection||(a.collection=this),a;b=b?f.clone(b):{},b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var q=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];f.each(q,function(a){n.prototype[a]=function(){var b=d.call(arguments);return b.unshift(this.models),f[a].apply(f,b)}});var r=["groupBy","countBy","sortBy"];f.each(r,function(a){n.prototype[a]=function(b,c){var d=f.isFunction(b)?b:function(a){return a.get(b)};return f[a](this.models,d,c)}});var s=e.View=function(a){this.cid=f.uniqueId("view"),a||(a={}),f.extend(this,f.pick(a,u)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},t=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName","events"];f.extend(s.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof e.$?a:e.$(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=f.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(f.isFunction(c)||(c=this[a[b]]),c){var d=b.match(t),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,""===g?this.$el.on(e,c):this.$el.on(e,g,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"),!1);else{var a=f.extend({},f.result(this,"attributes"));this.id&&(a.id=f.result(this,"id")),this.className&&(a["class"]=f.result(this,"className"));var b=e.$("<"+f.result(this,"tagName")+">").attr(a);this.setElement(b,!1)}}}),e.sync=function(a,b,c){var d=w[a];f.defaults(c||(c={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var g={type:d,dataType:"json"};if(c.url||(g.url=f.result(b,"url")||J()),null!=c.data||!b||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(c.attrs||b.toJSON(c))),c.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),c.emulateHTTP&&("PUT"===d||"DELETE"===d||"PATCH"===d)){g.type="POST",c.emulateJSON&&(g.data._method=d);var h=c.beforeSend;c.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",d),h?h.apply(this,arguments):void 0}}"GET"===g.type||c.emulateJSON||(g.processData=!1),"PATCH"===g.type&&v&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=c.xhr=e.ajax(f.extend(g,c));return b.trigger("request",b,i,c),i};var v=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var x=e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,z=/(\(\?)?:\w+/g,A=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(x.prototype,g,{initialize:function(){},route:function(a,b,c){f.isRegExp(a)||(a=this._routeToRegExp(a)),f.isFunction(b)&&(c=b,b=""),c||(c=this[b]);var d=this;return e.history.route(a,function(f){var g=d._extractParameters(a,f);c&&c.apply(d,g),d.trigger.apply(d,["route:"+b].concat(g)),d.trigger("route",b,g),e.history.trigger("route",d,b,g)}),this},navigate:function(a,b){return e.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=f.result(this,"routes");for(var a,b=f.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(B,"\\$&").replace(y,"(?:$1)?").replace(z,function(a,b){return b?a:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return f.map(c,function(a){return a?decodeURIComponent(a):null})}});var C=e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,F=/msie [\w.]+/,G=/\/$/,H=/[?#].*$/;C.started=!1,f.extend(C.prototype,g,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(G,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(D,"")},start:function(a){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=f.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var b=this.getFragment(),c=document.documentMode,d=F.exec(navigator.userAgent.toLowerCase())&&(!c||7>=c);this.root=("/"+this.root+"/").replace(E,"/"),d&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b;var g=this.location,h=g.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&h&&g.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+g.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),C.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),this.loadUrl(),void 0)},loadUrl:function(a){return a=this.fragment=this.getFragment(a),f.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!C.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(H,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),e.history=new C;var I=function(a,b){var c,d=this;c=a&&f.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},f.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&f.extend(c.prototype,a),c.__super__=d.prototype,c};l.extend=n.extend=x.extend=s.extend=C.extend=I;var J=function(){throw new Error('A "url" property or function must be specified')},K=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this),define("backboneRaw",["jquery","underscore"],function(a){return function(){var b;return b||a.Backbone}}(this));var t=void 0,u=!1,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message},this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message},this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message},this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message},this.message=a}}};"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),sjcl.cipher.aes=function(a){this.j[0][0][0]||this.D();var b,c,d,e,f=this.j[0][4],g=this.j[1];b=a.length;var h=1;for(4!==b&&6!==b&&8!==b&&q(new sjcl.exception.invalid("invalid aes key size")),this.a=[d=a.slice(0),e=[]],a=b;4*b+28>a;a++)c=d[a-1],(0===a%b||8===b&&4===a%b)&&(c=f[c>>>24]<<24^f[255&c>>16]<<16^f[255&c>>8]<<8^f[255&c],0===a%b&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7))),d[a]=d[a-b]^c;for(b=0;a;b++,a--)c=d[3&b?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[255&c>>16]]^g[2][f[255&c>>8]]^g[3][f[255&c]]},sjcl.cipher.aes.prototype={encrypt:function(a){return y(this,a,0)},decrypt:function(a){return y(this,a,1)},j:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){var a,b,c,d,e,f,g,h=this.j[0],i=this.j[1],j=h[4],k=i[4],l=[],m=[];for(a=0;256>a;a++)m[(l[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!j[b];b^=d||1,c=m[c]||1)for(f=c^c<<1^c<<2^c<<3^c<<4,f=99^(f>>8^255&f),j[b]=f,k[f]=b,e=l[a=l[d=l[b]]],g=16843009*e^65537*a^257*d^16843008*b,e=257*l[f]^16843008*f,a=0;4>a;a++)h[a][b]=e=e<<24^e>>>8,i[a][f]=g=g<<24^g>>>8;for(a=0;5>a;a++)h[a]=h[a].slice(0),i[a]=i[a].slice(0)}},sjcl.bitArray={bitSlice:function(a,b,c){return a=sjcl.bitArray.O(a.slice(b/32),32-(31&b)).slice(1),c===t?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(31&-b-c);return(-32&(b+c-1^b)?a[0|b/32]<<32-d^a[0|b/32+1]>>>d:a[0|b/32]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.O(b,d,0|c,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;return b&=31,c>0&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1)),a},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return u;var c,d=0;for(c=0;c<a.length;c++)d|=a[c]^b[c];return 0===d},O:function(a,b,c,d){var e;for(e=0,d===t&&(d=[]);b>=32;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;return e=a.length?a[a.length-1]:0,a=sjcl.bitArray.getPartial(e),d.push(sjcl.bitArray.partial(31&b+a,b+a>32?c:d.pop(),1)),d},k:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}},sjcl.codec.utf8String={fromBits:function(a){var b,c,d="",e=sjcl.bitArray.bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d+=String.fromCharCode(c>>>24),c<<=8;return decodeURIComponent(escape(d))},toBits:function(a){a=unescape(encodeURIComponent(a));var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a.charCodeAt(b),3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(sjcl.bitArray.partial(8*(3&b),d)),c}},sjcl.codec.hex={fromBits:function(a){var b,c="";for(b=0;b<a.length;b++)c+=((0|a[b])+0xf00000000000).toString(16).substr(4);return c.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c,d=[];for(a=a.replace(/\s|0x/g,""),c=a.length,a+="00000000",b=0;b<a.length;b+=8)d.push(0^parseInt(a.substr(b,8),16));return sjcl.bitArray.clamp(d,4*c)}},sjcl.codec.base64={I:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.I,g=0,h=sjcl.bitArray.bitLength(a);for(c&&(f=f.substr(0,62)+"-_"),c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;3&d.length&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c,d,e=[],f=0,g=sjcl.codec.base64.I,h=0;for(b&&(g=g.substr(0,62)+"-_"),c=0;c<a.length;c++)d=g.indexOf(a.charAt(c)),0>d&&q(new sjcl.exception.invalid("this isn't base64!")),f>26?(f-=26,e.push(h^d>>>f),h=d<<32-f):(f+=6,h^=d<<32-f);return 56&f&&e.push(sjcl.bitArray.partial(56&f,h,1)),e}},sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}},sjcl.hash.sha256=function(a){this.a[0]||this.D(),a?(this.q=a.q.slice(0),this.m=a.m.slice(0),this.g=a.g):this.reset()},sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.q=this.M.slice(0),this.m=[],this.g=0,this},update:function(a){"string"==typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.m=sjcl.bitArray.concat(this.m,a);for(b=this.g,a=this.g=b+sjcl.bitArray.bitLength(a),b=-512&512+b;a>=b;b+=512)z(this,c.splice(0,16));return this},finalize:function(){var a,b=this.m,c=this.q,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;15&a;a++)b.push(0);for(b.push(Math.floor(this.g/4294967296)),b.push(0|this.g);b.length;)z(this,b.splice(0,16));return this.reset(),c},M:[],a:[],D:function(){function a(a){return 0|4294967296*(a-Math.floor(a))}var b,c=0,d=2;a:for(;64>c;d++){for(b=2;d>=b*b;b++)if(0===d%b)continue a;8>c&&(this.M[c]=a(Math.pow(d,.5))),this.a[c]=a(Math.pow(d,1/3)),c++}}},sjcl.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,i=h.bitLength(c)/8,j=h.bitLength(g)/8;for(e=e||64,d=d||[],7>i&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),f=2;4>f&&j>>>8*f;f++);return 15-i>f&&(f=15-i),c=h.clamp(c,8*(15-f)),b=sjcl.mode.ccm.K(a,b,c,d,e,f),g=sjcl.mode.ccm.n(a,g,c,b,e,f),h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64,d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),i=f.clamp(b,h-e),j=f.bitSlice(b,h-e),h=(h-e)/8;for(7>g&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),b=2;4>b&&h>>>8*b;b++);return 15-g>b&&(b=15-g),c=f.clamp(c,8*(15-b)),i=sjcl.mode.ccm.n(a,i,c,j,e,b),a=sjcl.mode.ccm.K(a,i.data,c,d,e,b),f.equal(i.tag,a)||q(new sjcl.exception.corrupt("ccm: tag doesn't match")),i.data},K:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,i=h.k;if(e/=8,(e%2||4>e||e>16)&&q(new sjcl.exception.invalid("ccm: invalid tag length")),(4294967295<d.length||4294967295<b.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")),f=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)],f=h.concat(f,c),f[3]|=h.bitLength(b)/8,f=a.encrypt(f),d.length)for(c=h.bitLength(d)/8,65279>=c?g=[h.partial(16,c)]:4294967295>=c&&(g=h.concat([h.partial(16,65534)],[c])),g=h.concat(g,d),d=0;d<g.length;d+=4)f=a.encrypt(i(f,g.slice(d,d+4).concat([0,0,0])));for(d=0;d<b.length;d+=4)f=a.encrypt(i(f,b.slice(d,d+4).concat([0,0,0])));return h.clamp(f,8*e)},n:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.k;var i=b.length,j=h.bitLength(b);if(c=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4),d=h.bitSlice(g(d,a.encrypt(c)),0,e),!i)return{tag:d,data:[]};for(g=0;i>g;g+=4)c[3]++,e=a.encrypt(c),b[g]^=e[0],b[g+1]^=e[1],b[g+2]^=e[2],b[g+3]^=e[3];return{tag:d,data:h.clamp(b,j)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var g,h=sjcl.mode.ocb2.G,i=sjcl.bitArray,j=i.k,k=[0,0,0,0];c=h(a.encrypt(c));var l,m=[];for(d=d||[],e=e||64,g=0;g+4<b.length;g+=4)l=b.slice(g,g+4),k=j(k,l),m=m.concat(j(c,a.encrypt(j(c,l)))),c=h(c);return l=b.slice(g),b=i.bitLength(l),g=a.encrypt(j(c,[0,0,0,b])),l=i.clamp(j(l.concat([0,0,0]),g),b),k=j(k,j(l.concat([0,0,0]),g)),k=a.encrypt(j(k,j(c,h(c)))),d.length&&(k=j(k,f?d:sjcl.mode.ocb2.pmac(a,d))),m.concat(i.concat(l,i.clamp(k,e)))},decrypt:function(a,b,c,d,e,f){128!==sjcl.bitArray.bitLength(c)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits")),e=e||64;
var g,h,i=sjcl.mode.ocb2.G,j=sjcl.bitArray,k=j.k,l=[0,0,0,0],m=i(a.encrypt(c)),n=sjcl.bitArray.bitLength(b)-e,o=[];for(d=d||[],c=0;n/32>c+4;c+=4)g=k(m,a.decrypt(k(m,b.slice(c,c+4)))),l=k(l,g),o=o.concat(g),m=i(m);return h=n-32*c,g=a.encrypt(k(m,[0,0,0,h])),g=k(g,j.clamp(b.slice(c),h).concat([0,0,0])),l=k(l,g),l=a.encrypt(k(l,k(m,i(m)))),d.length&&(l=k(l,f?d:sjcl.mode.ocb2.pmac(a,d))),j.equal(j.clamp(l,e),j.bitSlice(b,n))||q(new sjcl.exception.corrupt("ocb: tag doesn't match")),o.concat(j.clamp(g,h))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.G,e=sjcl.bitArray,f=e.k,g=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4)h=d(h),g=f(g,a.encrypt(f(h,b.slice(c,c+4))));return c=b.slice(c),128>e.bitLength(c)&&(h=f(h,d(h)),c=e.concat(c,[-2147483648,0,0,0])),g=f(g,c),a.encrypt(f(d(f(h,d(h))),g))},G:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f=b.slice(0);return b=sjcl.bitArray,d=d||[],a=sjcl.mode.gcm.n(!0,a,f,d,c,e||128),b.concat(a.data,a.tag)},decrypt:function(a,b,c,d,e){var f=b.slice(0),g=sjcl.bitArray,h=g.bitLength(f);return e=e||128,d=d||[],h>=e?(b=g.bitSlice(f,h-e),f=g.bitSlice(f,0,h-e)):(b=f,f=[]),a=sjcl.mode.gcm.n(u,a,f,d,c,e),g.equal(a.tag,b)||q(new sjcl.exception.corrupt("gcm: tag doesn't match")),a.data},U:function(a,b){var c,d,e,f,g,h=sjcl.bitArray.k;for(e=[0,0,0,0],f=b.slice(0),c=0;128>c;c++){for((d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(e=h(e,f)),g=0!==(1&f[3]),d=3;d>0;d--)f[d]=f[d]>>>1|(1&f[d-1])<<31;f[0]>>>=1,g&&(f[0]^=-520093696)}return e},f:function(a,b,c){var d,e=c.length;for(b=b.slice(0),d=0;e>d;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjcl.mode.gcm.U(b,a);return b},n:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=sjcl.bitArray;for(l=c.length,m=o.bitLength(c),n=o.bitLength(d),h=o.bitLength(e),g=b.encrypt([0,0,0,0]),96===h?(e=e.slice(0),e=o.concat(e,[1])):(e=sjcl.mode.gcm.f(g,[0,0,0,0],e),e=sjcl.mode.gcm.f(g,e,[0,0,Math.floor(h/4294967296),4294967295&h])),h=sjcl.mode.gcm.f(g,[0,0,0,0],d),k=e.slice(0),d=h.slice(0),a||(d=sjcl.mode.gcm.f(g,h,c)),j=0;l>j;j+=4)k[3]++,i=b.encrypt(k),c[j]^=i[0],c[j+1]^=i[1],c[j+2]^=i[2],c[j+3]^=i[3];return c=o.clamp(c,m),a&&(d=sjcl.mode.gcm.f(g,h,c)),a=[Math.floor(n/4294967296),4294967295&n,Math.floor(m/4294967296),4294967295&m],d=sjcl.mode.gcm.f(g,d,a),i=b.encrypt(e),d[0]^=i[0],d[1]^=i[1],d[2]^=i[2],d[3]^=i[3],{tag:o.bitSlice(d,0,f),data:c}}},sjcl.misc.hmac=function(a,b){this.L=b=b||sjcl.hash.sha256;var c,d=[[],[]],e=b.prototype.blockSize/32;for(this.o=[new b,new b],a.length>e&&(a=b.hash(a)),c=0;e>c;c++)d[0][c]=909522486^a[c],d[1][c]=1549556828^a[c];this.o[0].update(d[0]),this.o[1].update(d[1])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){return a=new this.L(this.o[0]).update(a).finalize(),new this.L(this.o[1]).update(a).finalize()},sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1e3,(0>d||0>c)&&q(sjcl.exception.invalid("invalid params to pbkdf2")),"string"==typeof a&&(a=sjcl.codec.utf8String.toBits(a)),"string"==typeof b&&(b=sjcl.codec.utf8String.toBits(b)),e=e||sjcl.misc.hmac,a=new e(a);var f,g,h,i,j=[],k=sjcl.bitArray;for(i=1;32*j.length<(d||1);i++){for(e=f=a.encrypt(k.concat(b,[i])),g=1;c>g;g++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];j=j.concat(e)}return d&&(j=k.clamp(j,d)),j},sjcl.prng=function(a){this.b=[new sjcl.hash.sha256],this.h=[0],this.F=0,this.t={},this.C=0,this.J={},this.N=this.c=this.i=this.T=0,this.a=[0,0,0,0,0,0,0,0],this.e=[0,0,0,0],this.A=t,this.B=a,this.p=u,this.z={progress:{},seeded:{}},this.l=this.S=0,this.u=1,this.w=2,this.Q=65536,this.H=[0,48,64,96,128,192,256,384,512,768,1024],this.R=3e4,this.P=80},sjcl.prng.prototype={randomWords:function(a,b){var c,d=[];c=this.isReady(b);var e;if(c===this.l&&q(new sjcl.exception.notReady("generator isn't seeded")),c&this.w){c=!(c&this.u),e=[];var f,g=0;for(this.N=e[0]=(new Date).valueOf()+this.R,f=0;16>f;f++)e.push(0|4294967296*Math.random());for(f=0;f<this.b.length&&(e=e.concat(this.b[f].finalize()),g+=this.h[f],this.h[f]=0,!(!c&&this.F&1<<f));f++);for(this.F>=1<<this.b.length&&(this.b.push(new sjcl.hash.sha256),this.h.push(0)),this.c-=g,g>this.i&&(this.i=g),this.F++,this.a=sjcl.hash.sha256.hash(this.a.concat(e)),this.A=new sjcl.cipher.aes(this.a),c=0;4>c&&(this.e[c]=0|this.e[c]+1,!this.e[c]);c++);}for(c=0;a>c;c+=4)0===(c+1)%this.Q&&A(this),e=B(this),d.push(e[0],e[1],e[2],e[3]);return A(this),d.slice(0,a)},setDefaultParanoia:function(a){this.B=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.t[c],h=this.isReady(),i=0;switch(d=this.J[c],d===t&&(d=this.J[c]=this.T++),g===t&&(g=this.t[c]=0),this.t[c]=(this.t[c]+1)%this.b.length,typeof a){case"number":b===t&&(b=1),this.b[g].update([d,this.C++,1,b,f,1,0|a]);break;case"object":if(c=Object.prototype.toString.call(a),"[object Uint32Array]"===c){for(e=[],c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(i=1),c=0;c<a.length&&!i;c++)"number"!=typeof a[c]&&(i=1);if(!i){if(b===t)for(c=b=0;c<a.length;c++)for(e=a[c];e>0;)b++,e>>>=1;this.b[g].update([d,this.C++,2,b,f,a.length].concat(a))}break;case"string":b===t&&(b=a.length),this.b[g].update([d,this.C++,3,b,f,a.length]),this.b[g].update(a);break;default:i=1}i&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.h[g]+=b,this.c+=b,h===this.l&&(this.isReady()!==this.l&&C("seeded",Math.max(this.i,this.c)),C("progress",this.getProgress()))},isReady:function(a){return a=this.H[a!==t?a:this.B],this.i&&this.i>=a?this.h[0]>this.P&&(new Date).valueOf()>this.N?this.w|this.u:this.u:this.c>=a?this.w|this.l:this.l},getProgress:function(a){return a=this.H[a?a:this.B],this.i>=a?1:this.c>a?1:this.c/a},startCollectors:function(){this.p||(window.addEventListener?(window.addEventListener("load",this.r,u),window.addEventListener("mousemove",this.s,u)):document.attachEvent?(document.attachEvent("onload",this.r),document.attachEvent("onmousemove",this.s)):q(new sjcl.exception.bug("can't attach event")),this.p=!0)},stopCollectors:function(){this.p&&(window.removeEventListener?(window.removeEventListener("load",this.r,u),window.removeEventListener("mousemove",this.s,u)):window.detachEvent&&(window.detachEvent("onload",this.r),window.detachEvent("onmousemove",this.s)),this.p=u)},addEventListener:function(a,b){this.z[a][this.S++]=b},removeEventListener:function(a,b){var c,d,e=this.z[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},s:function(a){sjcl.random.addEntropy([a.x||a.clientX||a.offsetX||0,a.y||a.clientY||a.offsetY||0],2,"mouse")},r:function(){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")}},sjcl.random=new sjcl.prng(6);try{if("undefined"!=typeof module&&module.exports){var D=require("crypto").randomBytes(128);sjcl.random.addEntropy(D,1024,"crypto['randomBytes']")}else if(window&&window.crypto&&window.crypto.getRandomValues){var E=new Uint32Array(32);window.crypto.getRandomValues(E),sjcl.random.addEntropy(E,1024,"crypto['getRandomValues']")}}catch(F){}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(a,b,c,d){c=c||{},d=d||{};var e,f=sjcl.json,g=f.d({iv:sjcl.random.randomWords(4,0)},f.defaults);return f.d(g,c),c=g.adata,"string"==typeof g.salt&&(g.salt=sjcl.codec.base64.toBits(g.salt)),"string"==typeof g.iv&&(g.iv=sjcl.codec.base64.toBits(g.iv)),(!sjcl.mode[g.mode]||!sjcl.cipher[g.cipher]||"string"==typeof a&&100>=g.iter||64!==g.ts&&96!==g.ts&&128!==g.ts||128!==g.ks&&192!==g.ks&&256!==g.ks||2>g.iv.length||4<g.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters")),"string"==typeof a?(e=sjcl.misc.cachedPbkdf2(a,g),a=e.key.slice(0,g.ks/32),g.salt=e.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.publicKey&&(e=a.kem(),g.kemtag=e.tag,a=e.key.slice(0,g.ks/32)),"string"==typeof b&&(b=sjcl.codec.utf8String.toBits(b)),"string"==typeof c&&(c=sjcl.codec.utf8String.toBits(c)),e=new sjcl.cipher[g.cipher](a),f.d(d,g),d.key=a,g.ct=sjcl.mode[g.mode].encrypt(e,b,g.iv,c,g.ts),f.encode(g)},decrypt:function(a,b,c,d){c=c||{},d=d||{};var e=sjcl.json;b=e.d(e.d(e.d({},e.defaults),e.decode(b)),c,!0);var f;return c=b.adata,"string"==typeof b.salt&&(b.salt=sjcl.codec.base64.toBits(b.salt)),"string"==typeof b.iv&&(b.iv=sjcl.codec.base64.toBits(b.iv)),(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||"string"==typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters")),"string"==typeof a?(f=sjcl.misc.cachedPbkdf2(a,b),a=f.key.slice(0,b.ks/32),b.salt=f.salt):sjcl.ecc&&a instanceof sjcl.ecc.elGamal.secretKey&&(a=a.unkem(sjcl.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32)),"string"==typeof c&&(c=sjcl.codec.utf8String.toBits(c)),f=new sjcl.cipher[b.cipher](a),c=sjcl.mode[b.mode].decrypt(f,b.ct,b.iv,c,b.ts),e.d(d,b),d.key=a,sjcl.codec.utf8String.fromBits(c)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b))switch(b.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),c+=d+'"'+b+'":',d=",",typeof a[b]){case"number":case"boolean":c+=a[b];break;case"string":c+='"'+escape(a[b])+'"';break;case"object":c+='"'+sjcl.codec.base64.fromBits(a[b],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}return c+"}"},decode:function(a){a=a.replace(/\s/g,""),a.match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!")),a=a.replace(/^\{|\}$/g,"").split(/,/);var b,c,d={};for(b=0;b<a.length;b++)(c=a[b].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),d[c[2]]=c[3]?parseInt(c[3],10):c[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(c[4]):unescape(c[4]);return d},d:function(a,b,c){if(a===t&&(a={}),b===t)return a;for(var d in b)b.hasOwnProperty(d)&&(c&&a[d]!==t&&a[d]!==b[d]&&q(new sjcl.exception.invalid("required parameter overridden")),a[d]=b[d]);return a},X:function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&a[c]!==b[c]&&(d[c]=a[c]);return d},W:function(a,b){var c,d={};for(c=0;c<b.length;c++)a[b[c]]!==t&&(d[b[c]]=a[b[c]]);return d}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.V={},sjcl.misc.cachedPbkdf2=function(a,b){var c,d=sjcl.misc.V;return b=b||{},c=b.iter||1e3,d=d[a]=d[a]||{},c=d[c]=d[c]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)},d=b.salt===t?c.firstSalt:b.salt,c[d]=c[d]||sjcl.misc.pbkdf2(a,d,b.iter),{key:c[d].slice(0),salt:d.slice(0)}},define("sjcl",function(a){return function(){var b;return b||a.sjcl}}(this)),function(){define("cs!common/modules/encryptor",["common.config","sjcl"],function(a,b){var c,d,e,f;return d=null,e=null,f=function(a){var c,f;return null==a&&(a=""),f=a.split(":"),c=f.pop(),e=f[0],null!=c?d=new b.misc.hmac(c,b.hash.sha256):void 0},c={getEncryptor:function(){return d},setEncryptor:function(a){return null==a&&(a=""),a.indexOf(":")>-1?f(a):d=a},removeEncryptor:function(){return d=null},createSignature:function(){var a,c;return"string"==typeof d?"Bearer: "+d:null!=e&&null!=d?(a=e+";"+Date.now(),c=b.codec.base64.fromBits(d.encrypt(a)),a+";"+c):void 0}}})}.call(this),function(){define("cs!common/browser/browser",["common.config","underscore"],function(){var a,b,c,d;return c=function(){},"undefined"==typeof chrome||null===chrome||null==chrome.extension||null==chrome.storage?a={extension:{connect:c,sendMessage:c,addListener:c,removeListener:c,reload:c}}:(b=null!=(null!=(d=chrome.runtime)?d.sendMessage:void 0)?chrome.runtime:chrome.extension,a={storage:{get:function(a,b,c){var d;return null==c&&(c="sync"),null!=(d=chrome.storage[c])?d.get(a,b):void 0},set:function(a,b){var c;return null==b&&(b="sync"),null!=(c=chrome.storage[b])?c.set(a):void 0},getUser:function(a){return chrome.storage.sync.get("pnt_user",a)},setUser:function(a){return chrome.storage.sync.set({pnt_user:a})},getToken:function(a){return chrome.storage.sync.get("pnt_token",a)},setToken:function(a){return chrome.storage.sync.set({pnt_token:a})},getFriends:function(a){return chrome.storage.local.get("pnt_friends",a)},setFriends:function(a){return chrome.storage.local.set({pnt_friends:a})},getPointFromURL:function(a,b){return chrome.storage.sync.get(a,b)},setPointInURL:function(a,b,c){return null==c&&(c={}),c[a]=b,chrome.storage.sync.set(c)},getSeenTutorial:function(a){return chrome.storage.sync.get("pnt_seen_tutorial",a)},setSeenTutorial:function(a){return chrome.storage.sync.set({pnt_seen_tutorial:a})},getMixpanelInit:function(a){return chrome.storage.sync.get("pnt_mixpanel_initialized",a)},setMixpanelInit:function(a){return chrome.storage.sync.set({pnt_mixpanel_initialized:a})},remove:function(a,b){var c;return null==b&&(b="sync"),null!=(c=chrome.storage[b])?c.remove(a):void 0},addListener:function(a){return chrome.storage.onChanged.addListener(a)},removeListener:function(a){return chrome.storage.onChanged.removeListener(a)}},extension:{getManifest:function(){var a;return null!=(a=chrome.runtime)?"function"==typeof a.getManifest?a.getManifest():void 0:void 0},getDetails:chrome.app.getDetails,getURL:function(a){return b.getURL(a)},connect:function(a){return null==a&&(a=c),"function"==typeof b.connect?b.connect(a):void 0},sendMessage:function(a,d){return null==d&&(d=c),"function"==typeof b.sendMessage?b.sendMessage(a,d):void 0},requestUpdateCheck:function(a){return"function"==typeof b.requestUpdateCheck?b.requestUpdateCheck(a):void 0},reload:function(){var a;return null!=(a=chrome.runtime)?a.reload():void 0},addListener:function(a,c){var d,e,f;return"onMessage"===a?null!=(d=b.onMessage)?d.addListener(c):void 0:"onConnect"===a?null!=(e=b.onConnect)?e.addListener(c):void 0:"onUpdateAvailable"===a?null!=(f=b.onUpdateAvailable)?f.addListener(c):void 0:void 0},removeListener:function(a,c){var d,e,f;return"onMessage"===a?null!=(d=b.onMessage)?d.removeListener(c):void 0:"onConnect"===a?null!=(e=b.onConnect)?e.removeListener(c):void 0:"onUpdateAvailable"===a?null!=(f=b.onUpdateAvailable)?f.removeListener(c):void 0:void 0}}})})}.call(this),function(){define("cs!bbTracker",["underscore","cs!common/browser/browser","backboneRaw","common.config"],function(a,b,c,d){var e,f,g,h;return f=c.View.prototype.delegateEvents,e=/^(\S+)\s*(.*)$/,a.extend(c.View.prototype,{delegateEvents:function(b){var c=this;return b||(b=a.result(this,"events"))?(this.undelegateEvents(),a.each(b,function(d,f){var g,i,j,k;return j=b[f],a.isFunction(j)||(j=c[b[f]]),j?(i=f.match(e),g=i[1],k=i[2],j=a.bind(j,c),g+=".delegateEvents"+c.cid,""===k?null!=c.track&&a.has(c.track,f)?c.$el.on(g,function(a){var b;return b=j.apply(c,arguments),h.call(c,f,a),b}):c.$el.on(g,j):null!=c.track&&a.has(c.track,f)?c.$el.on(g,k,function(a){var b;return b=j.apply(c,arguments),h.call(c,f,a),b}):c.$el.on(g,k,j)):void 0}),null!=this.bindKeyboardEvents&&this.bindKeyboardEvents(),this):this},trackEvent:function(a,b,c){return g(a,b,c)}}),h=function(b,c){var d;if(d=this.track[b],a.isString(d))return g(this.track[b]);if(a.isObject(d)){if(null==d.name||null==d.data)return;if(a.isFunction(d.data))return g(d.name,d.data.call(this,c));if(a.isObject(d.data))return g(d.name,d.data)}},g=function(c,e,f){var g;return null==e&&(e={}),null!=c?(f=null!=(g=null!=f?f:d.eventNameSpace)?g:"",a.extend(e,d.register),b.extension.sendMessage({eventName:""+f+": "+c,eventData:e})):void 0}})}.call(this),function(){function a(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function b(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase())," "==b?"space":b}return n[a.which]?n[a.which]:o[a.which]?o[a.which]:String.fromCharCode(a.which).toLowerCase()}function c(a){a=a||{};var b,c=!1;for(b in t)a[b]?c=!0:t[b]=0;c||(w=!1)}function d(a,b,c,d,e,f){var g,i,j=[],k=c.type;if(!r[a])return[];for("keyup"==k&&h(a)&&(b=[a]),g=0;g<r[a].length;++g)if(i=r[a][g],!(!d&&i.seq&&t[i.seq]!=i.level||k!=i.action||("keypress"!=k||c.metaKey||c.ctrlKey)&&b.sort().join(",")!==i.modifiers.sort().join(","))){var l=d&&i.seq==d&&i.level==f;(!d&&i.combo==e||l)&&r[a].splice(g,1),j.push(i)}return j}function e(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function f(a,b,c){y.stopCallback(b,b.target||b.srcElement,c)||!1!==a(b,c)||(b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.returnValue=!1,b.cancelBubble=!0)}function g(a){"number"!=typeof a.which&&(a.which=a.keyCode);var c=b(a);c&&("keyup"==a.type&&u===c?u=!1:y.handleKey(c,e(a),a))}function h(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function i(a,d,e,g){function h(b){return function(){w=b,++t[a],clearTimeout(m),m=setTimeout(c,1e3)}}function i(d){f(e,d,a),"keyup"!==g&&(u=b(d)),setTimeout(c,10)}for(var l=t[a]=0;l<d.length;++l){var n=l+1===d.length?i:h(g||j(d[l+1]).action);k(d[l],n,g,a,l)}}function j(a,b){var c,d,e,f=[];for(c="+"===a?["+"]:a.split("+"),e=0;e<c.length;++e)d=c[e],q[d]&&(d=q[d]),b&&"keypress"!=b&&p[d]&&(d=p[d],f.push("shift")),h(d)&&f.push(d);if(c=d,e=b,!e){if(!l){l={};for(var g in n)g>95&&112>g||n.hasOwnProperty(g)&&(l[n[g]]=g)}e=l[c]?"keydown":"keypress"}return"keypress"==e&&f.length&&(e="keydown"),{key:d,modifiers:f,action:e}}function k(a,b,c,e,f){s[a+":"+c]=b,a=a.replace(/\s+/g," ");var g=a.split(" ");1<g.length?i(a,g,b,c):(c=j(a,c),r[c.key]=r[c.key]||[],d(c.key,c.modifiers,{type:c.action},e,a,f),r[c.key][e?"unshift":"push"]({callback:b,modifiers:c.modifiers,action:c.action,seq:e,level:f,combo:a}))}for(var l,m,n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},o={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},p={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},q={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r={},s={},t={},u=!1,v=!1,w=!1,x=1;20>x;++x)n[111+x]="f"+x;for(x=0;9>=x;++x)n[x+96]=x;a(document,"keypress",g),a(document,"keydown",g),a(document,"keyup",g);var y={bind:function(a,b,c){a=a instanceof Array?a:[a];for(var d=0;d<a.length;++d)k(a[d],b,c);return this},unbind:function(a,b){return y.bind(a,function(){},b)},trigger:function(a,b){return s[a+":"+b]&&s[a+":"+b]({},a),this},reset:function(){return r={},s={},this},stopCallback:function(a,b){return-1<(" "+b.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.contentEditable&&"true"==b.contentEditable},handleKey:function(a,b,e){var g,i=d(a,b,e);b={};var j=0,k=!1;for(g=0;g<i.length;++g)i[g].seq&&(j=Math.max(j,i[g].level));for(g=0;g<i.length;++g)i[g].seq?i[g].level==j&&(k=!0,b[i[g].seq]=1,f(i[g].callback,e,i[g].combo)):k||f(i[g].callback,e,i[g].combo);i="keypress"==e.type&&v,e.type!=w||h(a)||i||c(b),v=k&&"keydown"==e.type}};window.Mousetrap=y,"function"==typeof define&&define.amd&&define("mousetrap",y)}(),function(a,b,c){"use strict";var d=b.View.prototype.delegateEvents,e=b.View.prototype.undelegateEvents,f=b.View.prototype.remove,g={};a.extend(b.View.prototype,{keyboardEvents:{},bindKeyboardEvents:function(b){if(b||(b=a.result(this,"keyboardEvents"))){for(var d in b){var e=b[d];if(a.isFunction(e)||(e=this[b[d]]),!e)throw new Error('Method "'+b[d]+'" does not exist');e=a.bind(e,this),"bindGlobal"in c&&(-1!==d.indexOf("mod")||-1!==d.indexOf("command")||-1!==d.indexOf("ctrl"))?c.bindGlobal(d,e):c.bind(d,e),g[d]=this}return this}},unbindKeyboardEvents:function(){for(var a in this.keyboardEvents)g[a]===this&&(c.unbind(a),delete g[a]);return this},delegateEvents:function(){var a=d.apply(this,arguments);return this.bindKeyboardEvents(),a},undelegateEvents:function(){var a=e.apply(this,arguments);return this.unbindKeyboardEvents&&this.unbindKeyboardEvents(),a},remove:function(){var a=f.apply(this,arguments);return this.unbindKeyboardEvents&&this.unbindKeyboardEvents(),a}})}(_,Backbone,Mousetrap),define("bbMouseTrap",function(){}),define("backbone",["backboneRaw","jquery","common.config","cs!common/modules/encryptor","cs!common/browser/browser","cs!bbTracker","mousetrap","bbMouseTrap"],function(a,b,c,d,e){var f;e.extension&&e.extension.getManifest&&(f=e.extension.getManifest().version),a.ajax=function(){var b=arguments[0];if(c.divertRequests&&e.extension){var g,h={request:"request:ajax",details:b};return e.extension.sendMessage(h,function(a){g=a.jqXHR;var c=b[a.status];void 0!=c&&("success"==a.status?c(a.data):"error"==a.status&&c(g))}),g}var i=d.createSignature();return i&&_.extend(b,{beforeSend:function(a){a.setRequestHeader("Authorization",i),f&&a.setRequestHeader("Extension-Version",f)},statusCode:{401:function(){a.trigger("unauthorized")}}}),a.$.ajax.apply(a.$,arguments)};var g=a.View.prototype.remove;return a.View.prototype.remove=function(){this.childViews&&this.childViews.forEach(function(b){b instanceof a.View&&b.remove&&b.remove()}),g.apply(this,arguments)},b.fn.h=function(a){return b(this).find("[data-js-"+a+"]")},a.View.prototype.$h=function(a){return this.$el.h(a)},a.Events.Catalog=["add","remove","reset","sort","change","change:[attribute]","destroy","request","sync","error","invalid","route:[name]","route","all"],a.noConflict()}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};define("cs!routers/applicationRouter",["jquery","backbone"],function(a,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.routes={"inbox/lastItemChanged":"inbox","inbox(/:state)(/:searchTerm)":"inbox","friends(/:showBack)":"friends",settings:"settings","onboarding(/:panel)":"onboarding"},e.prototype.navigate=function(a,b){return this.dontSaveRoute?this.dontSaveRoute=!1:window.localStorage.lastRoute=a,this.currentRoute=a,e.__super__.navigate.call(this,a,b)},e.prototype.navigateLastRoute=function(){var a,b,e,f,g,h;return d.history.start(),a=d.history.getFragment(),a?(e=a,this.dontSaveRoute=!0):e=window.localStorage.lastRoute||"inbox",b=e.split("/"),f=b[0],"inbox"===f?(g=b[1],"all"!==g&&"new"!==g&&"search"!==g&&(e="inbox")):(h=f,c.call(_.values(this.routes),h)<0&&(e="inbox")),this.trackEvent("Opened",{route:f}),this.navigate(e,{trigger:!0})},e}(d.Router)})}.call(this),!function(a){"use strict";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(255&a[b>>5]>>>b%32);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;16>c;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(15&b>>>4)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}"function"==typeof define&&define.amd?define("jsMD5",[],function(){return t}):a.md5=t}(this),function(){define("cs!common/modules/helpers",["common.config","underscore","jquery","jsMD5"],function(a,b,c,d){var e,f,g,h;return h=function(a){return/\b(https?|ftp|file):\/\/[\-A-Za-z0-9+&@#\/%?=~_|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_|‌​]/.test(a)},g={},f=function(a,b){var d,e;if(document.body.contains(a))return d=document.location.protocol,0!==d.indexOf("http")&&(d="https:"),e=""+d+"//picasaweb.google.com/data/entry/api/user/"+b+"?alt=json",c.get(e,function(d){var e,f,h;return(e=null!=d?null!=(f=d.entry)?null!=(h=f.gphoto$thumbnail)?h.$t:void 0:void 0:void 0)?(g[b]=e,c(a).attr("src",e),c(a).show()):void 0})},e={isObjId:function(a){return/^[0-9a-fA-F]{24}$/.test(a)},showPointHash:"#show-last-Point",setPointInPage:function(a){return this.setPointInStorage(a),this.updateHash(this.showPointHash)},getPointFromPage:function(){return window.location.hash.indexOf(this.showPointHash)>=0?this.getPointFromStorage():window.location.hash.indexOf("pointID=")>-1?window.location.hash.split("pointID=")[1].substring(0,24):!1},getStorageKey:function(){return"pnt_"+document.location.pathname+document.location.search},setPointInStorage:function(a){return null!=a?(this.setPointCookie(a),localStorage[this.getStorageKey()]=a):void 0},getPointFromStorage:function(){return localStorage[this.getStorageKey()]||this.getCookie("pnt_id")},setPointCookie:function(a){var b,c;if(null!=a)return c=new Date,c.setTime(+c+63072e6),b="pnt_id="+a+"; expires="+c.toGMTString(),b+="; path="+document.location.pathname,document.cookie=b},getCookie:function(a){var b,c,d;return d=document.cookie,c=d.indexOf(" "+a+"="),-1===c&&(c=d.indexOf(""+a+"=")),-1===c?d=null:(c=d.indexOf("=",c)+1,b=d.indexOf(";",c),-1===b&&(b=d.length),d=unescape(d.substring(c,b)))},updateHash:function(a){return a?window.location.hash=a:window.history.replaceState("",document.title,window.location.pathname+window.location.search)},random:function(a){var b,c,d,e,f;for(null==a&&(a=5),d="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=e=0,f=a-1;f>=0?f>=e:e>=f;b=f>=0?++e:--e)d+=c.charAt(Math.floor(Math.random()*c.length));return d},normalizeURL:function(a){return a.split("?")[0].split("#")[0]},getHost:function(){return window.location.host.replace("www.","")},getKeywords:function(){var a;return a=[],c.map(c('meta[name="keywords"]'),function(b){return c.each(b.content.split(","),function(b,c){return a.push(c)})}),a},getMetaInfo:function(a){var b;return b="[name*='"+a+"'],[property*='"+a+"']",c("meta").filter(b).attr("content")},getDescription:function(){return this.getMetaInfo("description")},getPageImage:function(){return this.getMetaInfo("image")},getSiteName:function(){return this.getMetaInfo("site_name")},getFavicon:function(a){var b;return b="https:"===window.location.protocol?"https:":"http:",null==a&&(a=document.URL),""+b+"//www.google.com/s2/favicons?domain="+escape(a)},getFaviconHref:function(){var a;return(null!=(a=c('link[rel$="icon"][href*=".ico"]')[0])?a.href:void 0)||e.getFavicon(document.URL)},truncateText:function(a,b){var c;return a.length>b&&(c=a.substring(0,b-3),a=c.substring(0,Math.min(c.length,c.lastIndexOf(" "))),a+="..."),a},getAvatar:function(b){var c;return null!=b.id?"https://graph.facebook.com/"+b.id+"/picture":null!=b.gid?b.gid:null!=b.gmail?(c=d(b.gmail),"http://gravatar.com/avatar/"+c+"?d=404"):null!=b.uid?a.avatarsBaseUrl+"uid/"+b.uid:"https://graph.facebook.com/724191598/picture"},fetchAvatars:function(a){var b;return b={},a.find(".pnt-avatar-placeholder").each(function(){var a,d,e;return e=c(this),d=e.parent(),a=c("<img/>",{src:function(){var a,d;return a=e.attr("data-src"),h(a)?a:(d=g[a])?d:(c(this).hide(),b[a]=this,void 0)},error:function(){return c(this).hide()}}).prependTo(d)}),setTimeout(function(){var c,d,e;c=a[0];for(d in b){if(e=b[d],!c.contains(e))return;f(e,d)}},300)}}})}.call(this),function(){define("cs!common/modules/english",["underscore"],function(a){var b;return b={getInitials:function(b){var c;return null==b&&(b=""),c=b.split(" "),a.reduce(c,function(a,b){return""+a+b.charAt(0).toUpperCase()},"")},capitalizeFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},getFirstName:function(a){return a.split(" ")[0]},listOfItems:function(b,c,d,e,f,g){var h,i,j,k;if(null==e&&(e=""),null==f&&(f=""),null==g&&(g=","),null==b)throw"List not defined";if(0===b.length)throw"List empty";switch(null!=c&&a.isFunction(c)||(c=function(a){return a}),null!=d&&a.isNumber(d)&&d<b.length?(i=d,k=!0):i=b.length,b.length){case 1:return c(b[0]);case 2:return""+c(b[0])+g+" "+c(b[1]);default:return h=0,j="",a.some(b,function(a){return i-1>h?(j+=""+c(a)+", ",h++,!1):k?(j+="and "+(b.length-d+1)+" more",!0):(j+="and "+c(a),h++,!1)}),j}}}})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};define("cs!common/models/messageModel",["backbone","common.config","cs!common/modules/english"],function(a,d,e){var f,g,h,i,j,k;return f=function(a){function f(){var a=this;return this.linkParser=function(){return f.prototype.linkParser.apply(a,arguments)},f.__super__.constructor.apply(this,arguments)
}return b(f,a),f.prototype.urlRoot=d.baseURL+"messages",f.prototype.idAttribute="_id",f.prototype.initialize=function(a,b){return this.point=null!=this.collection?this.collection.point:b.point,window.point=this.point},f.prototype.setPointProps=function(){var a,b;if(b=this.point.get("_id"))return this.set("_pid",b),(a=this.get("highlight"))?a.set("_pid",b):void 0},f.prototype.updateThenSave=function(a){return this.setPointProps(),this.save({},a)},f.prototype.markAsRead=function(){return this.isUnread()?(this.get("read").push(d.user.id),this.save({read:this.get("read")},{patch:!0}),!0):void 0},f.prototype.isUnread=function(){return d.user.isMe(this.get("sender"))?!1:null==_.find(this.get("recip"),d.user.isMe)?!1:!(null!=_.find(this.get("read"),d.user.isMe))},f.prototype.getSenderName=function(a){return null==a&&(a=!1),this.getName(this.get("sender"))},f.prototype.isNewHighlight=function(){var a;return null!=(a=this.get("highlight"))&&!this.point.highlights.get(a._id)},f.prototype.isHighlight=function(){var a;return null!=(a=this.get("highlight"))},f.prototype.getAddEventText=function(a){var b;if(this.collection.first()===this)switch(b=this.getSenderName()){case"you":return"Pointed to "+this.getNameList(a)+".";default:return""+b+" pointed this to "+this.getNameList(a)+"."}return""+e.capitalizeFirstLetter(this.getSenderName())+" added "+this.getNameList(a)+"."},f.prototype.getNameList=function(a,b,c){var d,e=this;switch(null==b&&(b=!1),null==c&&(c="and "),a.length){case 0:throw"No Users";case 1:return this.getName(a[0],b);case 2:return this.getName(a[0],b)+" and "+this.getName(a[1],b);default:return d=0,_.reduce(a,function(f,g){return d++,d===a.length?f+c+e.getName(g,b):f+e.getName(g,b)+", "},"")}},f.prototype.getName=function(a,b){var c,e;return null==b&&(b=!1),d.user.isMe(a)?"you":(c=null!=(e=this.point.getMemberById(a))?e.getName():void 0,b&&(c=c.split(" ")[0]),c)},f.prototype.getPrettyTime=function(){var a,b,c,d,e;return null==this.id||null==this.id.toString().match(/^[0-9a-fA-F]{24}$/)?"now":(d=this.id.toString().substring(0,8),e=new Date(1e3*parseInt(d,16)),c=new Date,b=(c.getTime()-e.getTime())/1e3,a=Math.floor(b/86400),isNaN(a)||0>a?"now":0===a&&(60>b&&"now"||120>b&&"1 min"||3600>b&&Math.floor(b/60)+" mins"||7200>b&&"1 hr"||86400>b&&Math.floor(b/3600)+" hrs")||1===a&&"yesterday"||7>a&&a+" days"||31>a&&(14>a&&"1 week"||Math.floor(a/7)+" weeks")||62>a&&"1 month"||365>a&&Math.floor(a/31)+" months"||730>a&&"1 year"||Math.floor(a/365)+" years")},f.prototype.linkRegex=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;*]*[-A-Z0-9+&@#\/%=~_|])/gi,f.prototype.linkParser=function(a,b){var c;return c=function(a,b){return"<span class='pnt-message-link' href='"+a+"' target='_blank'>"+b+"</span>"},a.replace(this.linkRegex,function(a){return"highlight"===b&&/\.(jpeg|jpg|gif|png)/.test(a)?a:c(a,a)})},f.prototype.decodeStringToHTML=function(a,b,d){var e,f,g,h,k,l,m,n,o,p,q;if(this.isHighlight())return{messageType:"highlight",text:this.linkParser(a,"highlight"),users:[],hashtags:[]};if(e={messageType:"comment",text:"",users:[],hashtags:[]},g="",a=this.linkParser(a,"text"),l=/\(([A-Za-z]+?):(.+?)\)/g,!a.match(l))return e.text=j(a),e;for(h=0;null!==(k=l.exec(a));)switch(n=a.slice(h,k.index),g+=n,i(n)&&(f=!0),h=k.index+k[0].length,k[1]){case"user":if(o=k[2],!(p=b(o)))return!1;g+=p,null!=(null!=(q=this.collection)?q.usersAdded:void 0)&&c.call(this.collection.usersAdded,o)<0&&(m=!0,this.collection.usersAdded.push(o),e.users.push(o));break;case"hashtag":g+=d(k[2]),e.hashtags.push(k[2])}return n=a.slice(h,a.length),g+=n,i(n)&&(f=!0),e.text=j(g),f?e.messageType="comment":(e.users.length&&!e.hashtags.length&&(e.messageType="userAddEvent"),e.users.hashtags&&!e.users.length&&(e.messageType="hashtagAddEvent")),e},f}(a.Model),i=function(a){if("string"!=typeof a)throw new TypeError("hasNonWhitespace requires a string");return/\S/.test(a)},k=function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},h=function(a){return a.replace(/\(/g,"\\(").replace(/\)/g,"\\)")},j=function(a){return a.replace(/\\\(/g,"(").replace(/\\\)/g,")")},g=function(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;")},f})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/messageCollection",["backbone","common.config","cs!common/models/messageModel"],function(a,c,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.QUERY_LIMIT=5,e.prototype.model=d,e.prototype.initialize=function(a,b){if(this.usersAdded=[],null==(null!=b?b.point:void 0)||!(b.point instanceof require("cs!common/models/pointModel")))throw"MessageCollection must be initialized with parent PointModel";return this.point=b.point,this.listenTo(this,"fetch",this.onMessagesReset)},e.prototype.url=function(){return c.baseURL+"messages/point/"+this.id},e.prototype.onMessagesReset=function(){return console.log("yooyyoy"),this.usersAdded=[]},e.prototype.fetchPrevious=function(a,b){var c;return null==a&&(a={}),a.at=0,this.fetchMore(a,b,{before:null!=(c=this.first())?c.id:void 0})},e.prototype.fetchNext=function(a,b){var c;return this.fetchMore(a,b,{after:null!=(c=this.last())?c.id:void 0})},e.prototype.fetchMore=function(a,b,c){var d,f,g;return null==a&&(a={}),a.remove=!1,null==(f=a.data)&&(a.data={}),null==(g=(d=a.data).limit)&&(d.limit=e.QUERY_LIMIT),_.defaults(a.data,c),this.fetch(a)},e}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/highlightModel",["backbone","common.config"],function(a,c){var d;return d=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.urlRoot=c.baseURL+"highlights",d.prototype.idAttribute="_id",d.prototype.isImageHighlight=function(){return"image"===this.get("h_type")?!0:!(null!=this.get("start").txt||null!=this.get("end").txt)&&this.get("start").path===this.get("end").path&&0===_.last(this.get("start").path.split(">")).indexOf("img")},d}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/highlightCollection",["backbone","common.config","cs!common/models/highlightModel"],function(a,c,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.model=d,e.prototype.url=function(){return c.baseURL+"highlights/point/"+this.id},e.prototype.gotEmAll=function(a){var b,c=this;return null==a&&(a=[]),b=_.find(a,function(a){return null!=a.highlight?null==c.get(a.highlight._id):void 0}),null!=b?this.fetch():void 0},e}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/hashtagModel",["backbone","common.config"],function(a,c){var d;return d=function(a){function d(){var a=this;return this.removePoint=function(){return d.prototype.removePoint.apply(a,arguments)},this.addPoint=function(){return d.prototype.addPoint.apply(a,arguments)},this.onSaveSuccess=function(){return d.prototype.onSaveSuccess.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.urlRoot=c.baseURL+"hashtags",d.prototype.idAttribute="_id",d.prototype.onSaveSuccess=function(){return c.hashtags.fetch()},d.prototype.addPoint=function(a){return this.get("_id")!==this.cid&&this.get("count")>0?this.get("p_ids").indexOf(a)<0?(this.get("p_ids").push(a),this.set("count",this.get("count")+1),this.save({},{success:this.onSaveSuccess})):void 0:(this.set("count",1),this.set("p_ids",[a]),this.unset("_id"),this.save({},{success:this.onSaveSuccess}))},d.prototype.removePoint=function(a){var b;return(b=this.get("p_ids").indexOf(a))>=0?(this.get("p_ids").splice(b,1),this.set("count",this.get("count")-1),this.save({},{success:this.onSaveSuccess})):void 0},d}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/friendModel",["backbone","common.config"],function(a){var c;return c=function(c){function d(b,c){null==b&&(b={}),null==c&&(c={}),null==b.pid&&(b.pid=b.uid||b.id||b.email),null==b._term&&(b._term=b.name,b.email&&b.email!==b.name&&(b._term+=" "+b.email)),b.email?b.value=b.email:b.name&&(b.value=b.name),a.Model.apply(this,arguments)}return b(d,c),d.prototype.idAttribute="pid",d.prototype.increaseScore=function(){return this.get("pnt_user")&&this.collection?this.collection.increaseScoreOf(this):void 0},d.prototype.getName=function(a){var b;return b=a?this.get("name")||this.get("value"):this.get("value")||this.get("name"),null!=b?b:""},d.prototype.getType=function(a){if("100006630185561"===this.get("id"))return"pointTeam";if(null!=this.get("uid")){if(this.has("gdomain")&&null!=a&&this.get("gdomain")===a)return"gdomain";if(this.has("gid")||this.has("gmail"))return"gmailOnPoint";if(this.has("id"))return"facebookOnPoint"}else{if(this.has("id"))return"facebook";if(this.has("email"))return"gmail"}},d.prototype.isInGdomain=function(a){return a?a===this.get("gdomain"):null!=this.get("gdomain")},d}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};define("cs!common/models/pointModel",["backbone","common.config","cs!common/browser/browser","cs!common/modules/helpers","cs!common/models/messageModel","cs!common/collections/messageCollection","cs!common/collections/highlightCollection","cs!common/models/hashtagModel","cs!common/models/highlightModel","cs!common/models/friendModel"],function(a,d,e,f,g,h,i,j,k,l){var m,n;return n=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.model=l,c.prototype.set=function(a,b){return null==a&&(a=[]),_.isArray(a)||(a=[a]),a=a.map(_.bind(this._prepareModel,this)),c.__super__.set.call(this,a,b)},c}(a.Collection),m=function(l){function m(){var a=this;return this.updateInvites=function(){return m.prototype.updateInvites.apply(a,arguments)},this.onSavePointSuccess=function(){return m.prototype.onSavePointSuccess.apply(a,arguments)},this.onSaveMessageError=function(){return m.prototype.onSaveMessageError.apply(a,arguments)},this.addMessage=function(){return m.prototype.addMessage.apply(a,arguments)},this.onSaveMessageSuccess=function(){return m.prototype.onSaveMessageSuccess.apply(a,arguments)},this.removeNotification=function(){return m.prototype.removeNotification.apply(a,arguments)},this.isUnread=function(){return m.prototype.isUnread.apply(a,arguments)},this.setReadStatus=function(b){return null==b&&(b=!0),m.prototype.setReadStatus.apply(a,arguments)},this.onMessageAdd=function(){return m.prototype.onMessageAdd.apply(a,arguments)},this.onMessagesAdded=function(){return m.prototype.onMessagesAdded.apply(a,arguments)},this.setCreated=function(){return m.prototype.setCreated.apply(a,arguments)},m.__super__.constructor.apply(this,arguments)}return b(m,l),m.prototype.isCreated=!1,m.prototype.afterFirstFetch=!1,m.prototype.messageSendSuccess=!0,m.prototype.defaults=function(){return{users:new n,m_count:0,clicked:[],seen:[],msgs:[],on_high:!1}},m.prototype.initialize=function(){var b;return _.bindAll(this,"sendMessage","onFirstSync","setLastMsgFetched","removeHashtagFromPoint","saveHashtags","addHashtags","markAsSeen","markAsClicked"),this.memberId=d.user.id,this.messages=new h(this.get("msgs"),{point:this}),this.hashtags=new a.Collection([],{model:j}),this.highlights=new i,this.invites=new a.Collection,null!=this.id?(this.setCreated(),this.listenToOnce(this,"sync",this.onFirstSync)):(this.setUserInfo(),this.setPageInfo()),this.listenTo(this,"messageSend",this.sendMessage),this.listenTo(this,"highlights:add",this.renderHighlight),this.listenTo(this,"hashtags:remove",this.removeHashtagFromPoint),this.listenTo(a,"fetch:point",this.fetch),this.listenTo(this.messages,"add",this.onMessageAdd),this.debouncedOnMessagesAdded=_.debounce(this.onMessagesAdded,10),this.unreadMessages=(null!=(b=this.messages.last())?b.isUnread():void 0)?1:0,this.setReadStatus(!1)},m.prototype.setCreated=function(){return this.isCreated=!0,this.messages.id=this.highlights.id=this.id},m.prototype.onFirstSync=function(){var b,c;return this.afterFirstFetch=!0,!this.isSeen()&&(this.markAsSeen(),this.isOnHighlight())?(b=null!=(c=this.highlights.first())?c.id:void 0,a.trigger("scrollToHighlight",b,!0)):void 0},m.prototype.onMessagesAdded=function(){return this.setLastMsg(),this.setReadStatus()},m.prototype.onMessageAdd=function(a){var b;return(b=a.isUnread())?this.unreadMessages++:this.unreadMessages=0,this.debouncedOnMessagesAdded()},m.prototype.setReadStatus=function(a){var b;return null==a&&(a=!0),b=!this.unreadMessages,a&&b&&this.removeNotification(),this.set("read",b),this.set("unreadCount",this.unreadMessages)},m.prototype.lastMsg=function(){return this.lastMessage||this.setLastMsg()},m.prototype.setLastMsg=function(){var a;return(a=this.messages.last())?this.lastMessage=a:(a=this.get("msgs")[0])?this.lastMessage=new g(a,{point:this}):void 0},m.prototype.isUnread=function(){var a;return null!=(a=this.lastMsg())?a.isUnread():void 0},m.prototype.markAsRead=function(){var a;return null!=(a=this.lastMsg())&&a.markAsRead(),this.unreadMessages=0,this.setReadStatus()},m.prototype.removeNotification=function(){return e.extension.sendMessage({request:"remove:notification",details:{id:this.id}})},m.prototype.hasHighlight=function(){return null!=this.get("highlight")},m.prototype.isOnHighlight=function(){return this.hasHighlight()&&this.get("on_high")},m.prototype.getMemberById=function(a){return this.get("users").get(a)||this.get("users").find(function(b){return a===b.get("id")||a===b.get("email")||a===b.get("uid")})},m.prototype.verifyMembership=function(){return null!=this.getMemberById(d.user.id)},m.prototype.getRecipients=function(){return _.reject(this.get("users").pluck("pid"),d.user.isMe)},m.prototype.isSeen=function(){var a;return a=this.memberId,c.call(this.get("seen"),a)>=0||this.memberId===this.get("sender")},m.prototype.isClicked=function(){var a;return a=this.memberId,c.call(this.get("clicked"),a)>=0},m.prototype.sendMessage=function(a,b,c,e){var f,h,i,j,k,l=this;return a=a.trim(),this.messageSendSuccess&&a.length?(this.messageSendSuccess=!1,i={sender:d.user.id,recip:this.getRecipients(),body:a,read:[]},k=!1,(null!=b?b.length:void 0)&&(j=[],f=this.get("users"),b.each(function(a){var b;return a.id===d.user.id?(k=!0,i.body=i.body.replace("(user:"+d.user.id+")","").trim(),b=f.get(d.user.id)?f.remove(d.user.id,{silent:!0}):d.user.simple(),l.setUsers(b),void 0):null==l.getMemberById(a.id)?(a.increaseScore(),j.push(a.toJSON())):void 0}),j.length?i.user_adds=j:k&&!this.isCreated&&(this._sentToSelf=!0)),null!=e&&(e.set({_pid:this.id,url:document.URL,likes:[],owner:d.user.id,uid:d.user.id}),i.highlight=e),i.body.length&&(h=new g(i,{point:this})),this.isCreated?h?h.updateThenSave({success:this.onSaveMessageSuccess,error:this.onSaveError}):this.messageSendSuccess=!0:(h&&this.set("msgs",[h.toJSON()]),this.set("on_high",null!=e),this.setPageInfo(),this.save({},{success:this.onSavePointSuccess,error:this.onSaveMessageError}))):void 0},m.prototype.onSaveMessageSuccess=function(b){var c,d;return this.messageSendSuccess=!0,this.addMessage(b),b.get("highlight")?void 0:(d={increment:{messagesSent:1}},null!=(c=b.get("new_users"))&&(c.forEach(function(a){var b;return(b=a.uid?"pointFriendsAdded":a.email?"emailsInvited":a.id?"fbFriendsAdded":void 0)?d[b]=(d[b]||0)+1:void 0}),d.emailsInvited&&(d.increment.emailsInvited=d.emailsInvited)),a.trigger("mixpanel:event","Send Message",d))},m.prototype.addMessage=function(a){var b,c;if(!(a instanceof g)){if(a._pid!==this.id)return;a=new g(a,{point:this})}return null!=(b=a.get("highlight"))&&this.setHighlights(new k(b)),null!=(c=a.get("new_users"))&&this.setUsers(c,{merge:!0}),this.setMessages(a),d.user.isMe(a.get("sender"))?void 0:this.setLastMsgFetched()},m.prototype.onSaveMessageError=function(){return this.messageSendSuccess=!0},m.prototype.onSavePointSuccess=function(){var a,b;return(a=null!=(b=this.messages)?b.first():void 0)?this.onSaveMessageSuccess(a):this.messageSendSuccess=!0,this.setCreated(),this.trigger("pointModel:created",this),f.setPointInStorage(this.id),this.invites.length?this.updateInvites({_pid:this.id}):void 0},m.prototype.updateInvites=function(a){return this.invites.each(function(b){return b.set(a).save()})},m.prototype.setLastMsgFetched=function(){var a;return this.lastMsgFetched=null!=(a=this.messages.last())?a.id:void 0},m.prototype.setUserInfo=function(){return this.get("clicked").push(d.user.id),this.set("sender",d.user.id),this.setUsers(d.user.simple())},m.prototype.setPageInfo=function(){var a;return a={url:document.URL,n_u:f.getHost(),meta:f.getKeywords(),descr:f.getDescription(),title:document.title,favicon:f.getFaviconHref(),site:f.getSiteName(),image:f.getPageImage()},this.set("page",a)},m.prototype.markAsSeen=function(){return this.isCreated&&!this.isSeen()?(this.get("seen").push(d.user.id),this.save({seen:this.get("seen")},{patch:!0})):void 0},m.prototype.markAsClicked=function(){return this.isClicked()?void 0:(this.get("clicked").push(d.user.id),this.save({clicked:this.get("clicked")},{patch:!0}))},m.prototype.addHashtags=function(a,b){var c;return(null!=a?a.length:void 0)?(a.each(function(a){return a.collection=this.hashtags,this.setHashtags(a),b=b.replace("#"+a.get("hashtag"),"")},this),this.isCreated&&this.saveHashtags(),c=0===b.trim().length):!1},m.prototype.saveHashtags=function(){var a;if(null!=(a=this.get("_id")))return this.hashtags.each(function(b){return b.addPoint(a)})},m.prototype.removeHashtagFromPoint=function(a){return a.removePoint(this.get("_id"))},m.prototype.renderHighlight=function(b){return a.trigger("highlights:render",b)},m.prototype.parse=function(a,b){var c;return null==a&&(a={}),null==b&&(b={}),c=m.__super__.parse.call(this,a,b),null!=a.users&&(c.users=this.setUsers(a.users)),null!=a.hashtags&&delete a.hashtags,null!=a.highlights&&(this.setHighlights(a.highlights),delete a.highlights),null!=a.messages&&(this.setMessages(a.messages,b),this.setLastMsgFetched(),this.highlights.gotEmAll(a.messages),a.messages.length||e.extension.sendMessage({request:"remove:notification",details:{id:this.id}}),delete a.messages),c},m.prototype.setMessages=function(a,b){var c;return null==b&&(b={}),this.messages instanceof h?(c=b.reset?"reset":"add",this.messages[c](a,b)):this.messages=new h(a,{point:this}),this.messages},m.prototype.setUsers=function(a,b){var c,d;return null==b&&(b={}),c=null!=(d=this.get("users"))?d:[],c instanceof n||this.set("users",new n(c)),this.get("users").add(a,b),this.get("users")},m.prototype.setHashtags=function(b,c){return null==c&&(c={}),this.hashtags instanceof a.Collection?this.hashtags.add(b,c):this.hashtags=new a.Collection(b,{model:j}),this.hashtags},m.prototype.setHighlights=function(a,b){return null==b&&(b={}),this.highlights instanceof i?this.highlights.add(a,b):this.highlights=new i(a),this.highlights},m.prototype.toJSON=function(){var a;return a=_.clone(this.attributes),_.each(a,function(a,b,c){return _(a.toJSON).isFunction()?c[b]=a.toJSON():void 0}),a},m.prototype.on=function(b,c,d){var e,f,g;if(f=(g=b.split(":"))[0],e=g[1],null!=f&&a.Events.Catalog.indexOf(e>-1))switch(g.length>2&&(e=g.splice(1).join(":")),f){case"hashtags":return this.hashtags.on(e,c,d);case"messages":return this.messages.on(e,c,d);case"highlights":return this.highlights.on(e,c,d);case"users":return this.get("users").on(e,c,d)}return m.__super__.on.call(this,b,c,d)},m.prototype.url=function(a){var b,c;return c={user:d.user.id},this.isCreated&&(b=this.lastMsgFetched||this.setLastMsgFetched(),this.afterFirstFetch&&this.messages.get(b)?c.after=b:c.all=!0),m.__super__.url.call(this,a)+"?"+$.param(c)},m.prototype.urlRoot=d.baseURL+"points",m.prototype.idAttribute="_id",m}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/pointCollection",["backbone","common.config","cs!common/models/pointModel"],function(a,c,d){var e;return e=function(e){function f(){return f.__super__.constructor.apply(this,arguments)}return b(f,e),f.prototype.model=d,f.FAILURE_COUNT=3,f.prototype.failureCount=f.FAILURE_COUNT,f.prototype.initialize=function(b,c){var d;return(d=null!=c?c.url:void 0)&&(this.url=d),this.listenToOnce(this,"error",this.onFetchError),this.listenTo(this,"sync",function(){return a.trigger("errorClose")})},f.prototype.onFetchError=function(b,c,d){var e=this;return this.seconds=5,a.trigger("error","We're having problems fetching your points right now."),this.failureCount<1?(console.log("timeout"),this.failureCount=f.FAILURE_COUNT,void 0):setTimeout(function(){return e.failureCount=e.failureCount-1,e.listenToOnce(e,"error",e.onFetchError),e.fetch(d)},1e3*this.seconds)},f.prototype.url=function(){return c.baseURL+"points/of/user/"+c.user.id},f.prototype.fetch=function(a){var b;return null==a&&(a={}),null==(b=a.remove)&&(a.remove=!1),f.__super__.fetch.call(this,a)},f.prototype.fetchMore=function(a){var b,c;return null==a&&(a={}),null==(c=a.data)&&(a.data={}),(b=this.last())&&(a.data.before=b.get("changed")),this.fetch(a)},f.prototype.mergePoint=function(a){var b;return(b=this.get(a.id))?(b.messages.reset(a.messages.models),b.setUsers(a.get("users").models),b):(this.add(a),a)},f}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!collections/searchablePointCollection",["backbone","common.config","cs!common/collections/pointCollection","cs!common/models/pointModel"],function(a,c,d){var e,f;return f={SEARCH:"SEARCH",BY_USER:"BY_USER"},e=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.filters=f,d.prototype.searchTerm="",d.prototype.usersToFilter=[],d.prototype.filter=f.INBOX,d.prototype.initialize=function(a,b){return null==b&&(b={}),d.__super__.initialize.call(this,a,b),b.filter?this.filter=b.filter:void 0},d.prototype.url=function(){var a;return a=function(){switch(this.filter){case f.SEARCH:return"search/points";case f.BY_USER:return"points/filter/with";default:return"points/of/user/"+c.user.id}}.call(this),c.baseURL+a},d.prototype.fetch=function(a){return null==a&&(a={}),a._isNextPage||(a.reset=!0),d.__super__.fetch.call(this,a)},d.prototype.fetchMore=function(a){var b,c,d;if(null==a&&(a={}),a._isNextPage=!0,a.reset=!1,null==(d=a.data)&&(a.data={}),this.searchTerm.length&&(a.data.term=this.searchTerm),this.usersToFilter.length&&(a.data.users=this.usersToFilter),this.filter===f.SEARCH){if(this._searchResults){if(c=this._searchResults.page+1,c>this._searchResults.nbPages)return;a.data.page=c}}else(b=this.last())&&(a.data.before=b.get("changed"));return this.fetch(a)},d.prototype.parse=function(a){return this._searchResults=null,a instanceof Array?a:(null!=a?a.points:void 0)?(this._searchResults=a,a.points):[]},d.prototype.emptySearch=function(a){return this.usersToFilter=[],this.searchTerm="",this.reset([],a)},d.prototype.fetchWithFilter=function(a,b){var c;return null==a&&(a=""),null==b&&(b=[]),a=a.trim(),this.usersToFilter=b,this.searchTerm=a,b.length||a.length?(c={},b.length&&(c.users=b),a.length?(c.term=a,this.filter=f.SEARCH):b.length&&(this.filter=f.BY_USER),this.fetch({data:c,reset:!0}),!0):(this.emptySearch(),!1)},d}(d)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/pageView",["common.config","underscore","backbone"],function(a,c,d){var e;return e=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.className="dropdown-page",c.prototype.initialize=function(a){if(this.order=a.order,null==a.appendTo)throw"No appendTo element passed to PageView";return null!=a.template&&(this.template=a.template),this.$page=$("<div class='dropdown-page-content'></div>").appendTo(this.$el),this.template&&this.render(),a.appendTo.append(this.$el),this.hide()},c.prototype.render=function(){var a,b;return b=this.locals?this.locals.call(this):{},a=this.template.call(this,b),this.$page.html(a)},c.prototype.hide=function(){return this.$el.addClass("pnt-is-hidden"),this},c.prototype.show=function(){return this.$el.removeClass("pnt-is-hidden"),this},c.prototype.hideLeft=function(){return this.$el.removeClass("enter-left enter-right"),this.$el.addClass("hide-left"),this},c.prototype.hideRight=function(){return this.$el.removeClass("enter-left enter-right"),this.$el.addClass("hide-right"),this},c.prototype.enterLeft=function(){return this.show(),this.$el.removeClass("hide-right hide-left"),this.$el.addClass("enter-left"),this},c.prototype.enterRight=function(){return this.show(),this.$el.removeClass("hide-right hide-left"),this.$el.addClass("enter-right"),this},c.prototype.renderTopBar=function(a){return this.renderBar(a,"top")},c.prototype.renderBottomBar=function(a){return this.renderBar(a,"bottom")},c.prototype.renderBar=function(a,b){return this.$el.addClass("dd-page-has-"+b+"-bar").append("<div class='page-bar page-bar-"+b+"'>\n    "+a+"\n</div>")},c}(d.View)})}.call(this);var jade=function(a){function b(a){return null!=a&&""!==a}function c(a){return Array.isArray(a)?a.map(c).filter(b).join(" "):a}return Array.isArray||(Array.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),a.merge=function(a,c){var d=a["class"],e=c["class"];(d||e)&&(d=d||[],e=e||[],Array.isArray(d)||(d=[d]),Array.isArray(e)||(e=[e]),a["class"]=d.concat(e).filter(b));for(var f in c)"class"!=f&&(a[f]=c[f]);return a},a.attrs=function(b,d){var e=[],f=b.terse;delete b.terse;var g=Object.keys(b),h=g.length;if(h){e.push("");for(var i=0;h>i;++i){var j=g[i],k=b[j];"boolean"==typeof k||null==k?k&&(f?e.push(j):e.push(j+'="'+j+'"')):0==j.indexOf("data")&&"string"!=typeof k?e.push(j+"='"+JSON.stringify(k)+"'"):"class"==j?d&&d[j]?(k=a.escape(c(k)))&&e.push(j+'="'+k+'"'):(k=c(k))&&e.push(j+'="'+k+'"'):d&&d[j]?e.push(j+'="'+a.escape(k)+'"'):e.push(j+'="'+k+'"')}}return e.join(" ")},a.escape=function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},a.rethrow=function d(a,b,c,e){if(!(a instanceof Error))throw a;if(!("undefined"==typeof window&&b||e))throw a.message+=" on line "+c,a;try{e=e||require("fs").readFileSync(b,"utf8")}catch(f){d(a,null,c)}var g=3,h=e.split("\n"),i=Math.max(c-g,0),j=Math.min(h.length,c+g),g=h.slice(i,j).map(function(a,b){var d=b+i+1;return(d==c?"  > ":"    ")+d+"| "+a}).join("\n");throw a.path=b,a.message=(b||"Jade")+":"+c+"\n"+g+"\n\n"+a.message,a},a}({});define("jade",jade),define("jade",{version:"0.0.3",load:function(){}}),define("jade!templates/helpTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<div class="modal-screen"></div><div class="modal-content modal-scrolls modal-has-menu tos-modal"><div class="pnt-menu pnt-menu-h modal-content-menu"><div class="pnt-menu-list-item is-pnt-menu-list-item-active"><a href="#" data-to-show="#tos-text">Terms of Service</a></div><div class="pnt-menu-list-item"><a href="#" data-to-show="#eula-text">EULA</a></div></div><div class="modal-content-scroll"><div id="tos-text" class="pnt-txt-align-l text-pane">'+(null==(jade.interp=tosCopy)?"":jade.interp)+'</div><div id="eula-text" class="pnt-txt-align-l text-pane">'+(null==(jade.interp=eulaCopy)?"":jade.interp)+'</div></div><div class="modal-close"><i class="pntcn-x"></i></div></div>');return buf.join("")}}),define("text",{}),define("mdown",[],function(){return{load:function(){}}}),define("mdown!copy/termsOfService.md",[],function(){return"<h1>Terms of Use</h1>\n\n<p>Last Modified: 7/29/2014</p>\n\n<h2>Acceptance of the Terms of Use</h2>\n\n<p>Welcome to the website of Point App, Inc. (\"Company\", \"we\" or \"us\"). The following terms and conditions, together with any documents they expressly incorporate by reference (collectively, these \"Terms of Use\"), govern your access to and use of Point, including any content, functionality and services offered on or through <a href='http://www.getpoint.co' target='_blank'>http://www.getpoint.co</a> (the \"Website\").</p>\n\n<p>Please read the Terms of Use carefully before you start to use the Website. By using the Website, you accept and agree to be bound and abide by these Terms of Use and our Privacy Policy, found at <a href='http://getpoint.co/legal/' target='_blank'>http://getpoint.co/legal/</a>, incorporated herein by reference. If you do not want to agree to these Terms of Use or the Privacy Policy, you must not access or use the Website.</p>\n\n<p>This Website is offered and available to users who 18 years of age or older, reside in the United States or any of its territories or possessions. By using this Website, you represent and warrant that you are of legal age to form a binding contract with the Company and meet all of the foregoing eligibility requirements. If you do not meet all of these requirements, you must not access or use the Website.</p>\n\n<h2>Changes to the Terms of Use</h2>\n\n<p>We may revise and update these Terms of Use from time to time in our sole discretion. All changes are effective immediately when we post them, and apply to all access to and use of the Website thereafter.</p>\n\n<p>Your continued use of the Website following the posting of revised Terms of Use means that you accept and agree to the changes. You are expected to check this page from time to time so you are aware of any changes, as they are binding on you.</p>\n\n<h2>Accessing the Website and Account Security</h2>\n\n<p>We reserve the right to withdraw or amend this Website, and any service or material we provide on the Website, in our sole discretion without notice. We will not be liable if for any reason all or any part of the Website is unavailable at any time or for any period. From time to time, we may restrict access to some parts of the Website, or the entire Website, to users, including registered users.</p>\n\n<p>You are responsible for:\n* Making all arrangements necessary for you to have access to the Website.\n* Ensuring that all persons who access the Website through your Internet connection are aware of these Terms of Use and comply with them.</p>\n\n<p>To access the Website or some of the resources it offers, you may be asked to provide certain registration details or other information. It is a condition of your use of the Website that all the information you provide on the Website is correct, current and complete. You agree that all information you provide to register with this Website or otherwise, including but not limited to through the use of any interactive features on the Website, is governed by our Privacy Policy <a href='http://getpoint.co/legal/' target='_blank'>http://getpoint.co/legal/</a>, and you consent to all actions we take with respect to your information consistent with our Privacy Policy.</p>\n\n<p>If you choose, or are provided with, a user name, password or any other piece of information as part of our security procedures, you must treat such information as confidential, and you must not disclose it to any other person or entity. You also acknowledge that your account is personal to you and agree not to provide any other person with access to this Website or portions of it using your user name, password or other security information. You agree to notify us immediately of any unauthorized access to or use of your user name or password or any other breach of security. You also agree to ensure that you exit from your account at the end of each session. You should use particular caution when accessing your account from a public or shared computer so that others are not able to view or record your password or other personal information.</p>\n\n<p>We have the right to disable any user name, password or other identifier, whether chosen by you or provided by us, at any time in our sole discretion for any or no reason, including if, in our opinion, you have violated any provision of these Terms of Use.</p>\n\n<h2>Intellectual Property Rights</h2>\n\n<p>The Website and its entire contents, features and functionality (including but not limited to all information, software, text, displays, images, video and audio, and the design, selection and arrangement thereof), are owned by the Company, its licensors or other providers of such material and are protected by United States and international copyright, trademark, patent, trade secret and other intellectual property or proprietary rights laws.</p>\n\n<p>These Terms of Use permit you to use the Website for your personal, non-commercial use only. You must not reproduce, distribute, modify, create derivative works of, publicly display, publicly perform, republish, download, store or transmit any of the material on our Website, except as follows:\n* Your computer may temporarily store copies of such materials incidental to your accessing and viewing those materials.\n* You may store files that are automatically cached by your Web browser for display enhancement purposes.\n* You may print or download one copy of a reasonable number of pages of the Website for your own personal, non-commercial use and not for further reproduction, publication or distribution.\n* If we provide desktop, mobile or other applications for download, you may download a single copy to your computer or mobile device solely for your own personal, non-commercial use, provided you agree to be bound by our end user license agreement for such applications.\nYou must not:\n* Modify copies of any materials from this site.\n* Use any illustrations, photographs, video or audio sequences or any graphics separately from the accompanying text.\n* Delete or alter any copyright, trademark or other proprietary rights notices from copies of materials from this site.\nYou must not access or use for any commercial purposes any part of the Website or any services or materials available through the Website.\nIf you print, copy, modify, download or otherwise use or provide any other person with access to any part of the Website in breach of the Terms of Use, your right to use the Website will cease immediately and you must, at our option, return or destroy any copies of the materials you have made. No right, title or interest in or to the Website or any content on the Website is transferred to you, and all rights not expressly granted are reserved by the Company. Any use of the Website not expressly permitted by these Terms of Use is a breach of these Terms of Use and may violate copyright, trademark and other laws.</p>\n\n<h2>Trademarks</h2>\n\n<p>The Company name, the terms “Point App” and “Get Point,” the Company logo and all related names, logos, product and service names, designs and slogans are trademarks of the Company or its affiliates or licensors. You must not use such marks without the prior written permission of the Company. All other names, logos, product and service names, designs and slogans on this Website are the trademarks of their respective owners.</p>\n\n<h2>Prohibited Uses</h2>\n\n<p>You may use the Website only for lawful purposes and in accordance with these Terms of Use. You agree not to use the Website:\n* In any way that violates any applicable federal, state, local or international law or regulation (including, without limitation, any laws regarding the export of data or software to and from the US or other countries).\n* For the purpose of exploiting, harming or attempting to exploit or harm minors in any way by exposing them to inappropriate content, asking for personally identifiable information or otherwise.\n* To transmit, or procure the sending of, any advertising or promotional material, including any \"junk mail\", \"chain letter\" or \"spam\" or any other similar solicitation.\n* To impersonate or attempt to impersonate the Company, a Company employee, another user or any other person or entity (including, without limitation, by using e-mail addresses or screen names associated with any of the foregoing).\n* To engage in any other conduct that restricts or inhibits anyone's use or enjoyment of the Website, or which, as determined by us, may harm the Company or users of the Website or expose them to liability.\nAdditionally, you agree not to:\n* Use the Website in any manner that could disable, overburden, damage, or impair the site or interfere with any other party's use of the Website, including their ability to engage in real time activities through the Website.\n* Use any robot, spider or other automatic device, process or means to access the Website for any purpose, including monitoring or copying any of the material on the Website.\n* Use any manual process to monitor or copy any of the material on the Website or for any other unauthorized purpose without our prior written consent.\n* Use any device, software or routine that interferes with the proper working of the Website.\n* Introduce any viruses, Trojan horses, worms, logic bombs or other material that is malicious or technologically harmful.\n* Attempt to gain unauthorized access to, interfere with, damage or disrupt any parts of the Website, the server on which the Website is stored, or any server, computer or database connected to the Website.\n* Attack the Website via a denial-of-service attack or a distributed denial-of-service attack.\n* Otherwise attempt to interfere with the proper working of the Website.</p>\n\n<h2>Changes to the Website</h2>\n\n<p>We may update the content on this Website from time to time, but its content is not necessarily complete or up-to-date. Any of the material on the Website may be out of date at any given time, and we are under no obligation to update such material.</p>\n\n<h2>Information About You and Your Visits to the Website</h2>\n\n<p>All information we collect on this Website is subject to our Privacy Policy <a href='http://getpoint.co/legal/' target='_blank'>http://getpoint.co/legal/</a>. By using the Website, you consent to all actions taken by us with respect to your information in compliance with the Privacy Policy.</p>\n\n<h2>Links from the Website</h2>\n\n<p>If the Website contains links to other sites and resources provided by third parties, these links are provided for your convenience only. This includes links contained in advertisements, including banner advertisements and sponsored links. We have no control over the contents of those sites or resources, and accept no responsibility for them or for any loss or damage that may arise from your use of them. If you decide to access any of the third party websites linked to this Website, you do so entirely at your own risk and subject to the terms and conditions of use for such websites.</p>\n\n<h2>Geographic Restrictions</h2>\n\n<p>The owner of the Website is based in the state of New York in the United States. We provide this Website for use only by persons located in the United States. We make no claims that the Website or any of its content is accessible or appropriate outside of the United States. Access to the Website may not be legal by certain persons or in certain countries. If you access the Website from outside the United States, you do so on your own initiative and are responsible for compliance with local laws.</p>\n\n<h2>Disclaimer of Warranties</h2>\n\n<p>You understand that we cannot and do not guarantee or warrant that files available for downloading from the Internet or the Website will be free of viruses or other destructive code. You are responsible for implementing sufficient procedures and checkpoints to satisfy your particular requirements for anti-virus protection and accuracy of data input and output, and for maintaining a means external to our site for any reconstruction of any lost data. WE WILL NOT BE LIABLE FOR ANY LOSS OR DAMAGE CAUSED BY A DISTRIBUTED DENIAL-OF-SERVICE ATTACK, VIRUSES OR OTHER TECHNOLOGICALLY HARMFUL MATERIAL THAT MAY INFECT YOUR COMPUTER EQUIPMENT, COMPUTER PROGRAMS, DATA OR OTHER PROPRIETARY MATERIAL DUE TO YOUR USE OF THE WEBSITE OR ANY SERVICES OR ITEMS OBTAINED THROUGH THE WEBSITE OR TO YOUR DOWNLOADING OF ANY MATERIAL POSTED ON IT, OR ON ANY WEBSITE LINKED TO IT.\nYOUR USE OF THE WEBSITE, ITS CONTENT AND ANY SERVICES OR ITEMS OBTAINED THROUGH THE WEBSITE IS AT YOUR OWN RISK. THE WEBSITE, ITS CONTENT AND ANY SERVICES OR ITEMS OBTAINED THROUGH THE WEBSITE ARE PROVIDED ON AN \"AS IS\" AND \"AS AVAILABLE\" BASIS, WITHOUT ANY WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED. NEITHER THE COMPANY NOR ANY PERSON ASSOCIATED WITH THE COMPANY MAKES ANY WARRANTY OR REPRESENTATION WITH RESPECT TO THE COMPLETENESS, SECURITY, RELIABILITY, QUALITY, ACCURACY OR AVAILABILITY OF THE WEBSITE. WITHOUT LIMITING THE FOREGOING, NEITHER THE COMPANY NOR ANYONE ASSOCIATED WITH THE COMPANY REPRESENTS OR WARRANTS THAT THE WEBSITE, ITS CONTENT OR ANY SERVICES OR ITEMS OBTAINED THROUGH THE WEBSITE WILL BE ACCURATE, RELIABLE, ERROR-FREE OR UNINTERRUPTED, THAT DEFECTS WILL BE CORRECTED, THAT OUR SITE OR THE SERVER THAT MAKES IT AVAILABLE ARE FREE OF VIRUSES OR OTHER HARMFUL COMPONENTS OR THAT THE WEBSITE OR ANY SERVICES OR ITEMS OBTAINED THROUGH THE WEBSITE WILL OTHERWISE MEET YOUR NEEDS OR EXPECTATIONS.\nTHE COMPANY HEREBY DISCLAIMS ALL WARRANTIES OF ANY KIND, WHETHER EXPRESS OR IMPLIED, STATUTORY OR OTHERWISE, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, NON-INFRINGEMENT AND FITNESS FOR PARTICULAR PURPOSE.\nTHE FOREGOING DOES NOT AFFECT ANY WARRANTIES WHICH CANNOT BE EXCLUDED OR LIMITED UNDER APPLICABLE LAW.</p>\n\n<h2>Limitation on Liability</h2>\n\n<p>IN NO EVENT WILL THE COMPANY, ITS AFFILIATES OR THEIR LICENSORS, SERVICE PROVIDERS, EMPLOYEES, AGENTS, OFFICERS OR DIRECTORS BE LIABLE FOR DAMAGES OF ANY KIND, UNDER ANY LEGAL THEORY, ARISING OUT OF OR IN CONNECTION WITH YOUR USE, OR INABILITY TO USE, THE WEBSITE, ANY WEBSITES LINKED TO IT, ANY CONTENT ON THE WEBSITE OR SUCH OTHER WEBSITES OR ANY SERVICES OR ITEMS OBTAINED THROUGH THE WEBSITE OR SUCH OTHER WEBSITES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, CONSEQUENTIAL OR PUNITIVE DAMAGES, INCLUDING BUT NOT LIMITED TO, PERSONAL INJURY, PAIN AND SUFFERING, EMOTIONAL DISTRESS, LOSS OF REVENUE, LOSS OF PROFITS, LOSS OF BUSINESS OR ANTICIPATED SAVINGS, LOSS OF USE, LOSS OF GOODWILL, LOSS OF DATA, AND WHETHER CAUSED BY TORT (INCLUDING NEGLIGENCE), BREACH OF CONTRACT OR OTHERWISE, EVEN IF FORESEEABLE.\nTHE FOREGOING DOES NOT AFFECT ANY LIABILITY WHICH CANNOT BE EXCLUDED OR LIMITED UNDER APPLICABLE LAW.</p>\n\n<h2>Indemnification</h2>\n\n<p>You agree to defend, indemnify and hold harmless the Company, its affiliates, licensors and service providers, and its and their respective officers, directors, employees, contractors, agents, licensors, suppliers, successors and assigns from and against any claims, liabilities, damages, judgments, awards, losses, costs, expenses or fees (including reasonable attorneys' fees) arising out of or relating to your violation of these Terms of Use or your use of the Website, including, but not limited to, your User Contributions, any use of the Website's content, services and products other than as expressly authorized in these Terms of Use or your use of any information obtained from the Website.</p>\n\n<h2>Governing Law and Jurisdiction</h2>\n\n<p>All matters relating to the Website and these Terms of Use and any dispute or claim arising therefrom or related thereto (in each case, including non-contractual disputes or claims), shall be governed by and construed in accordance with the internal laws of the State of New York without giving effect to any choice or conflict of law provision or rule (whether of the State of New York or any other jurisdiction).\nAny legal suit, action or proceeding arising out of, or related to, these Terms of Use or the Website shall be instituted exclusively in the federal courts of the United States or the courts of the State of New York, in each case located in the City and County of New York. You waive any and all objections to the exercise of jurisdiction over you by such courts and to venue in such courts.</p>\n\n<h2>Waiver and Severability</h2>\n\n<p>No waiver of by the Company of any term or condition set forth in these Terms of Use shall be deemed a further or continuing waiver of such term or condition or a waiver of any other term or condition, and any failure of the Company to assert a right or provision under these Terms of Use shall not constitute a waiver of such right or provision.</p>\n\n<p>If any provision of these Terms of Use is held by a court or other tribunal of competent jurisdiction to be invalid, illegal or unenforceable for any reason, such provision shall be eliminated or limited to the minimum extent such that the remaining provisions of the Terms of Use will continue in full force and effect.</p>\n\n<h2>Entire Agreement</h2>\n\n<p>The Terms of Use and our Privacy Policy constitute the sole and entire agreement between you and Point App, Inc. with respect to the Website and supersede all prior and contemporaneous understandings, agreements, representations and warranties, both written and oral, with respect to the Website.</p>\n\n<h2>Your Comments and Concerns</h2>\n\n<p>This website is operated by Point App, Inc.\nAll feedback, comments, requests for technical support and other communications relating to the Website should be directed to: <a href='mailto:support@getpoint.co' target='_blank'>support@getpoint.co</a>\nThank you for visiting the Website.</p>"
}),define("mdown!copy/eula.md",[],function(){return'<h1>Software End User License Agreement</h1>\n\n<p>This Software End User License Agreement ("Agreement") is a binding agreement between you ("End User" or "you") and Point App, Inc. (“<em>Point</em>” or "Company"). This Agreement governs your use of the app on your mobile device or computer, (including all related documentation, the "Application"). The Application is licensed, not sold, to you.</p>\n\n<p>BY DOWNLOADING AND USING THE APPLICATION, YOU (A) ACKNOWLEDGE THAT YOU HAVE READ AND UNDERSTAND THIS AGREEMENT; (B) REPRESENT THAT YOU ARE 18 YEARS OF AGE OR OLDER; AND (C) ACCEPT THIS AGREEMENT AND AGREE THAT YOU ARE LEGALLY BOUND BY ITS TERMS. IF YOU DO NOT AGREE TO THESE TERMS, DO NOT DOWNLOAD OR USE THE APPLICATION.</p>\n\n<ol>\n<li><p>License Grant. Subject to the terms of this Agreement, Company grants you a limited, nonexclusive and nontransferable license to download, install and use the Application for your personal, non-commercial use on a single mobile device or computer owned or otherwise controlled by you ("Computer") strictly in accordance with the Application\'s documentation.</p></li>\n<li><p>License Restrictions. Licensee shall not:\n(a)  copy the Application, except as expressly permitted by this license;\n(b) modify, translate, adapt or otherwise create derivative works or improvements, whether or not patentable, of the Application;\n(c) reverse engineer, disassemble, decompile, decode or otherwise attempt to derive or gain access to the source code of the Application or any part thereof;\n(d) remove, delete, alter or obscure any trademarks or any copyright, trademark, patent or other intellectual property or proprietary rights notices from the Application, including any copy thereof;\n(e) rent, lease, lend, sell, sublicense, assign, distribute, publish, transfer or otherwise make available the Application or any features or functionality of the Application, to any third party for any reason, including by making the Application available on a network where it is capable of being accessed by more than one device at any time; or\n(f) remove, disable, circumvent or otherwise create or implement any workaround to any copy protection, rights management or security features in or protecting the Application.</p></li>\n<li><p>Reservation of Rights. You acknowledge and agree that the Application is provided under license, and not sold, to you. You do not acquire any ownership interest in the Application under this Agreement, or any other rights thereto other than to use the Application in accordance with the license granted, and subject to all terms, conditions and restrictions, under this Agreement. Company reserve and shall retain its entire right, title and interest in and to the Application, including all copyrights, trademarks and other intellectual property rights therein or relating thereto, except as expressly granted to you in this Agreement.</p></li>\n<li><p>Collection and Use of Your Information. You acknowledge that when you download, install or use the Application, Company may use automatic means (including, for example, cookies and web beacons) to collect information about your Computer and about your use of the Application. You also may be required to provide certain information about yourself as a condition to downloading, installing or using the Application or certain of its features or functionality, and the Application may provide you with opportunities to share information about yourself with others. </p></li>\n</ol>\n\n<p>All information we collect through or in connection with this Application is subject to our Privacy Policy <a href=\'http://getpoint.co/legal/\' target=\'_blank\'>http://getpoint.co/legal/</a>. By downloading, installing, using and providing information to or through this Application, you consent to all actions taken by us with respect to your information in compliance with the Privacy Policy.</p>\n\n<ol>\n<li><p>Content Standards.  These content standards apply to any and all User Contributions and use of Interactive Services, as those terms are defined below. User Contributions must in their entirety comply with all applicable federal, state, local and international laws and regulations. Without limiting the foregoing, User Contributions must not:\n(a) Contain any material that is defamatory, obscene, indecent, abusive, offensive, harassing, violent, hateful, inflammatory or otherwise objectionable.\n(b) Promote sexually explicit or pornographic material, violence, or discrimination based on race, sex, religion, nationality, disability, sexual orientation or age.\n(c) Infringe any patent, trademark, trade secret, copyright or other intellectual property or other rights of any other person.\n(d) Violate the legal rights (including the rights of publicity and privacy) of others or contain any material that could give rise to any civil or criminal liability under applicable laws or regulations or that otherwise may be in conflict with these Terms of Use and our Privacy Policy <a href=\'http://getpoint.co/legal/\' target=\'_blank\'>http://getpoint.co/legal/</a>.\n(e) Be likely to deceive any person.\n(f) Promote any illegal activity, or advocate, promote or assist any unlawful act.\n(g) Cause annoyance, inconvenience or needless anxiety or be likely to upset, embarrass, alarm or annoy any other person.\n(h) Impersonate any person, or misrepresent your identity or affiliation with any person or organization.\n(i) Involve commercial activities or sales, such as contests, sweepstakes and other sales promotions, barter or advertising.\n(j) Give the impression that they emanate from or are endorsed by us or any other person or entity, if this is not the case.</p></li>\n<li><p>User Contributions.\n(a) The Application may contain message boards and other interactive features (collectively, "Interactive Services") that allow users to post, submit, publish, display or transmit to other users or other persons (hereinafter, "post") content or materials (collectively, "User Contributions") on or through the Application.\n(b) All User Contributions must comply with the Content Standards set out in these Terms of Use.\n(c) Any User Contribution you post to the site will be considered non-confidential and nonproprietary. By providing any User Contribution on the Application, you grant us and our licensees, successors and assigns the right to use, reproduce, modify, perform, display, distribute and otherwise disclose to third parties any such material.\n(d) You represent and warrant that:\n(i) You own or control all rights in and to the User Contributions and have the right to grant the license granted above to us and our licensees, successors and assigns.\n(ii) All of your User Contributions do and will comply with these Terms of Use.\n(iii) You understand and acknowledge that you are responsible for any User Contributions you submit or contribute, and you, not the Company, have fully responsibility for such content, including its legality, reliability, accuracy and appropriateness.\n(e) We are not responsible, or liable to any third party, for the content or accuracy of any User Contributions posted by you or any other user of the Website.</p></li>\n<li><p>Updates. Company may from time to time in its sole discretion develop and provide Application updates, which may include upgrades, bug fixes, patches and other error corrections and/or new features (collectively, including related documentation, "Updates"). Updates may also modify or delete in their entirety certain features and functionality. You agree that Company has no obligation to provide any Updates or to continue to provide or enable any particular features or functionality. Based on your Computer settings, when your Computer is connected to the internet either:\n(a) the Application will automatically download and install all available Updates; or\n(b) you may receive notice of or be prompted to download and install available Updates.\nYou shall promptly download and install all Updates and acknowledge and agree that the Application or portions thereof may not properly operate should you fail to do so. You further agree that all Updates will be deemed part of the Application and be subject to all terms and conditions of this Agreement.</p></li>\n<li><p>Third Party Materials. The Application may display, include or make available third-party content (including data, information, applications and other products services and/or materials) or provide links to third-party websites or services, including through third-party advertising ("Third Party Materials"). You acknowledge and agree that Company is not responsible for Third Party Materials, including their accuracy, completeness, timeliness, validity, copyright compliance, legality, decency, quality or any other aspect thereof. Company does not assume and will not have any liability or responsibility to you or any other person or entity for any Third Party Materials. Third Party Materials and links thereto are provided solely as a convenience to you and you access and use them at entirely at your own risk and subject to such third parties\' terms and conditions.</p></li>\n<li><p>Waiver. No failure to exercise, and no delay in exercising, on the part of either party, any right or any power hereunder shall operate as a waiver thereof, nor shall any single or partial exercise of any right or power hereunder preclude further exercise of that or any other right hereunder. In the event of a conflict between this Agreement and any applicable purchase or other terms, the terms of this Agreement shall govern.</p></li>\n<li><p>Consent to Electronic Communications.  By using the Service you agree that we may communicate with you electronically regarding administrative, security and other issues relating to your use of the Service. You agree that any notices, agreements, disclosures or other communications that we send to you electronically will satisfy any legal communication requirements, including that such communications be in writing. To withdraw your consent from receiving electronic notice, please notify us at support@getpoint.co</p></li>\n<li><p>DMCA Copyright Policy.\n(a) Notice.  If you are a copyright owner or an agent thereof and believe that any content available on our Service infringes your copyrights, you may, pursuant to the Digital Millennium Copyright Act ("DMCA"), notify our Copyright Agent by providing the following information in writing (see 17 U.S.C § 512(c)(3)):\n(i)  A physical or electronic signature of a person authorized to act on behalf of the owner of an exclusive right that is allegedly infringed;\n(ii) Identification of the copyrighted work claimed to have been infringed, or, if multiple copyrighted works at a single online site are covered by a single notification, a representative list of such works at that site;\n(iii)          Identification of the material that is claimed to be infringing or to be the subject of infringing activity and that is to be removed or access to which is to be disabled and information reasonably sufficient to permit the service provider to locate the material;\n(iv)          Information reasonably sufficient to permit the service provider to contact You, such as an address, telephone number and, if available, an electronic mail.\n(v) A statement that you have a good faith belief that use of the material in the manner complained of is not authorized by the copyright owner, its agent or the law; and\n(vi)          A statement that the information in the notification is accurate, and under penalty of perjury, that you are authorized to act on behalf of the owner of an exclusive right that is allegedly infringed.</p></li>\n</ol>\n\n<p>You acknowledge that a failure to comply with all of the above requirements will result in an invalid notification.</p>\n\n<p>Point App, Inc.’s designated Copyright Agent to receive notifications of claimed infringement is:</p>\n\n<p>Point App DMCA Agent</p>\n\n<p><a href=\'mailto:support@getpoint.co\' target=\'_blank\'>support@getpoint.co</a>\n(b) Counter-Notice.  If you believe that your content that was removed (or to which access was disabled) is not infringing, or that you have the authorization from the copyright owner, the copyright owner’s agent or pursuant to other law, to submit the content to Point, you may send a counter-notice containing the following information to the Copyright Agent:\n(i)  Your physical or electronic signature;\n(ii) Identification of the content that was removed or to which access has been disabled and the location at which the content appeared before it was removed or disabled;\n(iii) A statement that you have a good faith belief that the content was removed or disabled as a result of mistake or a misidentification of the content; and\n(iv) Your name, address, telephone number and e-mail address and a statement that you will accept service of process from the person who provided notification of the alleged infringement.\n(v) If a counter-notice is received by the Copyright Agent, Point may send a copy of the counter-notice to the original complaining party informing that person that it may replace the removed content or cease disabling it in 10 business days. Unless the copyright owner files an action seeking a court order against the content provider, member, or user, the removed content may be replaced, or access to it restored, in 10 to 14 business days or more after receipt of the counter-notice, at Point’s sole discretion.</p>\n\n<ol>\n<li><p>Third Party Software.  The software you download consists of a package of components, including certain third party software (“Third Party Software” and together with the Application, the “Package”) provided under separate license terms (the “Third Party Terms”). Your use of the Third Party Software in conjunction with the Application in a manner consistent with the terms of these Terms is permitted, however, you may have broader rights under the applicable Third Party Terms and nothing in these Terms is intended to impose further restrictions on your use of the Third Party Software.</p></li>\n<li><p>Term and Termination.\n(a) The term of Agreement commences when you download the Application and will continue in effect until terminated by you or Company as set forth in this Section 13.\n(b) You may terminate this Agreement by deleting the Application and all copies thereof from your Computer.\n(c) Company may terminate this Agreement at any time without notice.  In addition, this Agreement will terminate immediately and automatically without any notice if you violate any of the terms and conditions of this Agreement.\n(d) Upon termination:\n(i)  all rights granted to you under this Agreement will also terminate; and\n(ii) you must cease all use of the Application and delete all copies of the Application from your Computer and account.\n(e) Termination will not limit any of Company\'s rights or remedies at law or in equity.</p></li>\n<li><p>Disclaimer of Warranties. THE APPLICATION IS PROVIDED TO LICENSEE "AS IS" AND WITH ALL FAULTS AND DEFECTS WITHOUT WARRANTY OF ANY KIND. TO THE MAXIMUM EXTENT PERMITTED UNDER APPLICABLE LAW, COMPANY, ON ITS OWN BEHALF AND ON BEHALF OF ITS AFFILIATES AND ITS AND THEIR RESPECTIVE LICENSORS AND SERVICE PROVIDERS, EXPRESSLY DISCLAIMS ALL WARRANTIES, WHETHER EXPRESS, IMPLIED, STATUTORY OR OTHERWISE, WITH RESPECT TO THE APPLICATION, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT, AND WARRANTIES THAT MAY ARISE OUT OF COURSE OF DEALING, COURSE OF PERFORMANCE, USAGE OR TRADE PRACTICE. WITHOUT LIMITATION TO THE FOREGOING, COMPANY PROVIDES NO WARRANTY OR UNDERTAKING, AND MAKES NO REPRESENTATION OF ANY KIND THAT THE APPLICATION WILL MEET YOUR REQUIREMENTS, ACHIEVE ANY INTENDED RESULTS, BE COMPATIBLE OR WORK WITH ANY OTHER SOFTWARE, APPLICATIONS, SYSTEMS OR SERVICES, OPERATE WITHOUT INTERRUPTION, MEET ANY PERFORMANCE OR RELIABILITY STANDARDS OR BE ERROR FREE OR THAT ANY ERRORS OR DEFECTS CAN OR WILL BE CORRECTED.\nSOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF OR LIMITATIONS ON IMPLIED WARRANTIES OR THE LIMITATIONS ON THE APPLICABLE STATUTORY RIGHTS OF A CONSUMER, SO SOME OR ALL OF THE ABOVE EXCLUSIONS AND LIMITATIONS MAY NOT APPLY TO YOU.</p></li>\n<li><p>Limitation of Liability. TO THE FULLEST EXTENT PERMITTED BY APPLICABLE LAW, IN NO EVENT WILL COMPANY OR ITS AFFILIATES, OR ANY OF ITS OR THEIR RESPECTIVE LICENSORS OR SERVICE PROVIDERS, HAVE ANY LIABILITY ARISING FROM OR RELATED TO YOUR USE OF OR INABILITY TO USE THE APPLICATION OR THE CONTENT AND SERVICES FOR:\n(a) PERSONAL INJURY, PROPERTY DAMAGE, LOST PROFITS, COST OF SUBSTITUTE GOODS OR SERVICES, LOSS OF DATA, LOSS OF GOODWILL, BUSINESS INTERRUPTION, COMPUTER FAILURE OR MALFUNCTION OR ANY OTHER CONSEQUENTIAL, INCIDENTAL, INDIRECT, EXEMPLARY, SPECIAL OR PUNITIVE DAMAGES\n(b) DIRECT DAMAGES IN AMOUNTS THAT IN THE AGGREGATE EXCEED THE AMOUNT ACTUALLY PAID BY YOU FOR THE APPLICATION.\nTHE FOREGOING LIMITATIONS WILL APPLY WHETHER SUCH DAMAGES ARISE OUT OF BREACH OF CONTRACT, TORT (INCLUDING NEGLIGENCE) OR OTHERWISE AND REGARDLESS OF WHETHER SUCH DAMAGES WERE FORESEEABLE OR COMPANY WAS ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. SOME JURISDICTIONS DO NOT ALLOW CERTAIN LIMITATIONS OF LIABILITY SO SOME OR ALL OF THE ABOVE LIMITATIONS OF LIABILITY MAY NOT APPLY TO YOU.</p></li>\n<li><p>Indemnification. You agree to indemnify, defend and hold harmless Company and its officers, directors, employees, agents, affiliates, successors and assigns from and against any and all losses, damages, liabilities, deficiencies, claims, actions, judgments, settlements, interest, awards, penalties, fines, costs, or expenses of whatever kind, including reasonable attorneys\' fees, arising from or relating to your use or misuse of the Application or your breach of this Agreement. Furthermore, you agree that Point App, Inc. assumes no responsibility for the content you submit or make available through this Application.</p></li>\n<li><p>Severability. If any provision of this Agreement is illegal or unenforceable under applicable law, the remainder of the provision will be amended to achieve as closely as possible the effect of the original term and all other provisions of this Agreement will continue in full force and effect.</p></li>\n<li><p>Governing Law. This Agreement is governed by and construed in accordance with the internal laws of the State of New York without giving effect to any choice or conflict of law provision or rule. Any legal suit, action or proceeding arising out of or related to this Agreement or the Application shall be instituted exclusively in the federal courts of the United States or the courts of the State of New York in each case located in New York City. You waive any and all objections to the exercise of jurisdiction over you by such courts and to venue in such courts.</p></li>\n<li><p>Entire Agreement. This Agreement and our Privacy Policy constitute the entire agreement between you and Company with respect to the Application and supersede all prior or contemporaneous understandings and agreements, whether written or oral, with respect to the Application. </p></li>\n</ol>'}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/helpView",["common.config","backbone","cs!views/pageView","jade!templates/helpTemplate","mdown!copy/termsOfService.md","mdown!copy/eula.md"],function(a,c,d,e,f,g){var h;return h=function(a){function c(){var a=this;return this.linkItemClicked=function(){return c.prototype.linkItemClicked.apply(a,arguments)},this.closeClicked=function(){return c.prototype.closeClicked.apply(a,arguments)},this.locals=function(){return c.prototype.locals.apply(a,arguments)},c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.className="modal modal-dark",c.prototype.template=e,c.prototype.locals=function(){return{tosCopy:f,eulaCopy:g}},c.prototype.id="help",c.prototype.render=function(){return c.__super__.render.call(this)},c.prototype.events={"click .modal-close":"closeClicked","click .pnt-menu-list-item a":"linkItemClicked"},c.prototype.closeClicked=function(){return this.hide()},c.prototype.linkItemClicked=function(a){var b,c;b=$(a.target),c=b.attr("data-to-show"),$(".text-pane").addClass("pnt-is-hidden"),$(c).removeClass("pnt-is-hidden"),$(".pnt-menu-list-item").removeClass("is-pnt-menu-list-item-active"),b.closest(".pnt-menu-list-item").addClass("is-pnt-menu-list-item-active")},c.prototype.show=function(a){return c.__super__.show.call(this),$(".pnt-menu-list-item a[data-to-show='#"+a+"']").click()},c}(d)})}.call(this),define("jade!templates/loginTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<i class="pnticn-logo"></i>'),organization?buf.push('<h1 class="pnt-h1">Login with your '+jade.escape(null==(jade.interp=orgName)?"":jade.interp)+' email.</h1><div data-js-login-google="data-js-login-google" class="pnt-branded-login-button"><img src="../assets/signin_google.png"/></div><p class="pnt-smalltext"><a data-js-show-normal-login="data-js-show-normal-login" href="#">I\'m not a part of this organization!</a></p>'):prioritizeGmail?buf.push('<div class="pnt-m-top-3"><div data-js-login-google="data-js-login-google" class="pnt-branded-login-button"><img src="../assets/signin_google.png"/></div></div><p class="pnt-smalltext pnt-m-top-3"><a data-js-show-normal-login="data-js-show-normal-login" href="#">I don\'t have Gmail.</a></p>'):buf.push('<div class="pnt-m-top-3"><div data-js-login-google="data-js-login-google" class="pnt-branded-login-button"><img src="../assets/signin_google.png"/></div></div><div class="pnt-m-top-1"><div data-js-login-facebook="data-js-login-facebook" class="pnt-branded-login-button"><img src="../assets/signin_fb.png"/></div></div>'),buf.push('<div class="pt-txt-align-c tos-link pnt-smalltext"><a data-js-terms-of-service="data-js-terms-of-service" href="#">Terms of Service</a></div>');return buf.join("")}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/loginView",["common.config","backbone","cs!common/browser/browser","cs!views/helpView","jade!templates/loginTemplate"],function(a,c,d,e,f){var g;return g=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.initialize=function(){var a,b,c;return a={orgName:localStorage.googleAppsTeam},a.organization=null!=(b=a.orgName)?b.length:void 0,a.prioritizeGmail=(null!=(c=localStorage.loggedInWith)?c.indexOf("facebook"):void 0)>-1?!1:function(){switch(localStorage.installCampaign){case"Invite Via Page":return!0;case"Email Blast Invite":return!0;case"Invite Footer Link":return!0}}(),this.render(a)},c.prototype.render=function(a){return this.$el.html(f(a))},c.prototype.events={"click [data-js-login-facebook]":"onFacebookLoginClick","click [data-js-login-google]":"onGoogleLoginClick","click [data-js-terms-of-service]":"onTOSClick","click [data-js-show-normal-login]":"onShowNormalLoginClick"},c.prototype.track={"click #login-facebook":{name:"Login",data:{service:"Facebook"}},"click #login-google":{name:"Login",data:{service:"Google"}},"click #terms-of-service":"View TOS"},c.prototype.show=function(){return this.$el.removeClass("pnt-is-invisible"),this.helpView=new e({appendTo:this.$el})},c.prototype.onFacebookLoginClick=function(){var a;return null!=(a=d.extension)?a.sendMessage({request:"open:login",details:{provider:"facebook"}}):void 0},c.prototype.onGoogleLoginClick=function(){var a;return null!=(a=d.extension)?a.sendMessage({request:"open:login",details:{provider:"google"}}):void 0},c.prototype.onTOSClick=function(){return this.helpView.show("tos-text"),!1},c.prototype.onShowNormalLoginClick=function(){return localStorage.googleAppsTeam="",this.render({organization:!1,prioritizeGmail:!1})},c}(c.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].slice;define("cs!views/tabBarView",["jquery","backbone","common.config","cs!common/modules/english"],function(a,d,e,f){var g;return g=function(d){function g(){var a=this;return this.select=function(){return g.prototype.select.apply(a,arguments)},this.openPageOnTabClick=function(){return g.prototype.openPageOnTabClick.apply(a,arguments)},this.onNotifsChange=function(){return g.prototype.onNotifsChange.apply(a,arguments)},this.onRoute=function(){var b,d;return d=arguments[0],b=2<=arguments.length?c.call(arguments,1):[],g.prototype.onRoute.apply(a,arguments)},g.__super__.constructor.apply(this,arguments)}return b(g,d),g.prototype.initialize=function(a){var b;return this.mainView=a.mainView,this.notifs=e.notifications,this.$active=this.$(".pnt-is-active"),this.$quicktags=this.$("#quicktags-menu"),this.listenTo(e.router,"route",this.onRoute),this.listenTo(this.notifs,"all",this.onNotifsChange),this.listenTo(e.badges,"change",this.updateBadges),this.notifs.load(),null!=(null!=(b=e.DEV)?b.badges:void 0)?this.updateBadges(e.DEV.badges):void 0},g.prototype.onRoute=function(){var a,b;return b=arguments[0],a=2<=arguments.length?c.call(arguments,1):[],"inbox"===b||"friends"===b||"settings"===b?this.select(this.$("#open-"+b),b):void 0},g.prototype.onNotifsChange=function(){var a,b,c;return a=0,b=0,c=0,this.notifs.each(function(d){return"friends:request"===d.get("type")?a++:("point"===d.get("type")&&c++,d.get("silent")?void 0:b++)}),e.badges.set({inbox:b,friends:a,points:c})},g.prototype.updateBadges=function(){var a,b,c,d,f,g,h;for(g=["inbox","friends"],h=[],d=0,f=g.length;f>d;d++)c=g[d],b=e.badges.get(c),a=this.$("#open-"+c).find(".pnt-menu-list-item-badge"),b?h.push(a.removeClass("pnt-is-hidden").text(Math.min(b,99))):h.push(a.addClass("pnt-is-hidden"));return h},g.prototype.events={"click .pnt-menu-list-item:not(.pntmenu-tab-item-more)":"openPageOnTabClick","mouseenter .pnt-menu-list-item":"onMouseEnterMenuItem","mouseleave .pnt-menu-list-item":"onMouseLeaveMenuItem"},g.prototype.openPageOnTabClick=function(b){var c,d;return c=a(b.target).closest(".pnt-menu-list-item"),d=c.attr("data-id"),e.router.navigate(d,{trigger:!0}),c.hasClass("pntmenu-tab-item")?this.select(c,d):this.select(c),d=f.capitalizeFirstLetter(d),this.trackEvent("Show "+d,{via:"Tabs"})},g.prototype.select=function(a){return null!=this.$active&&this.$active.removeClass("pnt-is-active"),this.$active=a.addClass("pnt-is-active")},g}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/views/autocompleteView",["jquery","backbone"],function(a,c){var d;return d=function(d){function e(){var a=this;return this.getMatchesForTerm=function(){return e.prototype.getMatchesForTerm.apply(a,arguments)},this.onMouseLeave=function(){return e.prototype.onMouseLeave.apply(a,arguments)},this.onKeydownBody=function(){return e.prototype.onKeydownBody.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,d),e.prototype.term="",e.prototype.isContinuation=!1,e.prototype.maxListLength=4,e.prototype.minCharactersToShowList=0,e.prototype.removeAfterChosen=!0,e.prototype._listVisible=!1,e.prototype.initialize=function(b){return _.each(b,function(a,b){return this[b]=a},this),this.removeAfterChosen&&(this.chosenCollection=new c.Collection),this._filteredCollection=this.collection?new this.collection.constructor:new c.Collection,this.$list=a("<div></div>").appendTo(this.$el)},e.prototype.updateTerm=function(a){var b,c,d;if(this._listVisible){if(a===this.term)return;b=this._filteredCollection.length&&this.term.length,d=b&&0===a.indexOf(this.term)}else d=!1;return this.isContinuation&&!d&&this._filteredCollection.reset(),this.isContinuation=d,this.term=a,a.length>=this.minCharactersToShowList?(c=this.getMatchesForTerm(a),this.updateList(c)):this.emptyListEl()},e.prototype.unChooseItem=function(a,b){var c;if(null==this.chosenCollection)throw"Cant unchoose unless removeAfterChosen is true";return(c=this.chosenCollection.get(a))?(this.chosenCollection.remove(c),this.collection.add(c,b)):void 0},e.prototype.resetCollection=function(){if(null==this.chosenCollection)throw"Cant reset unless removeAfterChosen is true";return this.collection.add(this.chosenCollection.models),this.chosenCollection.reset()},e.prototype.chooseItem=function(a){return this.emptyListEl(),this.handleChosenItem(a)},e.prototype.handleChosenItem=function(a){var b,c;return b=a.attr("data-id"),c=this.collection.get(b),this.handlers.itemChosenHandler(c,this),this.chosenTags.add(c),this.removeAfterChosen?this.removeChosen(c):void 0},e.prototype.removeChosen=function(a){return this.collection.remove(a),this.chosenCollection.add(a)},e.prototype.selectItem=function(a){var b;return this.handleSelectedItem(a),null!=this.$selection&&(b=this.$selection.removeClass("is-list-item-selected")),this.$selection=a.addClass("is-list-item-selected"),b},e.prototype.handleSelectedItem=function(a){var b;return b=this.collection.get(a.attr("data-id")),this.handlers.itemSelectedHandler(b,this)},e.prototype.events={"click .pnt-autocomplete-list-item":"chooseItemOnClick","mouseenter .pnt-autocomplete-list-item":"selectItemOnMouseEnter",mouseleave:"onMouseLeave"},e.prototype.bindExternalEvents=function(){return a(window).bind("keydown",this.onKeydownBody)},e.prototype.onKeydownBody=function(a){switch(a.keyCode){case 13:case 9:case 32:return a.preventDefault(),this.chooseSelectedItemOnEnter();case 38:return a.preventDefault(),this.selectChangeOn("up");case 40:return a.preventDefault(),this.selectChangeOn("down")}},e.prototype.remove=function(){return a(window).unbind("keydown",this.onKeydownBody),e.__super__.remove.call(this)},e.prototype.updateList=function(b){var c,d,e,f,g;if(this.emptyListEl(),!(b.length<1)){for(this._listVisible=!0,f=Math.min(this.maxListLength,b.length),d=g=0;f>=0?f>g:g>f;d=f>=0?++g:--g)e=b[d],c=a(this.template.listItemTemplate(this.template.locals(e))),this.$list.append(c),e.id?c.attr("data-id",e.id):c.addClass("new-hashtag-item");return this.selectFirstItem(),this._postRender()}},e.prototype._postRender=function(){return null!=this.postRender?this.postRender(this.$list):void 0},e.prototype._same=function(a,b){var c,d,e;if(!_.isArray(a))throw"list1 is not an array";if(!_.isArray(b))throw"list2 is not an array";return a.length===!b.length?(console.log("uneven"),!1):(c=function(a){return a.id},d=_.map(a,c),e=_.map(b,c),_.isEqual(d,e)?!0:!1)},e.prototype.selectFirstItem=function(){return this.$selection=this.$(".pnt-autocomplete-list-item").first().addClass("is-list-item-selected")},e.prototype.emptyListEl=function(){return this._listVisible=!1,this.$list.html(""),this.$selection=null},e.prototype.chooseSelectedItemOnEnter=function(){return null!=this.$selection?this.chooseItem(this.$selection):null!=this.handlers.enterHandler?this.handlers.enterHandler():void 0},e.prototype.chooseItemOnClick=function(b){return this.chooseItem(a(b.target).closest(".pnt-autocomplete-list-item"))},e.prototype.selectItemOnMouseEnter=function(b){return this.selectItem(a(b.target).closest(".pnt-autocomplete-list-item"))},e.prototype.onMouseLeave=function(){var a;return null!=(null!=(a=this.handlers)?a.mouseLeaveHandler:void 0)?this.handlers.mouseLeaveHandler.call(null,this.term):void 0},e.prototype.selectChangeOn=function(a){var b,c;if("up"===a||"down"===a)return null==this.$selection?"up"===a?this.selectItem(this.$list.find(".pnt-autocomplete-list-item").last()):this.selectItem(this.$list.find(".pnt-autocomplete-list-item").first()):(b="up"===a?this.$selection.prev(".pnt-autocomplete-list-item"):this.$selection.next(".pnt-autocomplete-list-item"),b.length>0?c=this.selectItem(b):void 0)
},e.prototype.getMatchesForTerm=function(a){var b,c,d,e,f,g;return a?(a=this.escapeRegex(a),f=new RegExp("\\b"+a,"i"),g=new RegExp(a,"i"),e=[],d=[],b=this.isContinuation?this._filteredCollection:this.collection,c=this.matchOn,b.each(function(a){var b;return b=c(a),b.match(f)?e.push(a):b.match(g)?d.push(a):void 0}),d.forEach(function(a){return e.push(a)}),this._filteredCollection.reset(e),e):this.collection.models},e.prototype.escapeRegex=function(a){return a.replace("#","").replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},e}(c.View)})}.call(this),function(a,b,c){function d(a,c){this.wrapper="string"==typeof a?b.querySelector(a):a,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var d in c)this.options[d]=c[d];this.translateZ=this.options.HWCompositing&&h.hasPerspective?" translateZ(0)":"",this.options.useTransition=h.hasTransition&&this.options.useTransition,this.options.useTransform=h.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?h.ease[this.options.bounceEasing]||h.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function e(a,c,d){var e=b.createElement("div"),f=b.createElement("div");return d===!0&&(e.style.cssText="position:absolute;z-index:9999",f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),f.className="iScrollIndicator","h"==a?(d===!0&&(e.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",f.style.height="100%"),e.className="iScrollHorizontalScrollbar"):(d===!0&&(e.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",f.style.width="100%"),e.className="iScrollVerticalScrollbar"),e.style.cssText+=";overflow:hidden",c||(e.style.pointerEvents="none"),e.appendChild(f),e}function f(c,d){this.wrapper="string"==typeof d.el?b.querySelector(d.el):d.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=c,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var e in d)this.options[e]=d[e];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(h.addEvent(this.indicator,"touchstart",this),h.addEvent(a,"touchend",this)),this.options.disablePointer||(h.addEvent(this.indicator,"MSPointerDown",this),h.addEvent(a,"MSPointerUp",this)),this.options.disableMouse||(h.addEvent(this.indicator,"mousedown",this),h.addEvent(a,"mouseup",this))),this.options.fade&&(this.wrapperStyle[h.style.transform]=this.scroller.translateZ,this.wrapperStyle[h.style.transitionDuration]=h.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var g=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)},h=function(){function d(a){return g===!1?!1:""===g?a:g+a.charAt(0).toUpperCase()+a.substr(1)}var e={},f=b.createElement("div").style,g=function(){for(var a,b=["t","webkitT","MozT","msT","OT"],c=0,d=b.length;d>c;c++)if(a=b[c]+"ransform",a in f)return b[c].substr(0,b[c].length-1);return!1}();e.getTime=Date.now||function(){return(new Date).getTime()},e.extend=function(a,b){for(var c in b)a[c]=b[c]},e.addEvent=function(a,b,c,d){a.addEventListener(b,c,!!d)},e.removeEvent=function(a,b,c,d){a.removeEventListener(b,c,!!d)},e.momentum=function(a,b,d,e,f,g){var h,i,j=a-b,k=c.abs(j)/d;return g=void 0===g?6e-4:g,h=a+k*k/(2*g)*(0>j?-1:1),i=k/g,e>h?(h=f?e-f/2.5*(k/8):e,j=c.abs(h-a),i=j/k):h>0&&(h=f?f/2.5*(k/8):0,j=c.abs(a)+h,i=j/k),{destination:c.round(h),duration:i}};var h=d("transform");return e.extend(e,{hasTransform:h!==!1,hasPerspective:d("perspective")in f,hasTouch:"ontouchstart"in a,hasPointer:navigator.msPointerEnabled,hasTransition:d("transition")in f}),e.isBadAndroid=/Android /.test(a.navigator.appVersion)&&!/Chrome\/\d/.test(a.navigator.appVersion),e.extend(e.style={},{transform:h,transitionTimingFunction:d("transitionTimingFunction"),transitionDuration:d("transitionDuration"),transitionDelay:d("transitionDelay"),transformOrigin:d("transformOrigin")}),e.hasClass=function(a,b){var c=new RegExp("(^|\\s)"+b+"(\\s|$)");return c.test(a.className)},e.addClass=function(a,b){if(!e.hasClass(a,b)){var c=a.className.split(" ");c.push(b),a.className=c.join(" ")}},e.removeClass=function(a,b){if(e.hasClass(a,b)){var c=new RegExp("(^|\\s)"+b+"(\\s|$)","g");a.className=a.className.replace(c," ")}},e.offset=function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return{left:b,top:c}},e.preventDefaultException=function(a,b){for(var c in b)if(b[c].test(a[c]))return!0;return!1},e.extend(e.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),e.extend(e.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(a){return a*(2-a)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(a){return c.sqrt(1- --a*a)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(a){var b=4;return(a-=1)*a*((b+1)*a+b)+1}},bounce:{style:"",fn:function(a){return(a/=1)<1/2.75?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}},elastic:{style:"",fn:function(a){var b=.22,d=.4;return 0===a?0:1==a?1:d*c.pow(2,-10*a)*c.sin((a-b/4)*2*c.PI/b)+1}}}),e.tap=function(a,c){var d=b.createEvent("Event");d.initEvent(c,!0,!0),d.pageX=a.pageX,d.pageY=a.pageY,a.target.dispatchEvent(d)},e.click=function(a){var c,d=a.target;/(SELECT|INPUT|TEXTAREA)/i.test(d.tagName)||(c=b.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!0,a.view,1,d.screenX,d.screenY,d.clientX,d.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),c._constructed=!0,d.dispatchEvent(c))},e}();d.prototype={version:"5.1.1",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(a){a.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(a){if(!(1!=h.eventType[a.type]&&0!==a.button||!this.enabled||this.initiated&&h.eventType[a.type]!==this.initiated)){!this.options.preventDefault||h.isBadAndroid||h.preventDefaultException(a.target,this.options.preventDefaultException)||a.preventDefault();var b,d=a.touches?a.touches[0]:a;this.initiated=h.eventType[a.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=h.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,b=this.getComputedPosition(),this._translate(c.round(b.x),c.round(b.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=d.pageX,this.pointY=d.pageY,this._execEvent("beforeScrollStart")}},_move:function(a){if(this.enabled&&h.eventType[a.type]===this.initiated){this.options.preventDefault&&a.preventDefault();var b,d,e,f,g=a.touches?a.touches[0]:a,i=g.pageX-this.pointX,j=g.pageY-this.pointY,k=h.getTime();if(this.pointX=g.pageX,this.pointY=g.pageY,this.distX+=i,this.distY+=j,e=c.abs(this.distX),f=c.abs(this.distY),!(k-this.endTime>300&&10>e&&10>f)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=e>f+this.options.directionLockThreshold?"h":f>=e+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)a.preventDefault();else if("horizontal"==this.options.eventPassthrough)return this.initiated=!1,void 0;j=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)a.preventDefault();else if("vertical"==this.options.eventPassthrough)return this.initiated=!1,void 0;i=0}i=this.hasHorizontalScroll?i:0,j=this.hasVerticalScroll?j:0,b=this.x+i,d=this.y+j,(b>0||b<this.maxScrollX)&&(b=this.options.bounce?this.x+i/3:b>0?0:this.maxScrollX),(d>0||d<this.maxScrollY)&&(d=this.options.bounce?this.y+j/3:d>0?0:this.maxScrollY),this.directionX=i>0?-1:0>i?1:0,this.directionY=j>0?-1:0>j?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(b,d),k-this.startTime>300&&(this.startTime=k,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(a){if(this.enabled&&h.eventType[a.type]===this.initiated){this.options.preventDefault&&!h.preventDefaultException(a.target,this.options.preventDefaultException)&&a.preventDefault();var b,d,e=(a.changedTouches?a.changedTouches[0]:a,h.getTime()-this.startTime),f=c.round(this.x),g=c.round(this.y),i=c.abs(f-this.startX),j=c.abs(g-this.startY),k=0,l="";if(this.isInTransition=0,this.initiated=0,this.endTime=h.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(f,g),!this.moved)return this.options.tap&&h.tap(a,this.options.tap),this.options.click&&h.click(a),this._execEvent("scrollCancel"),void 0;if(this._events.flick&&200>e&&100>i&&100>j)return this._execEvent("flick"),void 0;if(this.options.momentum&&300>e&&(b=this.hasHorizontalScroll?h.momentum(this.x,this.startX,e,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:f,duration:0},d=this.hasVerticalScroll?h.momentum(this.y,this.startY,e,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:g,duration:0},f=b.destination,g=d.destination,k=c.max(b.duration,d.duration),this.isInTransition=1),this.options.snap){var m=this._nearestSnap(f,g);this.currentPage=m,k=this.options.snapSpeed||c.max(c.max(c.min(c.abs(f-m.x),1e3),c.min(c.abs(g-m.y),1e3)),300),f=m.x,g=m.y,this.directionX=0,this.directionY=0,l=this.options.bounceEasing}return f!=this.x||g!=this.y?((f>0||f<this.maxScrollX||g>0||g<this.maxScrollY)&&(l=h.ease.quadratic),this.scrollTo(f,g,k,l),void 0):(this._execEvent("scrollEnd"),void 0)}}},_resize:function(){var a=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){a.refresh()},this.options.resizePolling)},resetPosition:function(a){var b=this.x,c=this.y;return a=a||0,!this.hasHorizontalScroll||this.x>0?b=0:this.x<this.maxScrollX&&(b=this.maxScrollX),!this.hasVerticalScroll||this.y>0?c=0:this.y<this.maxScrollY&&(c=this.maxScrollY),b==this.x&&c==this.y?!1:(this.scrollTo(b,c,a,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight,this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=h.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(a,b){this._events[a]||(this._events[a]=[]),this._events[a].push(b)},off:function(a,b){if(this._events[a]){var c=this._events[a].indexOf(b);c>-1&&this._events[a].splice(c,1)}},_execEvent:function(a){if(this._events[a]){var b=0,c=this._events[a].length;if(c)for(;c>b;b++)this._events[a][b].apply(this,[].slice.call(arguments,1))}},scrollBy:function(a,b,c,d){a=this.x+a,b=this.y+b,c=c||0,this.scrollTo(a,b,c,d)},scrollTo:function(a,b,c,d){d=d||h.ease.circular,this.isInTransition=this.options.useTransition&&c>0,!c||this.options.useTransition&&d.style?(this._transitionTimingFunction(d.style),this._transitionTime(c),this._translate(a,b)):this._animate(a,b,c,d.fn)},scrollToElement:function(a,b,d,e,f){if(a=a.nodeType?a:this.scroller.querySelector(a)){var g=h.offset(a);g.left-=this.wrapperOffset.left,g.top-=this.wrapperOffset.top,d===!0&&(d=c.round(a.offsetWidth/2-this.wrapper.offsetWidth/2)),e===!0&&(e=c.round(a.offsetHeight/2-this.wrapper.offsetHeight/2)),g.left-=d||0,g.top-=e||0,g.left=g.left>0?0:g.left<this.maxScrollX?this.maxScrollX:g.left,g.top=g.top>0?0:g.top<this.maxScrollY?this.maxScrollY:g.top,b=void 0===b||null===b||"auto"===b?c.max(c.abs(this.x-g.left),c.abs(this.y-g.top)):b,this.scrollTo(g.left,g.top,b,f)}},_transitionTime:function(a){if(a=a||0,this.scrollerStyle[h.style.transitionDuration]=a+"ms",!a&&h.isBadAndroid&&(this.scrollerStyle[h.style.transitionDuration]="0.001s"),this.indicators)for(var b=this.indicators.length;b--;)this.indicators[b].transitionTime(a)},_transitionTimingFunction:function(a){if(this.scrollerStyle[h.style.transitionTimingFunction]=a,this.indicators)for(var b=this.indicators.length;b--;)this.indicators[b].transitionTimingFunction(a)},_translate:function(a,b){if(this.options.useTransform?this.scrollerStyle[h.style.transform]="translate("+a+"px,"+b+"px)"+this.translateZ:(a=c.round(a),b=c.round(b),this.scrollerStyle.left=a+"px",this.scrollerStyle.top=b+"px"),this.x=a,this.y=b,this.indicators)for(var d=this.indicators.length;d--;)this.indicators[d].updatePosition()},_initEvents:function(b){var c=b?h.removeEvent:h.addEvent,d=this.options.bindToWrapper?this.wrapper:a;c(a,"orientationchange",this),c(a,"resize",this),this.options.click&&c(this.wrapper,"click",this,!0),this.options.disableMouse||(c(this.wrapper,"mousedown",this),c(d,"mousemove",this),c(d,"mousecancel",this),c(d,"mouseup",this)),h.hasPointer&&!this.options.disablePointer&&(c(this.wrapper,"MSPointerDown",this),c(d,"MSPointerMove",this),c(d,"MSPointerCancel",this),c(d,"MSPointerUp",this)),h.hasTouch&&!this.options.disableTouch&&(c(this.wrapper,"touchstart",this),c(d,"touchmove",this),c(d,"touchcancel",this),c(d,"touchend",this)),c(this.scroller,"transitionend",this),c(this.scroller,"webkitTransitionEnd",this),c(this.scroller,"oTransitionEnd",this),c(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var b,c,d=a.getComputedStyle(this.scroller,null);return this.options.useTransform?(d=d[h.style.transform].split(")")[0].split(", "),b=+(d[12]||d[4]),c=+(d[13]||d[5])):(b=+d.left.replace(/[^-\d.]/g,""),c=+d.top.replace(/[^-\d.]/g,"")),{x:b,y:c}},_initIndicators:function(){function a(a){for(var b=h.indicators.length;b--;)a.call(h.indicators[b])}var b,c=this.options.interactiveScrollbars,d="string"!=typeof this.options.scrollbars,g=[],h=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(b={el:e("v",c,this.options.scrollbars),interactive:c,defaultScrollbars:!0,customStyle:d,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(b.el),g.push(b)),this.options.scrollX&&(b={el:e("h",c,this.options.scrollbars),interactive:c,defaultScrollbars:!0,customStyle:d,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(b.el),g.push(b))),this.options.indicators&&(g=g.concat(this.options.indicators));for(var i=g.length;i--;)this.indicators.push(new f(this,g[i]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){a(function(){this.fade()})}),this.on("scrollCancel",function(){a(function(){this.fade()})}),this.on("scrollStart",function(){a(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){a(function(){this.fade(1,!0)})})),this.on("refresh",function(){a(function(){this.refresh()})}),this.on("destroy",function(){a(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){h.addEvent(this.wrapper,"wheel",this),h.addEvent(this.wrapper,"mousewheel",this),h.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){h.removeEvent(this.wrapper,"wheel",this),h.removeEvent(this.wrapper,"mousewheel",this),h.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(a){if(this.enabled){a.preventDefault(),a.stopPropagation();var b,d,e,f,g=this;if(void 0===this.wheelTimeout&&g._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){g._execEvent("scrollEnd"),g.wheelTimeout=void 0},400),"deltaX"in a)b=-a.deltaX,d=-a.deltaY;else if("wheelDeltaX"in a)b=a.wheelDeltaX/120*this.options.mouseWheelSpeed,d=a.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in a)b=d=a.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in a))return;b=d=-a.detail/3*this.options.mouseWheelSpeed}if(b*=this.options.invertWheelDirection,d*=this.options.invertWheelDirection,this.hasVerticalScroll||(b=d,d=0),this.options.snap)return e=this.currentPage.pageX,f=this.currentPage.pageY,b>0?e--:0>b&&e++,d>0?f--:0>d&&f++,this.goToPage(e,f),void 0;e=this.x+c.round(this.hasHorizontalScroll?b:0),f=this.y+c.round(this.hasVerticalScroll?d:0),e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),f>0?f=0:f<this.maxScrollY&&(f=this.maxScrollY),this.scrollTo(e,f,0),this.options.probeType>1&&this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var a,b,d,e,f,g,h=0,i=0,j=0,k=this.options.snapStepX||this.wrapperWidth,l=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(d=c.round(k/2),e=c.round(l/2);j>-this.scrollerWidth;){for(this.pages[h]=[],a=0,f=0;f>-this.scrollerHeight;)this.pages[h][a]={x:c.max(j,this.maxScrollX),y:c.max(f,this.maxScrollY),width:k,height:l,cx:j-d,cy:f-e},f-=l,a++;j-=k,h++}else for(g=this.options.snap,a=g.length,b=-1;a>h;h++)(0===h||g[h].offsetLeft<=g[h-1].offsetLeft)&&(i=0,b++),this.pages[i]||(this.pages[i]=[]),j=c.max(-g[h].offsetLeft,this.maxScrollX),f=c.max(-g[h].offsetTop,this.maxScrollY),d=j-c.round(g[h].offsetWidth/2),e=f-c.round(g[h].offsetHeight/2),this.pages[i][b]={x:j,y:f,width:g[h].offsetWidth,height:g[h].offsetHeight,cx:d,cy:e},j>this.maxScrollX&&i++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),0===this.options.snapThreshold%1?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=c.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=c.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var a=this.options.snapSpeed||c.max(c.max(c.min(c.abs(this.x-this.startX),1e3),c.min(c.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,a)})},_nearestSnap:function(a,b){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var d=0,e=this.pages.length,f=0;if(c.abs(a-this.absStartX)<this.snapThresholdX&&c.abs(b-this.absStartY)<this.snapThresholdY)return this.currentPage;for(a>0?a=0:a<this.maxScrollX&&(a=this.maxScrollX),b>0?b=0:b<this.maxScrollY&&(b=this.maxScrollY);e>d;d++)if(a>=this.pages[d][0].cx){a=this.pages[d][0].x;break}for(e=this.pages[d].length;e>f;f++)if(b>=this.pages[0][f].cy){b=this.pages[0][f].y;break}return d==this.currentPage.pageX&&(d+=this.directionX,0>d?d=0:d>=this.pages.length&&(d=this.pages.length-1),a=this.pages[d][0].x),f==this.currentPage.pageY&&(f+=this.directionY,0>f?f=0:f>=this.pages[0].length&&(f=this.pages[0].length-1),b=this.pages[0][f].y),{x:a,y:b,pageX:d,pageY:f}},goToPage:function(a,b,d,e){e=e||this.options.bounceEasing,a>=this.pages.length?a=this.pages.length-1:0>a&&(a=0),b>=this.pages[a].length?b=this.pages[a].length-1:0>b&&(b=0);var f=this.pages[a][b].x,g=this.pages[a][b].y;d=void 0===d?this.options.snapSpeed||c.max(c.max(c.min(c.abs(f-this.x),1e3),c.min(c.abs(g-this.y),1e3)),300):d,this.currentPage={x:f,y:g,pageX:a,pageY:b},this.scrollTo(f,g,d,e)},next:function(a,b){var c=this.currentPage.pageX,d=this.currentPage.pageY;c++,c>=this.pages.length&&this.hasVerticalScroll&&(c=0,d++),this.goToPage(c,d,a,b)},prev:function(a,b){var c=this.currentPage.pageX,d=this.currentPage.pageY;c--,0>c&&this.hasVerticalScroll&&(c=0,d--),this.goToPage(c,d,a,b)},_initKeys:function(){var b,c={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(b in this.options.keyBindings)"string"==typeof this.options.keyBindings[b]&&(this.options.keyBindings[b]=this.options.keyBindings[b].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(b in c)this.options.keyBindings[b]=this.options.keyBindings[b]||c[b];h.addEvent(a,"keydown",this),this.on("destroy",function(){h.removeEvent(a,"keydown",this)})},_key:function(a){if(this.enabled){var b,d=this.options.snap,e=d?this.currentPage.pageX:this.x,f=d?this.currentPage.pageY:this.y,g=h.getTime(),i=this.keyTime||0,j=.25;switch(this.options.useTransition&&this.isInTransition&&(b=this.getComputedPosition(),this._translate(c.round(b.x),c.round(b.y)),this.isInTransition=!1),this.keyAcceleration=200>g-i?c.min(this.keyAcceleration+j,50):0,a.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?e+=d?1:this.wrapperWidth:f+=d?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?e-=d?1:this.wrapperWidth:f-=d?1:this.wrapperHeight;break;case this.options.keyBindings.end:e=d?this.pages.length-1:this.maxScrollX,f=d?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:e=0,f=0;break;case this.options.keyBindings.left:e+=d?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:f+=d?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:e-=d?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:f-=d?1:5+this.keyAcceleration>>0;break;default:return}if(d)return this.goToPage(e,f),void 0;e>0?(e=0,this.keyAcceleration=0):e<this.maxScrollX&&(e=this.maxScrollX,this.keyAcceleration=0),f>0?(f=0,this.keyAcceleration=0):f<this.maxScrollY&&(f=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(e,f,0),this.keyTime=g}},_animate:function(a,b,c,d){function e(){var m,n,o,p=h.getTime();return p>=l?(f.isAnimating=!1,f._translate(a,b),f.resetPosition(f.options.bounceTime)||f._execEvent("scrollEnd"),void 0):(p=(p-k)/c,o=d(p),m=(a-i)*o+i,n=(b-j)*o+j,f._translate(m,n),f.isAnimating&&g(e),3==f.options.probeType&&f._execEvent("scroll"),void 0)}var f=this,i=this.x,j=this.y,k=h.getTime(),l=k+c;this.isAnimating=!0,e()},handleEvent:function(a){switch(a.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(a);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(a);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(a);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(a);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(a);break;case"keydown":this._key(a);break;case"click":a._constructed||(a.preventDefault(),a.stopPropagation())}}},f.prototype={handleEvent:function(a){switch(a.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(a);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(a);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(a)}},destroy:function(){this.options.interactive&&(h.removeEvent(this.indicator,"touchstart",this),h.removeEvent(this.indicator,"MSPointerDown",this),h.removeEvent(this.indicator,"mousedown",this),h.removeEvent(a,"touchmove",this),h.removeEvent(a,"MSPointerMove",this),h.removeEvent(a,"mousemove",this),h.removeEvent(a,"touchend",this),h.removeEvent(a,"MSPointerUp",this),h.removeEvent(a,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(b){var c=b.touches?b.touches[0]:b;b.preventDefault(),b.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=c.pageX,this.lastPointY=c.pageY,this.startTime=h.getTime(),this.options.disableTouch||h.addEvent(a,"touchmove",this),this.options.disablePointer||h.addEvent(a,"MSPointerMove",this),this.options.disableMouse||h.addEvent(a,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(a){var b,c,d,e,f=a.touches?a.touches[0]:a,g=h.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,b=f.pageX-this.lastPointX,this.lastPointX=f.pageX,c=f.pageY-this.lastPointY,this.lastPointY=f.pageY,d=this.x+b,e=this.y+c,this._pos(d,e),1==this.scroller.options.probeType&&g-this.startTime>300?(this.startTime=g,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),a.preventDefault(),a.stopPropagation()},_end:function(b){if(this.initiated){if(this.initiated=!1,b.preventDefault(),b.stopPropagation(),h.removeEvent(a,"touchmove",this),h.removeEvent(a,"MSPointerMove",this),h.removeEvent(a,"mousemove",this),this.scroller.options.snap){var d=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),e=this.options.snapSpeed||c.max(c.max(c.min(c.abs(this.scroller.x-d.x),1e3),c.min(c.abs(this.scroller.y-d.y),1e3)),300);(this.scroller.x!=d.x||this.scroller.y!=d.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=d,this.scroller.scrollTo(d.x,d.y,e,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(a){a=a||0,this.indicatorStyle[h.style.transitionDuration]=a+"ms",!a&&h.isBadAndroid&&(this.indicatorStyle[h.style.transitionDuration]="0.001s")},transitionTimingFunction:function(a){this.indicatorStyle[h.style.transitionTimingFunction]=a},refresh:function(){this.transitionTime(),this.indicatorStyle.display=this.options.listenX&&!this.options.listenY?this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.scroller.hasVerticalScroll?"block":"none":this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(h.addClass(this.wrapper,"iScrollBothScrollbars"),h.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(h.removeClass(this.wrapper,"iScrollBothScrollbars"),h.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px")),this.wrapper.offsetHeight,this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=c.max(c.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=c.max(c.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var a=this.options.listenX&&c.round(this.sizeRatioX*this.scroller.x)||0,b=this.options.listenY&&c.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(a<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=c.max(this.indicatorWidth+a,8),this.indicatorStyle.width=this.width+"px"),a=this.minBoundaryX):a>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=c.max(this.indicatorWidth-(a-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",a=this.maxPosX+this.indicatorWidth-this.width):a=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),b<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=c.max(this.indicatorHeight+3*b,8),this.indicatorStyle.height=this.height+"px"),b=this.minBoundaryY):b>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=c.max(this.indicatorHeight-3*(b-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",b=this.maxPosY+this.indicatorHeight-this.height):b=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=a,this.y=b,this.scroller.options.useTransform?this.indicatorStyle[h.style.transform]="translate("+a+"px,"+b+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=a+"px",this.indicatorStyle.top=b+"px")},_pos:function(a,b){0>a?a=0:a>this.maxPosX&&(a=this.maxPosX),0>b?b=0:b>this.maxPosY&&(b=this.maxPosY),a=this.options.listenX?c.round(a/this.sizeRatioX):this.scroller.x,b=this.options.listenY?c.round(b/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(a,b)},fade:function(a,b){if(!b||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var c=a?250:500,d=a?0:300;
a=a?"1":"0",this.wrapperStyle[h.style.transitionDuration]=c+"ms",this.fadeTimeout=setTimeout(function(a){this.wrapperStyle.opacity=a,this.visible=+a}.bind(this,a),d)}}},d.utils=h,"undefined"!=typeof module&&module.exports?module.exports=d:"function"==typeof define&&define.amd?define("iscroll",[],function(){return d}):a.IScroll=d}(window,document,Math),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].slice;define("cs!views/dropdownAutocompleteView",["common.config","jquery","cs!common/models/friendModel","cs!common/views/autocompleteView","iscroll"],function(a,d,e,f,g){var h;return h=function(d){function f(){var a=this;return this.setHeight=function(b){return null==b&&(b=!1),f.prototype.setHeight.apply(a,arguments)},f.__super__.constructor.apply(this,arguments)}return b(f,d),f.prototype.initialize=function(){var b,d,h,i;return b=1<=arguments.length?c.call(arguments,0):[],f.__super__.initialize.apply(this,b),this.scroll=new g(this.$el[0],{scrollbars:!0,mouseWheel:!0,disableMouse:!0,disablePointer:!0,disableTouch:!0,interactiveScrollbars:!0,fadeScrollbars:!0,probeType:2,momentum:!0}),h=a.user.get("name"),i=h.length>12?h.split(" ")[0]:h,this.me=d=new e({uid:a.user.id,pid:a.user.id,id:a.user.get("id"),gid:a.user.get("gid"),name:i,sublabel:"Points sent to myself",_term:"me "+h,pnt_user:!0,score:0}),this.collection.add(d,{at:0,sort:!1}),this.collection.each(function(a,b){return a._index=b})},f.prototype._postRender=function(){var a=this;return this.scroll.refresh(),_.defer(function(){return a.afterFirst?a.setHeight(!1):(a.setHeight(!0),a.afterFirst=!0)}),null!=this.postRender?this.postRender(this.$list):void 0},f.prototype.emptyListEl=function(a){var b=this;return null==a&&(a=!1),a?(this.$el.onCssAnimationEnd(function(){return f.__super__.emptyListEl.call(b)}),this.$el.addClass("pnt-is-hidden"),this.$el.addClass("pnt-is-animated")):f.__super__.emptyListEl.call(this)},f.prototype.removeChosen=function(a){return this.collection.remove(a),this.chosenCollection.add(a),a!==this.me?this.collection.remove(this.me):void 0},f.prototype.unChooseItem=function(a){var b,c,d;if(null==this.chosenCollection)throw"Cant unchoose unless removeAfterChosen is true";return(c=this.chosenCollection.get(a))&&(null!=c._index&&(b=Math.max(0,c._index-1),d={at:b}),this.chosenCollection.remove(c),c!==this.me&&this.collection.add(c,d)),0!==this.chosenCollection.length||this.collection.get(this.me.id)?void 0:this.collection.add(this.me,{at:0,sort:!1})},f.prototype.updateList=function(a){var b;return f.__super__.updateList.call(this,a),this._listVisible?null!=(b=this.scroll)?b.scrollTo(0,0):void 0:void 0},f.prototype.setHeight=function(a){null==a&&(a=!1)},f.prototype.selectChangeOn=function(a){return f.__super__.selectChangeOn.call(this,a),this.scroll.scrollToElement(this.$selection[0],250,!0,!0)},f}(f)})}.call(this),define("jade!templates/searchOmniboxTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<div style="z-index:90; max-height: 200px; box-sizing: border-box;" class="it-me"><div style="position: relative;" class="pnt-omnibox pj-toolbar"><span class="pnt-omnibox-chosen-list"></span><div class="pnt-omnibox-input-placeholder">Search by keywords and @friends.</div><span contenteditable="true" style="min-height: inherit; line-height: 1.2em; height: 1.2em; margin: 0px; padding: 8px; display: inline; white-space: nowrap; overflow: hidden; width: 254px; box-sizing: border-box; margin-top: 3px" class="pnt-omnibox-input-box pnt-form"></span><span contenteditable="true" tabindex="0" class="pnt-omnibox-paste-input"></span></div><div id="pnt-friend-autocomplete" style="max-height: 157px;" class="pnt-autocomplete-list pnt-autocomplete-list-dd"></div></div>');return buf.join("")}}),define("jade!templates/autocompleteFriendItemTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<div class="pnt-autocomplete-list-item pnt-autocomplete-list-item-friend"><div class="pnt-avatar pnt-avatar-m"><div'+jade.attrs({"data-src":avatar,"class":"pnt-avatar-placeholder"},{"data-src":!0})+">"+jade.escape(null==(jade.interp=initials)?"":jade.interp)+'</div></div><div class="pnt-autocomplete-list-item-text"><div class="pnt-autocomplete-list-item-name">'+(null==(jade.interp=name)?"":jade.interp)+'</div><div class="pnt-autocomplete-list-item-sublabel">'+(null==(jade.interp=sublabel)?"":jade.interp)+"</div></div></div>");return buf.join("")}}),function(){define("cs!common/modules/omniEncoder",["underscore"],function(a){var b,c,d,e,f,g,h;return h=".pnt-user",e=".pnt-hashtag",b={encodeHTMLtoString:function(b){var f;if(!(b instanceof HTMLElement))throw"Error: el is not an HTMLElement";return f="",a.each(b.childNodes,function(a){return f+=a instanceof HTMLSpanElement?a.className.match(new RegExp("\\b"+h+"\\b"))&&a.hasAttribute("data-id")?"(user:"+a.getAttribute("data-id")+")":a.className.match(new RegExp("\\b"+e+"\\b"))&&a.hasAttribute("data-hashtag")?"(hashtag:"+a.getAttribute("data-id")+")":c(d(a.textContent)):a instanceof Text?c(d(a.textContent.replace(/\xA0/," "))):a.textContent}),f},decodeStringToHTML:function(a,b,c){var d,e,g,h,i,j,k;if(d={messageType:"comment",text:"",users:[],hashtags:[]},g="",j=/\((user):(.+?)\)/g,!a.match(j))return d.text=f(a),d;for(h=0;null!==(i=j.exec(a));)switch(k=a.slice(h,i.index),g+=k,this.hasNonWhitespace(k)&&(e=!0),h=i.index+i[0].length,i[1]){case"user":g+=b(i[2]),d.users.push(i[2]);break;case"hashtag":g+=c(i[2]),d.hashtags.push(i[2])}return k=a.slice(h,a.length),g+=k,this.hasNonWhitespace(k)&&(e=!0),d.text=f(g),e?d.messageType="comment":(d.users.length&&!d.hashtags.length&&(d.messageType="userAddEvent"),d.users.hashtags&&!d.users.length&&(d.messageType="hashtagAddEvent")),d},hasNonWhitespace:function(a){if("string"!=typeof a)throw new TypeError("hasNonWhitespace requires a string");return/\S/.test(a)},encodeHTMLString:function(a){return c(a)}},g=function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},d=function(a){return a.replace(/\(/g,"\\(").replace(/\)/g,"\\)")},f=function(a){return a.replace(/\\\(/g,"(").replace(/\\\)/g,")")},c=function(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;")},b})}.call(this),function(){var a,b,c;a={},a.set=function(a,d){var e,f,g,h,i,j,k,l;for(g=b(d),i=0,k=a.length;k>i;i++)if(e=a[i],g===e.register||null==e.register&&g===e.value)return e.value;for(f=Math.floor(100*Math.random()+1),h=0,j=0,l=a.length;l>j;j++)if(e=a[j],h+=e.share,h>=f)return null!=d&&c(e,d),e.value},c=function(b,c){var d,e;if(null!=a.register)return d={},d[c]=null!=(e=b.register)?e:b.value,a.register(d)},b=function(b){return a.getProp?a.getProp(b):!1},"function"==typeof define&&define.amd&&define("ab",[],function(){return a}),null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(module.exports=a)}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/searchOmniboxView",["common.config","jquery","backbone","cs!views/dropdownAutocompleteView","jade!templates/searchOmniboxTemplate","jade!templates/autocompleteFriendItemTemplate","cs!common/modules/omniEncoder","cs!common/modules/helpers","cs!common/modules/english","ab"],function(a,c,d,e,f,g,h,i,j){var k,l,m,n,o;return l=function(a){return null==a&&(a=""),document.createTextNode(a)},m=function(a,b){return null!=a?a.insertBefore(b,a.firstChild):void 0},o=function(a){return/(input|textarea)/i.test(a.tagName)||a.isContentEditable},n=function(a){return"number"==typeof a.which&&a.which>0?!a.ctrlKey&&!a.metaKey&&!a.altKey&&8!==a.which:!1},k=function(k){function n(){var a=this;return this.focusInCurrentNode=function(){return n.prototype.focusInCurrentNode.apply(a,arguments)},this.focusInput=function(){return n.prototype.focusInput.apply(a,arguments)},this.clearInput=function(){return n.prototype.clearInput.apply(a,arguments)},this.prefillInput=function(){return n.prototype.prefillInput.apply(a,arguments)},this.hasRangeSelection=function(){return n.prototype.hasRangeSelection.apply(a,arguments)},this.insertPastedText=function(){return n.prototype.insertPastedText.apply(a,arguments)},this.pasteHandler=function(){return n.prototype.pasteHandler.apply(a,arguments)},this.fillFromString=function(){return n.prototype.fillFromString.apply(a,arguments)},this.stopPropagation=function(){return n.prototype.stopPropagation.apply(a,arguments)},this.onChosenItemRemoval=function(){return n.prototype.onChosenItemRemoval.apply(a,arguments)},this.onUserTagChange=function(){return n.prototype.onUserTagChange.apply(a,arguments)},this.onInputMutation=function(){return n.prototype.onInputMutation.apply(a,arguments)},this.deleteChosenItemOnClick=function(){return n.prototype.deleteChosenItemOnClick.apply(a,arguments)},this.keydownInputHandler=function(){return n.prototype.keydownInputHandler.apply(a,arguments)},this.emptyAutocompletes=function(){return n.prototype.emptyAutocompletes.apply(a,arguments)},this.updateAutocompleteTerm=function(){return n.prototype.updateAutocompleteTerm.apply(a,arguments)},this.getAutocompleteTerm=function(){return n.prototype.getAutocompleteTerm.apply(a,arguments)},this.updateAutocompletes=function(){return n.prototype.updateAutocompletes.apply(a,arguments)},this.updateSearchTerm=function(){return n.prototype.updateSearchTerm.apply(a,arguments)},this.renderSearchParams=function(){return n.prototype.renderSearchParams.apply(a,arguments)},this.keyupInputHandler=function(){return n.prototype.keyupInputHandler.apply(a,arguments)},this.resetOmnibox=function(){return n.prototype.resetOmnibox.apply(a,arguments)},this.resetFriends=function(){return n.prototype.resetFriends.apply(a,arguments)},this.setCurrentNode=function(){return n.prototype.setCurrentNode.apply(a,arguments)},this.onMessageSend=function(){return n.prototype.onMessageSend.apply(a,arguments)},this.onChooseItem=function(){return n.prototype.onChooseItem.apply(a,arguments)},this.renderChosenItem=function(){return n.prototype.renderChosenItem.apply(a,arguments)},this.setAutocompleteNode=function(){return n.prototype.setAutocompleteNode.apply(a,arguments)},this.setCurrentNodeText=function(){return n.prototype.setCurrentNodeText.apply(a,arguments)},this.onAutocompleteMouseLeave=function(){return n.prototype.onAutocompleteMouseLeave.apply(a,arguments)},this.onSelectItem=function(){return n.prototype.onSelectItem.apply(a,arguments)},n.__super__.constructor.apply(this,arguments)}return b(n,k),n.prototype.clearSearch=function(){return this.resetOmnibox(),this.updateSearchTermDebounced()},n.prototype.initialize=function(b){var c,e;return null==b&&(b={}),window.omnibox=this,window.Config=a,this.$appendTo=b.appendTo,this.childViews=[],this.currentNode=this.currOffset=this.autoNode=null,this.updateSearchTermDebounced=_.debounce(this.updateSearchTerm,250),this.friendCollection=a.friends.clone(),this.friendCollection.reset(this.friendCollection.where({pnt_user:!0})),this.userTags=new d.Collection,this.listenTo(this.userTags,"add remove",this.onUserTagChange),this.render(),c=window.localStorage.lastRoute,this._searchesSoFar=0,0===(null!=c?c.indexOf("inbox/search/"):void 0)?(this._triggerSearchTrackOn=2,e=c.split("/")[2],this.renderSearchParams(e)):this._triggerSearchTrackOn=1,this._searchParams=JSON.stringify(this._serializeInput()),this},n.prototype.currentNode=null,n.prototype.currOffset=null,n.prototype.autoNode=null,n.prototype.render=function(){return this.$el.html(f()),this.$pasteInput=this.$(".pnt-omnibox-paste-input"),this.$input=this.$(".pnt-omnibox-input-box"),this.input=this.$input[0],this.$placeholder=this.$(".pnt-omnibox-input-placeholder").show(),this.observer=new MutationObserver(this.onInputMutation),this.observer.observe(this.input,{childList:!0}),this.friendAutocompleteView=new e({el:this.$("#pnt-friend-autocomplete"),maxListLength:15,collection:this.friendCollection,chosenTags:this.userTags,getModelValue:function(a){var b;return null!=(b=a.get("email"))?b:a.get("name")},template:{listItemTemplate:g,locals:function(a){var b,c,d;return b=a.toJSON(),b.avatar=i.getAvatar(b),b.initials=j.getInitials(b.name),null==(c=b.sublabel)&&(b.sublabel=b.email),null==(d=b.pnt_user)&&(b.pnt_user=!1),b}},matchOn:function(a){return a.get("_term")},getLabel:function(a){return a.get("name")},postRender:i.fetchAvatars,chosenItemClass:"pnt-user",handlers:{itemSelectedHandler:this.onSelectItem,itemChosenHandler:this.onChooseItem,enterHandler:this.onMessageSend,mouseLeaveHandler:this.onAutocompleteMouseLeave},matchers:{name:/\B@[^@]*$/,email:/\B@([^\s@]*@?[^\s@]*)$/}}),this.autocompletes=[this.friendAutocompleteView],this.childViews=this.childViews.concat(this.autocompletes)},n.prototype.onSelectItem=function(a,b){var c;return null!=(c=b.getModelValue(a,!1))?this.setCurrentNodeText(c):void 0},n.prototype.onAutocompleteMouseLeave=function(a){return this.setCurrentNodeText(a)},n.prototype.setCurrentNodeText=function(a){var b,c;if(null!=this.currString&&null!=this.autoIndex)return b=this.autoIndex+1,c=this.currentNode.nodeValue,c=c.substring(0,b)+a+c.substring(b+this.autoTerm.length),this.currentNode.nodeValue=c,this.currOffset=b+a.length,this.autoTerm=a,this.currString=c.substring(0,this.currOffset),this.focusInCurrentNode()},n.prototype.setAutocompleteNode=function(){return this.autoIndex>-1?(this.currentNode.splitText(this.currOffset),this.autoNode=this.currentNode.splitText(this.autoIndex)):void 0},n.prototype.renderChosenItem=function(b,d){var e,f,g=this;return this.setAutocompleteNode(),null!=this.autoNode?(e=document.createElement("span"),this.input.insertBefore(e,this.autoNode),f=this.getUserTagContent(b),b.id!==a.user.id&&this.userTags.get(a.user.id)&&_.defer(function(){return g.$("[data-id='"+a.user.id+"']").remove()}),c(e).html(f).addClass("pnt-omnibox-chosen-item pj "+d.chosenItemClass).attr("contenteditable","false").attr("data-id",b.id).after("&nbsp;"),this.autoNode.parentNode.removeChild(this.autoNode),this.autoNode=null,this.currentNode=e.nextSibling,this.currOffset=1):void 0},n.prototype.onChooseItem=function(a,b){return this.renderChosenItem(a,b),null!=this.currentNode?this.focusInCurrentNode():void 0},n.prototype.onMessageSend=function(){},n.prototype.setCurrentNode=function(a,b){var d,e,f,g,h,i,j,k;if(this.currentNode=this.currOffset=this.currString=null,3!==(null!=(j=this.input.firstChild)?j.nodeType:void 0)&&m(this.input,l()),3!==(null!=(k=this.input.lastChild)?k.nodeType:void 0)&&this.input.appendChild(l()),null!=a){if(this.range=document.getSelection(),this.hasRangeSelection())return;if(!c(this.range.focusNode).closest(".pnt-omnibox-input-box").length)return;d=this.range.baseNode,e=this.range.baseOffset,d!==this.input||b?(this.currentNode=d,this.currOffset=e):(i=d.childNodes[e],3===(null!=i?i.nodeType:void 0)?(this.currentNode=i,this.currOffset=this.currentNode.textContent.length,this.currString=this.currentNode.textContent):(null!=i&&d.removeChild(i),g=document.createTextNode(""),(f=d.childNodes[e])?d.insertBefore(g,f):d.appendChild(g),this.currentNode=g,this.currOffset=0),this.focusInCurrentNode())}else{if(!this.$input.is(":visible"))return;this.currentNode=this.input.lastChild,this.currOffset=this.currentNode.textContent.length}return this.currString=null!=(h=this.currentNode.textContent)?h.substring(0,this.currOffset):null},n.prototype.resetFriends=function(){var b;return null!=(b=this.friendAutocompleteView)?b.collection.reset(a.friends.models):void 0},n.prototype.resetOmnibox=function(){return this.userTags.reset(),this.clearInput(),this.setCurrentNode()},n.prototype.events={"click .pnt-omnibox-input-box":"onClick","keydown .pnt-omnibox-input-box":"keydownInputHandler","keypress .pnt-omnibox-input-box":"stopPropagation","keyup .pnt-omnibox-input-box":"keyupInputHandler","click .pnt-omnibox-chosen-item":"deleteChosenItemOnClick","paste .pnt-omnibox-input-box":"pasteHandler","focus .pnt-omnibox-input-box":"onFocus","blur .pnt-omnibox-input-box":"onBlur"},n.prototype.onFocus=function(){return this._focused=!0,this.$input.text().length?this.updateSearchTermDebounced():void 0},n.prototype.onBlur=function(){return this._focused=!1},n.prototype.ensureFocus=function(){return this._focused?void 0:this.focusInput()},n.prototype.keyupInputHandler=function(a){var b;return this.$placeholder.hide(),this.stopPropagation(a),40!==(b=a.keyCode)&&38!==b&&13!==b&&9!==b&&32!==b?(this.updateAutocompletes(a),this._autocompleting?void 0:this.updateSearchTermDebounced()):void 0},n.prototype._serializeInput=function(){var a,b,c;return a="",_.each(this.$input[0].childNodes,function(b){return 3===b.nodeType?a+=b.textContent:void 0}),b=a.trim(),c=this.userTags.pluck("pid"),{term:b,users:c,isEmpty:!b.length&&!c.length}},n.prototype.renderSearchParams=function(a){return a!==this._searchParams?(this.fillFromString(a),this.$placeholder.hide()):void 0},n.prototype.updateSearchTerm=function(){var b,c,d;if(!(this._autocompleting&&(null!=(d=this.currAutoView)?d._listVisible:void 0)))return c=this._serializeInput(),b=encodeURIComponent(JSON.stringify(c)),this._searchParams=b,a.router.navigate("inbox/search/"+b,{trigger:!0}),c.isEmpty||(this._searchesSoFar++,this._searchesSoFar!==this._triggerSearchTrackOn)?void 0:this.trackEvent("Searched Points")},n.prototype.updateAutocompletes=function(a){var b;return this.setCurrentNode(a),b=this.getAutocompleteTerm(),this.autoTerm=b||"","string"==typeof b?(this._autocompleting=!0,this.updateAutocompleteTerm(b)):this._autocompleting=!1,this.emptyAutocompletes()},n.prototype.getAutocompleteTerm=function(){var a,b=this;return null==(a=this.currString)?!1:(this.autoIndex=-1,this.currAutoView=null,this.autocompletes.forEach(function(c){var d,e,f,g;if(null!=c.matchers){_.extend(c,{_nextTerm:null,matchIndex:-1,toMatch:[],active:!1}),g=c.matchers;for(d in g)f=g[d],(e=a.match(f))&&(e.index>c.matchIndex&&_.extend(c,{matchIndex:e.index,_nextTerm:a.substring(e.index+1)}),c.toMatch.push(d));return c.matchIndex>b.autoIndex?(b.autoIndex=c.matchIndex,b.currAutoView=c):void 0}}),null!=this.currAutoView?(this.currAutoView.active=!0,this.currAutoView._nextTerm):!1)},n.prototype.updateAutocompleteTerm=function(a){var b;return null!=(b=this.currAutoView)?b.updateTerm(a):void 0},n.prototype.emptyAutocompletes=function(){return this.autocompletes.forEach(function(a){return a.active||a.emptyListEl(),delete a.active})},n.prototype.keydownInputHandler=function(a){var b,d,e,f,g;if(this.stopPropagation(a),this.input.normalize(),this.setCurrentNode(a,!0),40===(e=a.keyCode)||38===e||13===e||9===e)return null!=(null!=(f=this.currAutoView)?f.$selection:void 0)?this.currAutoView.onKeydownBody(a):13===a.keyCode&&(a.preventDefault(),this.onMessageSend()),void 0;if(this.hasRangeSelection())return!0;if(8===(g=a.keyCode)||46===g){if(null==this.currentNode)return;b=c(this.currentNode.previousSibling),1===this.currOffset&&b.hasClass("pnt-omnibox-chosen-item")&&(a.preventDefault(),d=this.currentNode.nodeValue,1===d.length?/\s/.test(this.currentNode.nodeValue[0])||(this.currentNode.nodeValue="  "):this.currentNode.nodeValue=d.slice(1),this.currOffset=0,this.focusInCurrentNode())}return!0},n.prototype.deleteChosenItemOnClick=function(a){return c(a.target).remove()},n.prototype.onInputMutation=function(a){var b;return b=this.onChosenItemRemoval,null!=a?a.forEach(function(a){var d;if(null!=(d=a.removedNodes)?d.length:void 0)return _.each(a.removedNodes,function(a){var d;if(1===a.nodeType&&(d=c(a),d.hasClass("pnt-omnibox-chosen-item")))return b(d)})}):void 0},n.prototype.onUserTagChange=function(){return this.updateSearchTermDebounced()},n.prototype.onChosenItemRemoval=function(a){var b;return b=a.attr("data-id"),_.find(this.autocompletes,function(c){return a.hasClass(c.chosenItemClass)?(c.chosenTags.remove(b),c.unChooseItem(b),!0):void 0})},n.prototype.stopPropagation=function(a){return a.stopImmediatePropagation(),a.stopPropagation()},n.prototype.getUserTagContent=function(b){var c;return b.id===a.user.id?"Points sent to myself":(c=b.get("name"),c.split(" ")[0])},n.prototype.fillFromString=function(a){var b,c,d,e,f,g=this;try{a=decodeURIComponent(a),e=JSON.parse(a),f=e.users.map(function(a){return"(user:"+a+")"}),f.push(e.term),d=f.join(" "),c=h.decodeStringToHTML(d,function(a){var b;return b=g.friendCollection.get(a),null==b?"":(g.userTags.add(b),g.friendAutocompleteView.removeChosen(b),"<span class='pnt-omnibox-chosen-item pj pnt-user' data-id='"+b.id+"' contenteditable='false'>\n    "+g.getUserTagContent(b)+"\n</span>")},function(a){return"#"+a}),this.$input.html(c.text+"&nbsp;"),this.currentNode=this.input.lastChild,this.currOffset=this.currentNode.textContent.length,b=this.focusInCurrentNode}catch(i){b=this.focusInput}return requestAnimationFrame(b)},n.prototype.pasteHandler=function(a){var b,c=this;return this.range=document.getSelection(),this.range.isCollapsed||(b=this.range.getRangeAt(0),this.currentNode=b.startContainer,this.currOffset=b.startOffset,b.deleteContents()),this.$pasteInput.addClass("is-pasteable").focus().select(),setTimeout(function(){return c.insertPastedText(a)},4),!0},n.prototype.insertPastedText=function(){var a,b,c,d;return b=this.$pasteInput.text(),this.$pasteInput.html("").removeClass("is-pasteable"),c=document.createTextNode(b),null==(null!=(d=this.currentNode)?d.nodeValue:void 0)&&this.setCurrentNode(),a=this.currOffset>this.currentNode.nodeValue.length?this.currentNode.nextSibling:3!==this.currentNode.nodeType?this.input.lastChild:this.currentNode.splitText(this.currOffset),(null==a||3!==a.nodeType)&&(this.$input.append("&nbsp;"),a=this.$input[0].lastChild),this.input.insertBefore(c,a),this.currentNode=c,this.currOffset=c.length,null!=this.currentNode&&null!=this.currOffset?this.focusInCurrentNode():this.focusInput()},n.prototype.hasRangeSelection=function(){return null!=this.range&&(!this.range.isCollapsed||"Range"===this.range.type)},n.prototype.prefillInput=function(){return this.$input.is(":empty")?this.input.appendChild(document.createTextNode("")):void 0},n.prototype.clearInput=function(){return this.$input.html(""),this.input.appendChild(document.createTextNode(""))},n.prototype.focusInput=function(a){if(this.prefillInput(a),(null!=a||null==this.currentNode)&&this.setCurrentNode(a),this.currentNode){if(this.hasRangeSelection())return;return this.focusInCurrentNode()}return this.$input.focus()},n.prototype.onClick=function(a){return this.stopPropagation(a),this.focusInput(a),this.updateAutocompletes()},n.prototype.focusInCurrentNode=function(){var a,b,c,d;if(null!=this.currentNode)return null==(c=this.currOffset)&&(this.currOffset=(null!=(d=this.currentNode.nodeValue)?d.length:void 0)||0),this.currOffset=Math.min(this.currOffset,this.currentNode.textContent.length),a=document.createRange(),b=document.getSelection(),a.setStart(this.currentNode,this.currOffset),a.collapse(!0),b.removeAllRanges(),b.addRange(a)},n}(d.View)})}.call(this),function(){define("cs!common/modules/notificationManifest",["common.config","underscore","cs!common/modules/english","cs!common/modules/helpers"],function(a,b,c,d){var e,f,g,h;return h=function(a){return/^[0-9a-fA-F]{24}$/.test(a)},g=function(a){var e,f,g;return f=b.compact(null!=(g=a.value)?g:a.friends),(null!=f?f.length:void 0)?(e={avatarIcon:"check",avatars:b.map(f,function(a){return{url:d.getAvatar(a),initials:c.getInitials(a.name)}})},f.length>3&&(e.actions=[{label:"See all friends",eventName:"seeFriendsClicked",icon:"people"}]),e.friends=f,e):void 0},f={engage:{feedback:{text:"Have an idea that could make Point better?",actions:[{label:"Yes!",eventName:"openFeedbackPage"},{label:"Not yet"}]},lowPoints:{text:'Just a reminder - point any page by typing the "@" sign'}},friends:{"new":function(a){var d;return d=g(a),d.text=c.listOfItems(b.pluck(d.friends,"name"),null,3,null,null," and")+(d.friends.length>1?" are ":" is ")+"on Point. "+"Send them something cool!",d},accepted:function(a){var d,e;return d=g(a),e=d.friends.length>1,d.text=c.listOfItems(b.pluck(d.friends,"name"),null,3,null,null," and")+(e?" are ":" is ")+"now your friend"+(e?"s!":"!"),d},request:function(a){return{avatarIcon:"logo",avatars:[{url:d.getAvatar(a.value),initials:c.getInitials(a.value.name)}],text:a.value.name+" wants to be friends.",actions:[{label:"Accept",eventName:"friendRequestAccepted",icon:"check"},{label:"Not Now",eventName:"friendRequestRejected",icon:"x"}]}}},fb:{expired:{text:"It looks like your Facebook information is out of date. Would you like to log back in to update your friends list?",actions:[{label:"Login with Facebook",eventName:"facebookLoginClicked",icon:"facebook"},{icon:"x",label:"No thanks"}],icon:"warning"}}},e={get:function(a){var c,d,e,g,i,j,k,l,m;return d=null!=(k=a.id)?k:"",j=null!=(l=a.type)?l:"",h(d.substring(0,24))&&"point"===j?void 0:(g=j.split(":"),1===g.length?!1:(e=g[0],i=g[1],null!=(c=null!=(m=f[e])?m[i]:void 0)&&(b.isFunction(c)&&(c=c(a)),null!=c)?b.defaults(a,c):!1))}}})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/PageView",["common.config","underscore","backbone"],function(a,c,d){var e;return e=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.className="dropdown-page",c.prototype.initialize=function(a){if(this.order=a.order,null==a.appendTo)throw"No appendTo element passed to PageView";return null!=a.template&&(this.template=a.template),this.$page=$("<div class='dropdown-page-content'></div>").appendTo(this.$el),this.template&&this.render(),a.appendTo.append(this.$el),this.hide()},c.prototype.render=function(){var a,b;return b=this.locals?this.locals.call(this):{},a=this.template.call(this,b),this.$page.html(a)},c.prototype.hide=function(){return this.$el.addClass("pnt-is-hidden"),this},c.prototype.show=function(){return this.$el.removeClass("pnt-is-hidden"),this},c.prototype.hideLeft=function(){return this.$el.removeClass("enter-left enter-right"),this.$el.addClass("hide-left"),this},c.prototype.hideRight=function(){return this.$el.removeClass("enter-left enter-right"),this.$el.addClass("hide-right"),this},c.prototype.enterLeft=function(){return this.show(),this.$el.removeClass("hide-right hide-left"),this.$el.addClass("enter-left"),this},c.prototype.enterRight=function(){return this.show(),this.$el.removeClass("hide-right hide-left"),this.$el.addClass("enter-right"),this},c.prototype.renderTopBar=function(a){return this.renderBar(a,"top")},c.prototype.renderBottomBar=function(a){return this.renderBar(a,"bottom")},c.prototype.renderBar=function(a,b){return this.$el.addClass("dd-page-has-"+b+"-bar").append("<div class='page-bar page-bar-"+b+"'>\n    "+a+"\n</div>")},c}(d.View)})}.call(this),define("jade!templates/pointTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{}){highlight=point.highlight?point.highlight.text:"",klass=point.highlight?"":"pnt-is-hidden";var avatar_mixin=function(a,b){this.block,this.attributes||{},this.escaped||{},buf.push("<div"+jade.attrs({"data-tt-content":a.email||a.name||"","class":"pnt-avatar "+b},{"class":!0,"data-tt-content":!0})+"><div"+jade.attrs({"data-src":helpers.getAvatar(a),"class":"pnt-avatar-placeholder"},{"data-src":!0})+">"+jade.escape(null==(jade.interp=helpers.getPlaceholderText(a))?"":jade.interp)+"</div></div>")};point._isSearchResult?(buf.push('<div class="pnt-content pnt-content-pntlistitem is-search-result"><div class="pnt-content-url-wrapper"><div class="pnt-content-favicon"><img'+jade.attrs({src:helpers.getFavicon(point.page.url)},{src:!0})+'/></div><div class="pnt-content-url">'+(null==(jade.interp=point.page.n_u)?"":jade.interp)+'</div><div style="position: absolute; right: 15px; color: #999;" class="pnt-time-stamp">'+jade.escape(null==(jade.interp=point.timeStamp)?"":jade.interp)+'</div></div><div class="pnt-content-title">'+(null==(jade.interp=point.page.title)?"":jade.interp)+"</div>"),point.page.tags&&buf.push('<div class="pnt-content-tags">Keywords: <span>'+(null==(jade.interp=point.page.tags)?"":jade.interp)+"</span></div>"),buf.push("</div>")):buf.push('<div class="pnt-content pnt-content-pntlistitem"><div class="pnt-content-url-wrapper"><div class="pnt-content-favicon"><img'+jade.attrs({src:helpers.getFavicon(point.page.url)},{src:!0})+'/></div><div class="pnt-content-url">'+jade.escape(null==(jade.interp=point.page.n_u)?"":jade.interp)+'</div></div><div class="pnt-content-title">'+jade.escape(null==(jade.interp=point.page.title)?"":jade.interp)+"</div></div>"),buf.push('<div class="pntlistitem-meta"><div class="pnt-avatars">'),avatar_mixin(users.sender,"pnt-avatar-m"),users.recipients&&(buf.push('<i class="pnticn-caret_right"></i>'),function(){var a=users.recipients;if("number"==typeof a.length)for(var b=0,c=a.length;c>b;b++){var d=a[b];avatar_mixin(d,"pnt-avatar-m")}else{var c=0;for(var b in a)if(c++,a.hasOwnProperty(b)){var d=a[b];avatar_mixin(d,"pnt-avatar-m")}}}.call(this),users.recipients.extra&&buf.push("<div"+jade.attrs({"data-tt-content":users.recipients.extraString,"class":"pnt-avatar pnt-avatar-m pnt-avatar-count"},{"data-tt-content":!0})+">"+jade.escape(null==(jade.interp=users.recipients.extra.length)?"":jade.interp)+"</div>")),buf.push('</div><div class="pntlistitem-meta-comment-count">'+jade.escape(null==(jade.interp=point.m_count)?"":jade.interp)+'</div></div><div class="pnt-quickreply-wrapper"><div style="display: none" class="pntmsgs-num-unreads"></div><div class="pnt-messages-wrapper pnt-messages-pntlistitem"><div class="pnt-messages pnt-messages-pntlistitem"></div></div><div class="pnt-omnibox pnt-omnibox-pntlistitem"><div class="pnt-omnibox-input-triangle"></div><span contenteditable="true" class="pnt-omnibox-input-box pnt-form"></span></div></div>')}return buf.join("")}}),define("jade!common/templates/messageTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{}){klass=isOutbound?"is-pnt-message-outbound ":"is-pnt-message-inbound ";var avatar_mixin=function(a){this.block,this.attributes||{},this.escaped||{},buf.push("<div"+jade.attrs({"class":"pnt-avatar "+a},{"class":!0})+"><div"+jade.attrs({"data-src":senderAvatar,"class":"pnt-avatar-placeholder"},{"data-src":!0})+">"+jade.escape(null==(jade.interp=helpers.getPlaceholderText(senderName))?"":jade.interp)+"</div></div>")};"userAddEvent"==messageType?buf.push('<div class="pnt-message pnt-message-pj pnt-is-user-add-event"><div class="pnt-message-flex"><div class="pnt-message-text">'+(null==(jade.interp=messageText)?"":jade.interp)+'</div></div><div class="pnt-message-meta">'+jade.escape(null==(jade.interp=prettyTime)?"":jade.interp)+"</div></div>"):"highlight"==messageType?(buf.push("<div"+jade.attrs({"data-id":messageID,"class":"pnt-message pnt-message-pj pnt-is-highlight-event "+klass},{"class":!0,"data-id":!0})+'><div class="pnt-message-flex"><div class="pnt-tooltip-wrapper">'),avatar_mixin("pnt-comment-avatar pnt-avatar-m"),buf.push('<div class="pnt-tooltip pnt-tt-m pnt-tt-left-arrow"><div class="pnt-tooltip-content">'+jade.escape(null==(jade.interp=senderName)?"":jade.interp)+'</div></div></div><div class="pnt-message-text"><div class="pnt-message-text-inside">'),isImageHighlight?buf.push("<img"+jade.attrs({src:highlight,"class":"pnt-message-image-highlight"},{src:!0})+"/>"):buf.push(null==(jade.interp=messageText)?"":jade.interp),buf.push('</div></div></div><div class="pnt-message-meta">'+jade.escape(null==(jade.interp=prettyTime)?"":jade.interp)+"</div></div>")):"tempHighlight"==messageType?buf.push("<div"+jade.attrs({"class":"pnt-message pnt-message-pj pnt-is-highlight-event pnt-is-temp-highlight "+klass},{"class":!0})+'><div class="pnt-message-flex"><div class="pnt-message-text"><div class="pnt-message-text-inside">'+(null==(jade.interp=messageText)?"":jade.interp)+"</div></div></div></div>"):(buf.push("<div"+jade.attrs({"class":"pnt-message pnt-message-pj pnt-is-comment-event "+klass},{"class":!0})+'><div class="pnt-message-flex"><div class="pnt-message-text">'+(null==(jade.interp=messageText)?"":jade.interp)+'</div><div class="pnt-tooltip-wrapper">'),avatar_mixin("pnt-comment-avatar pnt-avatar-m"),buf.push('<div class="pnt-tooltip pnt-tt-m pnt-tt-left-arrow"><div class="pnt-tooltip-content">'+jade.escape(null==(jade.interp=senderName)?"":jade.interp)+'</div></div></div></div><div class="pnt-message-meta">'+jade.escape(null==(jade.interp=prettyTime)?"":jade.interp)+"</div></div>"))
}return buf.join("")}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/dropdownMessagesView",["common.config","jquery","backbone","cs!common/browser/browser","jade!common/templates/messageTemplate","cs!common/modules/omniEncoder","cs!common/modules/english","cs!common/modules/helpers","iscroll"],function(a,c,d,e,f,g,h,i,j){var k;return k=function(d){function g(){var a=this;return this.refreshStops=function(){return g.prototype.refreshStops.apply(a,arguments)},this.onScroll=function(){return g.prototype.onScroll.apply(a,arguments)},this._isImageHighlight=function(){return g.prototype._isImageHighlight.apply(a,arguments)},this.openEmbeddedLink=function(){return g.prototype.openEmbeddedLink.apply(a,arguments)},this.appendMessage=function(b,c){return null==c&&(c=!1),g.prototype.appendMessage.apply(a,arguments)},this.appendAllMessages=function(){return g.prototype.appendAllMessages.apply(a,arguments)},this.handleMaxMessages=function(){return g.prototype.handleMaxMessages.apply(a,arguments)},this.handleNewMessages=function(){return g.prototype.handleNewMessages.apply(a,arguments)},this.onMessageAdd=function(){return g.prototype.onMessageAdd.apply(a,arguments)},this.onMessageReset=function(){return g.prototype.onMessageReset.apply(a,arguments)},g.__super__.constructor.apply(this,arguments)}return b(g,d),g.prototype.initialize=function(a){var b,c,d,e,f,g,h=this;return this.messages=this.model.messages,a.scroll?(this.handleNewMessagesDebounced=_.debounce(this.handleNewMessages,10),this.scrollToBottomDebounced=_.debounce(this.scrollToBottom,100),this.scroll=new j(this.$el.parent()[0],{scrollbars:!0,mouseWheel:!0,disableMouse:!0,disablePointer:!0,disableTouch:!0,interactiveScrollbars:!0,fadeScrollbars:!0,probeType:2,momentum:!0}),this.scroll.on("scroll",this.onScroll),this.scroll.on("scrollEnd",this.refreshStops)):(this.MAX_MESSAGES=null!=(g=a.MAX_MESSAGES)?g:3,this.handleNewMessagesDebounced=_.debounce(this.handleMaxMessages,10),_.defer(function(){var a;return h.messageElements=null!=(a=h.el)?a.childNodes:void 0})),this.messages.length&&this.appendAllMessages(),this.listenTo(this.messages,"add",this.onMessageAdd),this.listenTo(this.messages,"reset",this.onMessageReset),b=a.$msgCount,c=a.msgCount,d=0,e=this.model,f=_.debounce(function(){return c+=d,e.set("m_count",c),d=0,b.text(c)},10),this.listenTo(this.messages,"add",function(){return d++,f()}),this.listenTo(this.messages,"reset",function(){return c=h.messages.length,d=0})},g.prototype.onMessageReset=function(){return this.$el.html(""),this.appendAllMessages()},g.prototype.onMessageAdd=function(a){return this.appendMessage(a),"function"==typeof this.handleNewMessagesDebounced?this.handleNewMessagesDebounced():void 0},g.prototype.handleNewMessages=function(){return this._synced?this.scrollToBottom(!0):(this.scrollToBottom(),this._synced=!0)},g.prototype.handleMaxMessages=function(){var a;if((null!=(a=this.messageElements)?a.length:void 0)>this.MAX_MESSAGES){for(;this.messageElements.length>this.MAX_MESSAGES;)this.messageElements.item(0).remove();return this.trigger("showMoreMessagesIndicator")}},g.prototype.appendAllMessages=function(){return this.messages.usersAdded=[],this.messages.each(this.appendMessage),"function"==typeof this.handleNewMessagesDebounced?this.handleNewMessagesDebounced():void 0},g.prototype.appendMessage=function(b,d){var e,g,j,k,l,m,n,o;if(null==d&&(d=!1),(null!=b?b.get("body").length:void 0)&&null!=(o=this.model.getMemberById(b.get("sender")))&&(l=this.decodeMessageText(b))){switch(n={isOutbound:a.user.isMe(b.get("sender")),prettyTime:b.getPrettyTime(),senderAvatar:i.getAvatar(o.toJSON()),senderName:b.getSenderName(),messageText:l.text,messageID:b.id,helpers:{getPlaceholderText:function(a){return h.getInitials(a)}}},l.messageType){case"userAddEvent":e=c(f(_.extend({},n,{messageType:"userAddEvent",messageText:b.getAddEventText(l.users)}))),this.$el.append(e);break;case"highlight":m=this._isImageHighlight(b.get("highlight")),e=c(f(_.extend({},n,{messageType:"highlight",highlight:b.get("highlight").text,senderName:h.capitalizeFirstLetter(h.getFirstName(b.getSenderName())),isImageHighlight:m}))),this.$el.append(e),m&&(g=e.find(".pnt-message-image-highlight"),g.load(this.onImageLoad));break;default:l.users.length&&(k=c(f(_.extend({},n,{messageType:"userAddEvent",messageText:b.getAddEventText(l.users)}))),this.$el.append(k)),e=c(f(_.extend({},n,{messageType:"comment"}))),this.$el.append(e)}return j=e.prev(),"userAddEvent"===l.messageType?((null!=j?j.hasClass("pnt-is-user-add-event"):void 0)||j.addClass("is-pnt-message-last-chunk"),this._lastMessageSender=!1):(null!=this._lastMessageSender?this._lastMessageSender===n.senderName?e.addClass("is-pnt-message-middle-chunk"):(j.addClass("is-pnt-message-last-chunk"),e.addClass("is-pnt-message-first-chunk")):e.addClass("is-pnt-message-first-chunk"),this._lastMessageSender=n.senderName),k&&(j=k.prev(),j.hasClass("pnt-is-user-add-event")||j.addClass("is-pnt-message-last-chunk")),i.fetchAvatars(e),e}},g.prototype.decodeMessageText=function(a){return a.decodeStringToHTML(a.get("body"),_.bind(function(a){var b;return null==(b=this.model.getMemberById(a))?!1:"<span class='pnt-chosen-user' data-id='"+a+"'>\n    "+b.getName()+"\n</span>"},this),_.bind(function(a){return"<span class='pnt-chosen-hashtag' data-id='"+a+"'>\n    "+this.model.getMemberById(a).get("name")+"\n</span>"},this))},g.prototype.events={"click .pnt-is-highlight-event":"onHighlightClick","click .pnt-message-link":"openEmbeddedLink"},g.prototype.onHighlightClick=function(a){var b;return null!=(b=e.extension)?b.sendMessage({request:"open:point",details:{pointID:this.model.id,url:this.model.get("page").url,active:!(a.metaKey||a.ctrlKey)}}):void 0},g.prototype.openEmbeddedLink=function(a){return e.extension.sendMessage({request:"open:tab",details:{url:c(a.target).attr("href"),active:!(a.metaKey||a.ctrlKey)}})},g.prototype._isImageHighlight=function(a){var b,c;return null!=a.h_type?"image"===a.h_type:null!=(b=this.model.highlights.get(a._id))&&b.isImageHighlight()?!0:(null==(c=this._imgRegex)&&(this._imgRegex=/^https?:\/\/.+\.(jpg|jpeg|png|gif|tif|exf|svg|wfm)$/),this._imgRegex.test(a.text))},g.prototype.scrollToBottom=function(a,b){return null==a&&(a=!1),null==b&&(b=1e3),this.scroll.refresh(),a?(this.refreshStops(a),this.scroll.scrollTo(0,this.scroll.maxScrollY,b)):(this.scroll.scrollTo(0,this.scroll.maxScrollY,0),_.defer(this.refreshStops))},g.prototype._getCurrentChunk=function(a){var b,c,d,e,f;if(!(null!=(f=this.chunks)?f.length:void 0))return!1;for(e=0,d=this.chunks.length-1,c=null,b=null;d>=e;){if(c=0|e+d/2,b=this.chunks[c],!b)return!1;if(a<b.top)d-=1;else{if(!(a>b.bottom))return b;e+=1}}return!1},g.prototype._lastY=0,g.prototype.onScroll=function(a){var b,c;return c=-1*this.scroll.y,b=this._getCurrentChunk(c),b?(this._lastY=c,a?b.$avatar.css({"webkit-transition":"top 350ms linear",top:this._lastY+10}):b.$avatar.css({"webkit-transition":"none",top:this._lastY+10})):void 0},g.prototype.refreshStops=function(a){var b,d,e=this;return d=-1*this.scroll.y,b=this.$el.offset().top,this.chunks=[],this.$(".pnt-tooltip-wrapper:visible").each(function(a,b){var f,g,h,i,j,k,l,m,n;return h=c(b),g=h.closest(".pnt-message"),f=g.hasClass("is-pnt-message-last-chunk")?g:g.nextAll(".is-pnt-message-last-chunk:first"),f.length||(f=e.$(".pnt-message:last-of-type"),k=!0),l={parent:e.el.getBoundingClientRect(),message:g[0].getBoundingClientRect(),end:f[0].getBoundingClientRect()},n=l.message.top-l.parent.top,i=l.end.top-l.parent.top+l.end.height,i-n>=100?(j={top:n-10,bottom:i-10-26,$avatar:h,$message:g,inbound:g.hasClass("is-pnt-message-inbound")},e.chunks.push(j),m=d>j.bottom?i:Math.max(n-10,d)+10,h.css({position:"absolute",top:m})):void 0}),_.defer(this.onScroll,a)},g}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/PointView",["backbone","common.config","cs!common/browser/browser","jade!templates/pointTemplate","cs!views/dropdownMessagesView","cs!common/models/messageModel","cs!common/modules/omniEncoder","cs!common/modules/english","cs!common/modules/helpers","jade!common/templates/messageTemplate"],function(a,c,d,e,f,g,h,i,j){var k,l,m,n,o;return o=function(a){return 1e3*parseInt(a.toString().slice(0,8),16)},n=function(a){var b,c,d,e,f,g;if(a&&(e=o(a)))return b=new Date(e),g=b.getYear()-100,d=b.getMonth()+1,c=b.getDate(),f=d+"/"+c,{year:g,part:f,full:f+"/"+g}},l=function(a,b){return b&&a.year===b?a.part:a.full},m=function(a,b){var c,d,e;return c=(new Date).getYear()-100,d=n(a),e=n(b),d?e?d.year!==e.year?l(d)+"-"+l(e,c):d.part===e.part?l(d,c):d.part+"-"+l(e,c):l(d,c):""},k=function(g){function k(){var a=this;return this.markAsRead=function(){return k.prototype.markAsRead.apply(a,arguments)},this.onMouseLeaveAvatar=function(){return k.prototype.onMouseLeaveAvatar.apply(a,arguments)},this.onMouseEnterAvatar=function(){return k.prototype.onMouseEnterAvatar.apply(a,arguments)},this.onKeypress=function(){return k.prototype.onKeypress.apply(a,arguments)},this.openModalOnClick=function(){return k.prototype.openModalOnClick.apply(a,arguments)},this.focusOmniboxOnClick=function(){return k.prototype.focusOmniboxOnClick.apply(a,arguments)},this.sendMessage=function(){return k.prototype.sendMessage.apply(a,arguments)},this.renderReadReceipts=function(){return k.prototype.renderReadReceipts.apply(a,arguments)},this.showMoreMessagesIndicator=function(){return k.prototype.showMoreMessagesIndicator.apply(a,arguments)},this.onMessagesFetched=function(){return k.prototype.onMessagesFetched.apply(a,arguments)},this.renderReadStatus=function(){return k.prototype.renderReadStatus.apply(a,arguments)},this.onReadChange=function(){return k.prototype.onReadChange.apply(a,arguments)},k.__super__.constructor.apply(this,arguments)}return b(k,g),k.prototype.className="point-list-item",k.prototype.MAX_READ_RECEIPTS=3,k.prototype.MAX_MESSAGES=3,k.prototype.initialize=function(){var a=this;return this.messages=this.model.messages,this.render()?(this.messagesView=new f({model:this.model,el:this.$(".pnt-messages"),MAX_MESSAGES:this.MAX_MESSAGES,$msgCount:this.$msgCount,msgCount:this.model.get("m_count")}),this.listenTo(this.messagesView,"showMoreMessagesIndicator",this.showMoreMessagesIndicator),this.listenTo(this.model,"modal:visible",function(){return a.hasModal=!0,a.$el.hasClass("is-new")?void 0:a.hideQuickReply()}),this.listenTo(this.model,"modal:hidden",function(){return a.hasModal=!1}),this.isUnread?this.model.messages.fetchPrevious({success:this.onMessagesFetched,silent:!0}):void 0):!1},k.prototype.onReadChange=function(a,b){return window.unreadPoint=a,this.isUnread=!b,this.isUnread&&this.$input.is(":focus")?this.markAsRead():this.renderReadStatus()},k.prototype.hideQuickReply=function(){return this.$el.removeClass("is-quickreply")},k.prototype.renderReadStatus=function(){return this.isUnread?(this.$el.removeClass("is-old").addClass("is-new"),this.isSeen()?this.$el.addClass("is-quickreply"):void 0):(this.hasModal&&this.hideQuickReply(),this.$el.removeClass("is-new").addClass("is-old"))},k.prototype.isSeen=function(){return this.model.isSeen()},k.prototype.render=function(){var a,b,d,f,g,h,k,l,n,o,p,q,r,s,t,u,v,w;if(this.lastMsg=this.model.lastMsg(),this.isUnread=!this.model.get("read"),this.isUnread||null==c.notifications.get(this.model.id)||c.notifications.requestRemoval(this.model.id),this.renderReadStatus(),this.listenTo(this.model,"change:read",this.onReadChange),!(o=this.model.get("_sender")))return!1;if(n=this.model.get("_recip")){if(b=0,!c.user.isMe(o.uid))for(q=0,s=n.length;s>q;q++){if(l=n[q],c.user.isMe(l.uid)){n.splice(b,1),n.push(l);break}b++}n.length>4&&(n.extra=n.splice(3),n.extraString=i.listOfItems(n.extra,function(a){return a.name}))}if(g=this.model.toJSON(),k=null!=(u=g._highlightResult)?u.page:void 0){for(g._isSearchResult=!0,h={},v=["title","n_u"],r=0,t=v.length;t>r;r++)d=v[r],(a=k[d])&&(f=a.matchLevel,f&&"none"!==f&&(h[d]=a.value));p=[],null!=(w=k.meta)&&w.forEach(function(a){return"none"!==a.matchLevel?p.push(a.value):void 0}),p.length&&(h.tags=p.join(", ")),_.extend(g.page,h),g.timeStamp=m(g._id,g.changed)}return this.$el.html(e({point:g,users:{sender:o,recipients:n},helpers:{getFavicon:j.getFavicon,getAvatar:j.getAvatar,getPlaceholderText:function(a){var b;return b=a.name,i.getInitials(b)}}})),j.fetchAvatars(this.$el),this.$input=this.$(".pnt-omnibox-input-box"),this.$msgText=this.$(".pnt-message-text"),this.$showMoreMessages=this.$(".pntmsgs-num-unreads"),this.$msgCount=this.$(".pntlistitem-meta-comment-count"),!0},k.prototype.onMessagesFetched=function(){var a,b,c,d,e,f,g;for(a=0,b=e=f=this.messages.length-1;0>=f?0>=e:e>=0;b=0>=f?++e:--e){if(!(c=this.messages.at(b)).isUnread()){d=!0;break}c.id!==(null!=(g=this.lastMsg)?g.id:void 0)&&a++}return 0>=a?void 0:this.showMoreMessagesIndicator(a,d)},k.prototype.showMoreMessagesIndicator=function(a,b){var c,d;return a?this.isSeen()?(c=a.toString(),b||(c+="+"),d="See "+c+" more new message",a>1&&(d+="s")):d="See all new messages":d="See all messages",this.$(".pntmsgs-num-unreads").show().text(d)},k.prototype.renderReadReceipts=function(){var a,b,d,e,f,g;if(this.lastMsg&&(g=_.compact(this.model.get("users").pluck("id").concat(this.model.get("users").pluck("uid"))),f=_.reject(_.uniq(this.lastMsg.get("recip")),c.user.isMe),d=_.reject(_.uniq(this.lastMsg.get("read")),c.user.isMe),d=_.reject(d,function(a){return g.indexOf(a)<0}),a=d.length))return a===f.length?e=1===a?this.lastMsg.getName(d[0],!0):"everyone":a>this.MAX_READ_RECEIPTS?(b=a-this.MAX_READ_RECEIPTS,b+=b>1?" others":" other",d=_.last(d,this.MAX_READ_RECEIPTS),e=this.lastMsg.getNameList(d,!0,"")+", and "+b):e=this.lastMsg.getNameList(d,!0),this.$el.find(".pnt-message-meta").append("<div class='pnt-read-receipt'>Seen by "+e+"</div>")},k.prototype.decodeCommentText=function(a){return a.body=h.encodeHTMLString(a.body),h.decodeStringToHTML(a.body,_.bind(function(a){var b;return null!=(b=this.model.getMemberById(a))?"<span class='pnt-chosen-user' data-id='"+a+"'>\n    "+b.getName()+"\n</span>":""},this),_.bind(function(a){return"<span class='pnt-chosen-hashtag' data-id='"+a+"'>\n    hashtag\n</span>"},this))},k.prototype.mxpSentFromProp="DD Quick Reply",k.prototype.sendMessage=function(){var a;return this.trackEvent("Send Message",{sent_from:this.mxpSentFromProp},"cs"),this.model.messageSendSuccess&&(a=h.encodeHTMLtoString(this.$input[0]))?(this.model.sendMessage(a),this.$input.html("")):void 0},k.prototype.events={"click .pntlistitem-meta, .pnt-quickreply-wrapper":"openModalOnClick","click .pnt-omnibox":"focusOmniboxOnClick",click:"linkClicked","keypress .pnt-omnibox-input-box":"onKeypress","mouseenter .pntlistitem-meta .pnt-avatar":"onMouseEnterAvatar","mouseleave .pntlistitem-meta .pnt-avatar":"onMouseLeaveAvatar"},k.prototype.track={"click .pntlistitem-meta, .pnt-quickreply-wrapper":"Open Point Modal"},k.prototype.focusOmniboxOnClick=function(a){return a.stopPropagation(),this.$input.focus(),this.markAsRead()},k.prototype.openModalOnClick=function(b){return b.stopPropagation(),a.trigger("pointView:openModalPoint",this.model,this.$el)},k.prototype.onKeypress=function(a){return 13===a.keyCode?this.sendMessage():void 0},k.prototype.linkClicked=function(a){return this.model.markAsClicked(),this.openLink(a)},k.prototype.onMouseEnterAvatar=function(a){var b;return b=$(a.target).closest(".pnt-avatar"),c.views.tooltip.showDelay(200,{innerHtml:b.attr("data-tt-content"),div:b})},k.prototype.onMouseLeaveAvatar=function(){return c.views.tooltip.hide()},k.prototype.openLink=function(a){var b;return null!=(b=d.extension)?b.sendMessage({request:"open:point",details:{pointID:this.model.id,url:this.model.get("page").url,active:!(a.metaKey||a.ctrlKey)}}):void 0},k.prototype.markAsRead=function(){return this.$el.removeClass("is-new").addClass("is-old"),this.model.markAsRead(),c.notifications.requestRemoval(this.model.id)},k}(a.View)})}.call(this),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("spin",b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+100*(c/d),g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{"+"0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+g+"}"+"}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;if(void 0!==e[b])return b;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function h(a){return"undefined"==typeof this?new h(a):(this.opts=f(a||{},h.defaults,n),void 0)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:j+" "+j,coordorigin:-i+" "+-i}),{width:j,height:j})}function g(a,g,h){b(l,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~g}),b(e(c("roundrect",{arcsize:d.corners}),{width:i,height:d.width,left:d.radius,top:-d.width>>1,filter:h}),c("fill",{color:d.color,opacity:d.opacity}),c("stroke",{opacity:0}))))}var h,i=d.length+d.width,j=2*i,k=2*-(d.width+d.length)+"px",l=e(f(),{position:"absolute",top:k,left:k});if(d.shadow)for(h=1;h<=d.lines;h++)g(h,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(h=1;h<=d.lines;h++)g(h);return b(a,l)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c,d,f=this,h=f.opts,i=f.el=e(a(0,{className:h.className}),{position:h.position,width:0,zIndex:h.zIndex}),k=h.radius+h.length+h.width;if(b&&(b.insertBefore(i,b.firstChild||null),d=g(b),c=g(i),e(i,{left:("auto"==h.left?d.x-c.x+(b.offsetWidth>>1):parseInt(h.left,10)+k)+"px",top:("auto"==h.top?d.y-c.y+(b.offsetHeight>>1):parseInt(h.top,10)+k)+"px"})),i.setAttribute("role","progressbar"),f.lines(i,f.opts),!j){var l,m=0,n=(h.lines-1)*(1-h.direction)/2,o=h.fps,p=o/h.speed,q=(1-h.opacity)/(p*h.trail/100),r=p/h.lines;!function s(){m++;for(var a=0;a<h.lines;a++)l=Math.max(1-(m+(h.lines-a)*r)%p*q,h.opacity),f.opacity(i,a*h.direction+n,l,h);f.timeout=f.el&&setTimeout(s,~~(1e3/o))}()}return f},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function g(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*i+f.rotate)+"deg) translate("+f.radius+"px"+",0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var h,i=0,k=(f.lines-1)*(1-f.direction)/2;i<f.lines;i++)h=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,k+i*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(h,e(g("#000","0 0 4px #000"),{top:"2px"})),b(d,b(h,g(f.color,"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h}),function(a){if("object"==typeof exports)a(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define("jqSpin",["jquery","spin"],a);else{if(!window.Spinner)throw new Error("Spin.js not present");a(window.jQuery,window.Spinner)}}(function(a,b){a.fn.spin=function(c,d){return this.each(function(){var e=a(this),f=e.data();f.spinner&&(f.spinner.stop(),delete f.spinner),c!==!1&&(c=a.extend({color:d||e.css("color")},a.fn.spin.presets[c]||c),f.spinner=new b(c).spin(this))})},a.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/PointsView",["common.config","underscore","backbone","cs!views/PageView","cs!views/PointView","cs!common/collections/pointCollection","jqSpin"],function(a,c,d,e,f){var g;return g=function(a){function c(){var a=this;return this.hideLoading=function(){return c.prototype.hideLoading.apply(a,arguments)},this.showLoading=function(){return c.prototype.showLoading.apply(a,arguments)},this.checkScroll=function(){return c.prototype.checkScroll.apply(a,arguments)},this.renderPoint=function(){return c.prototype.renderPoint.apply(a,arguments)},c.__super__.constructor.apply(this,arguments)}return b(c,a),c.CHECKSCROLL_INTERVAL=300,c.INFINITE_SCROLL_REGION_SIZE=400,c.prototype.className="dropdown-page dropdown-list",c.prototype.infiniteScroll=!1,c.prototype.initialize=function(a){return null==a&&(a={}),c.__super__.initialize.call(this,a),this.listenTo(this.collection,"add",this.renderPoint),this.listenTo(this.collection,"reset",this.renderPoints),this.listenTo(this.collection,"request",this.showLoading),this.listenTo(this.collection,"sync",this.hideLoading),this.listenTo(this.collection,"error",this.hideLoading),this.$list=$("<div class='dropdown-list-container'></div>").appendTo(this.$page),this.$spinner=$("<div class='pnt-is-hidden dropdown-loading-spinner'></div>").appendTo(this.$el),this.$spinner.spin({lines:9,length:5,width:8,radius:18,corners:1,direction:1}),this.infiniteScroll&&this.setUpScroll(),this.listenTo(d,"dropdown:socket:message",this.onMessageFromSocket),a.hidden?this.hide():void 0},c.prototype.onMessageFromSocket=function(a){var b;return null!=(b=this.collection.get(a._pid))?b.addMessage(a):void 0},c.prototype.loadPoints=function(a){return this.collection.fetch(a)},c.prototype.refresh=function(){return this.collection.fetch({reset:!0})},c.prototype.renderPoints=function(a){var b;return null!=(b=this.$page)&&b.parent().scrollTop(0),this.empty(),a.each(this.renderPoint)},c.prototype.empty=function(){return this.$list.html("")},c.prototype.events={"click .point-list-item":function(){}},c.prototype.renderPoint=function(a){var b;return b=new f({model:a}),this.$list.append(b.$el)},c.prototype.setUpScroll=function(){var a=this;return this.$el.scroll(function(){return a.didScroll=!0}),setInterval(this.checkScroll,c.CHECKSCROLL_INTERVAL)},c.prototype.checkScroll=function(){var a,b,d;if(this.loadNextPage&&this.didScroll)return this.didScroll=!1,d=this.$el.scrollTop()+this.$el.height(),a=this.$list.height(),b=a-c.INFINITE_SCROLL_REGION_SIZE,d>b&&this.collection.length>0&&!this.fetching?this.loadNextPage():void 0},c.prototype.showLoading=function(){return this.fetching=!0},c.prototype.hideLoading=function(){return this.fetching=!1,this.$spinner.addClass("pnt-is-hidden")},c}(e)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/pointFromDDView",["backbone","common.config","cs!common/browser/browser"],function(a,c,d){var e,f;return f=["chrome(.*)://","(mail|inbox).google.com"],e=function(a){function e(){var a=this;return this.onUpdatedTab=function(){return e.prototype.onUpdatedTab.apply(a,arguments)},this.setCurrentTab=function(){return e.prototype.setCurrentTab.apply(a,arguments)},this.hide=function(){return e.prototype.hide.apply(a,arguments)},this.show=function(){return e.prototype.show.apply(a,arguments)},this.render=function(){return e.prototype.render.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.className="point-send-wrapper",e.prototype.id="#point-send",e.prototype.initialize=function(){return this.$pointSendTitle=this.$("[data-js-point-send-title]"),this.$pointSendFavicon=this.$("[data-js-point-send-favicon]"),this.$pointSendUrl=this.$("[data-js-point-send-url]"),this.$pointSendFavicon.error(function(){return $(this).attr("src","../assets/icon16.png")}),this.blacklist=f,null!=window.currentTab?this.setCurrentTab(window.currentTab):chrome.tabs.getSelected(this.setCurrentTab),chrome.tabs.onUpdated.addListener(this.onUpdatedTab),this.listenTo(c.router,"route",this.onRoute)},e.prototype.render=function(a){var b,c,d,e,f;if(_.isObject(a)){c=null!=(e=a.favIconUrl)?e:"",d=(null!=(f=a.title)?f.length:void 0)?a.title:"Current Page";try{b=new URL(a.url).hostname}catch(g){b=""}return this.$pointSendFavicon.attr("src",c),this.$pointSendTitle.text(d),this.$pointSendUrl.text(b),this.show()}},e.prototype.show=function(){return this.blacklisted?this.$el.addClass("pnt-is-disabled"):this.$el.removeClass("pnt-is-disabled"),this.$el.removeClass("pnt-is-hidden")},e.prototype.hide=function(){return this.$el.addClass("pnt-is-hidden")},e.prototype.setCurrentTab=function(a){return this.currTab=a.id,this.blacklisted=_.find(this.blacklist,function(b){return new RegExp(b).test(a.url)}),this.render(a)},e.prototype.onUpdatedTab=function(a,b,c){return a===this.currTab?this.setCurrentTab(c):void 0},e.prototype.events={"click :not(.pnt-is-disabled)":"onCreatePointClick"},e.prototype.onCreatePointClick=function(a){return a.stopPropagation(),this.blacklisted?void 0:(d.extension.sendMessage({request:"open:newPoint",details:{active:!0,inject:{fromDD:!0}}}),window.close())},e}(a.View)})}.call(this),define("jade!templates/inboxPlaceholderTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push("<!-- -Templates for rendering inbox zero and inbox one states-->"),"inboxZero"===state?buf.push('<div class="pnt-h1 pnt-txt-align-c">Welcome to your<br>Point inbox.</div><div class="pnt-txt-align-c"><img src="../assets/point_example.png" width="239" style="margin-top: 0em;margin-bottom: -1.5em;"/></div><p class="pnt-m-top-2">When you send or receive a point,\nyou\'ll see it here.</p><div class="pnt-txt-align-c"><a id="send-first-point" href="#">Send your first point!</a></div><p class="pnt-m-top-1">Share this link with friends to get them on Point!</p><div class="referral-clipboard-wrapper"></div>'):"oneSent"===state?buf.push('<div class="pnt-h2">Share this link with friends to get them on Point!</div><div class="referral-clipboard-wrapper"></div>'):buf.push('<div class="pnt-txt-align-c"><a id="send-first-point" href="#">Send your first point.</a></div><div class="pnt-h2">Share this link with friends to get them on Point!</div><div class="referral-clipboard-wrapper"></div>');return buf.join("")}}),define("jade!templates/messageFlashTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{}){3==messageFlash.priority?priorityClass="":1==messageFlash.priority?priorityClass="mflash-is-error":2==messageFlash.priority&&(priorityClass="mflash-is-warning"),closeableClass=messageFlash.closeable?"mflash-is-closeable":"",alignClass=messageFlash.centered?"pnt-txt-align-c":"",klass=priorityClass+" "+closeableClass+" "+alignClass;var avatar_mixin=function(a,b){this.block,this.attributes||{},this.escaped||{},b=null==b?"pnt-avatar-m":b,buf.push("<div"+jade.attrs({"class":"pnt-avatar "+b},{"class":!0})+"><div"+jade.attrs({"data-src":a.url,"class":"pnt-avatar-placeholder"},{"data-src":!0})+">"+jade.escape(null==(jade.interp=a.initials)?"":jade.interp)+"</div></div>")};buf.push("<div"+jade.attrs({"class":"mflash-item pnt-is-hidden "+klass},{"class":!0})+">"),messageFlash.icon&&buf.push("<i"+jade.attrs({"class":"mflashitm-icn "+("pnticn-"+messageFlash.icon)},{"class":!0})+"></i>"),messageFlash.avatars&&(avatars=messageFlash.avatars,1==avatars.length?(buf.push('<div class="pnt-avatars">'),avatar_mixin(avatars[0],"pnt-avatar-l"),messageFlash.avatarIcon&&buf.push("<i"+jade.attrs({"class":"pnticnsmall pnticncircle "+("pnticn-"+messageFlash.avatarIcon)},{"class":!0})+"></i>"),buf.push("</div>")):2==avatars.length?(buf.push('<div class="pnt-avatars pnt-avatars-2">'),avatar_mixin(avatars[0]),avatar_mixin(avatars[1]),messageFlash.avatarIcon&&buf.push("<i"+jade.attrs({"class":"pnticnsmall pnticncircle "+("pnticn-"+messageFlash.avatarIcon)},{"class":!0})+"></i>"),buf.push("</div>")):3==avatars.length?(buf.push('<div class="pnt-avatars pnt-avatars-3">'),avatar_mixin(avatars[0]),avatar_mixin(avatars[1]),avatar_mixin(avatars[2]),messageFlash.avatarIcon&&buf.push("<i"+jade.attrs({"class":"pnticnsmall pnticncircle "+("pnticn-"+messageFlash.avatarIcon)},{"class":!0})+"></i>"),buf.push("</div>")):avatars.length>3&&(buf.push('<div class="pnt-avatars pnt-avatars-3">'),avatar_mixin(avatars[0]),avatar_mixin(avatars[1]),buf.push('<div class="pnt-avatar pnt-avatar-m"><div class="pnt-avatar-placeholder">'+jade.escape(null==(jade.interp="+"+(avatars.length-2))?"":jade.interp)+"</div></div>"),messageFlash.avatarIcon&&buf.push("<i"+jade.attrs({"class":"pnticnsmall pnticncircle "+("pnticn-"+messageFlash.avatarIcon)},{"class":!0})+"></i>"),buf.push("</div>"))),buf.push('<div class="mflashitm-text">'+jade.escape(null==(jade.interp=messageFlash.text)?"":jade.interp)+"</div>"),messageFlash.actions&&(buf.push('<div class="mflashitm-btns">'),function(){var a=messageFlash.actions;if("number"==typeof a.length)for(var b=0,c=a.length;c>b;b++){var d=a[b];buf.push("<div"+jade.attrs({"data-event":d.eventName,"class":"pnt-btn"},{"data-event":!0})+">"),d.icon&&buf.push("<i"+jade.attrs({"class":"pnticn-"+d.icon},{"class":!0})+"></i>"),buf.push(jade.escape(null==(jade.interp=d.label)?"":jade.interp)+"</div>")}else{var c=0;for(var b in a)if(c++,a.hasOwnProperty(b)){var d=a[b];buf.push("<div"+jade.attrs({"data-event":d.eventName,"class":"pnt-btn"},{"data-event":!0})+">"),d.icon&&buf.push("<i"+jade.attrs({"class":"pnticn-"+d.icon},{"class":!0})+"></i>"),buf.push(jade.escape(null==(jade.interp=d.label)?"":jade.interp)+"</div>")}}}.call(this),buf.push("</div>")),buf.push("</div>")}return buf.join("")}}),function(a){a.fn.onCssAnimationEnd=function(){var b="transitionend oTransitionEnd MSTransitionEnd webkitTransitionEnd",c=Array.prototype.slice.call(arguments,0);return c.unshift(b),a.fn.one.apply(this,c)}}($),define("jqCSSAnim",["jquery"],function(a){return function(){var b;return b||a.jqCSSAnim}}(this)),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/messageFlashView",["jquery","backbone","jade!templates/messageFlashTemplate","cs!common/modules/helpers","jqCSSAnim"],function(a,c,d,e){var f,g,h;return g=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.defaults={text:"",priority:3,closeable:!0,duration:null,actions:null,icon:null,avatars:null,centered:!1},c.prototype.set=function(a){return null!=a.actions&&_.isArray(a.actions)&&(a.closeable=!1),null!=a.duration&&_.isNumber(a.duration)&&(a.closeable=!1),c.__super__.set.call(this,a,{validate:!1})
},c.prototype.validate=function(){return"valid"},c}(c.Model),f=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.model=g,c.prototype.comparator="priority",c}(c.Collection),h=function(g){function h(){var a=this;return this.onCollectionAdd=function(){return h.prototype.onCollectionAdd.apply(a,arguments)},this.onCollectionReset=function(){return h.prototype.onCollectionReset.apply(a,arguments)},h.__super__.constructor.apply(this,arguments)}return b(h,g),h.prototype.className="message-flash-list",h.prototype.initialize=function(){return this.collection=new f,this.listenToOnce(this.collection,"reset",this.onCollectionReset),this.listenTo(this.collection,"add",this.onCollectionAdd)},h.prototype.onCollectionReset=function(){return this.collection.each(this.onCollectionAdd)},h.prototype.onCollectionAdd=function(b){var c,f;return c=a(d({messageFlash:b.toJSON()})),c.attr("data-model-id",b.cid),e.fetchAvatars(c),f=this.collection.at(this.collection.indexOf(b)-1),null!=f?this.$(".mflash-item[data-model-id='"+f.cid+"']").after(c):this.$el.prepend(c),_.defer(function(){return c.removeClass("pnt-is-hidden")})},h.prototype.events={"click .mflash-item.mflash-is-closeable":"hideItem","click .pnt-btn":"onActionButtonClick"},h.prototype.hideItem=function(b,c){var d,e,f;return null==c&&(c=!1),d=a(b.target),e=d.closest(".mflash-item"),e.onCssAnimationEnd(function(){return e.remove()}).addClass("pnt-is-hidden"),f=this.collection.remove(e.attr("data-model-id")),c?this.trackEvent("Notification Action",{Label:d.text(),"Notification Text":f.get("text")}):this.trackEvent("Notification Cleared",{"Notification Text":f.get("text")})},h.prototype.onActionButtonClick=function(b){var d;return d=a(b.target).closest(".pnt-btn"),c.trigger("messageFlash:"+d.attr("data-event")),this.hideItem(b,!0,d.text())},h}(c.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/inviteModel",["backbone","common.config","cs!common/modules/helpers"],function(a,c,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.defaults=function(){return{uid:c.user.id,sender:c.user.simple()}},e.prototype.idAttribute="_id",e.prototype.urlRoot=c.baseURL+"invites",e.prototype.initialize=function(a){var b;return null==a&&(a={}),(null!=(b=this.point=a.point)?b.id:void 0)?this.set("_pid",this.point.id):void 0},e.prototype.setCurrentPage=function(){return this.set({url:document.URL,page:{site:d.getSiteName(),domain:document.location.host,title:document.title,description:d.getDescription(),image:d.getPageImage()},sender:c.user.simple()})},e}(a.Model)})}.call(this),define("jade!common/templates/referralClipboardTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<div data-js-clipboard="data-js-clipboard" class="pnt-referral-clipboard"><input type="text" readonly="readonly" class="pnt-form pnt-form-input"/><i class="pnticn-clipboard"></i><i class="pnticn-clipboard-check"></i></div>');return buf.join("")}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/views/referralClipboardView",["common.config","backbone","cs!common/models/inviteModel","jade!common/templates/referralClipboardTemplate"],function(a,c,d,e){var f;return f=function(c){function f(){var a=this;return this.onCopyInviteLinkClick=function(){return f.prototype.onCopyInviteLinkClick.apply(a,arguments)},this.fetchInviteLink=function(){return f.prototype.fetchInviteLink.apply(a,arguments)},this.createInvite=function(){return f.prototype.createInvite.apply(a,arguments)},f.__super__.constructor.apply(this,arguments)}return b(f,c),f.prototype.initialize=function(a){if(null==a||null==a.el||null==a.from)throw"Not initialized properly, must provide `el` and `from`";return this.$el.html(e()),this.$trackFrom=a.from,this.$input=this.$("input"),null!=localStorage.inviteUrl?this.$input.val(localStorage.inviteUrl):(this.$input.val("http://getpoint.co"),this.createInvite())},f.prototype.createInvite=function(){return(new d).save({},{success:this.fetchInviteLink})},f.prototype.fetchInviteLink=function(a){var b=this;if(null!=a.id)return $.get("http://www.getpoint.co/invite/link/"+a.id,function(a){return(null!=a?a.length:void 0)<30?(b.$input.val(a),localStorage.inviteUrl=a):void 0})},f.prototype.events={click:"onCopyInviteLinkClick"},f.prototype.track={click:{name:"Copy Invite Link",data:function(){return{from:this.$trackFrom}}}},f.prototype.onCopyInviteLinkClick=function(){return this.trigger("copyInviteClicked"),this.$input.select(),document.execCommand("copy"),this.$(".pnt-referral-clipboard").addClass("pnt-referral-clipboard-is-copied"),a.views.tooltip.show({innerHtml:"                    <i class='pnticn-check pnticn-space-r'></i>                    Copied to Clipboard                    ",div:this.$el,preferDirection:"bottom",offset:{x:0,y:5},duration:1e3,enterAnimation:{name:"fadeInTop"},exitAnimation:{name:"fadeOut"}})},f}(c.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/inboxPointsView",["backbone","common.config","cs!common/browser/browser","cs!common/modules/notificationManifest","cs!views/PointsView","cs!views/pointFromDDView","cs!common/collections/pointCollection","jade!templates/inboxPlaceholderTemplate","cs!views/messageFlashView","cs!common/views/referralClipboardView"],function(a,c,d,e,f,g,h,i,j,k){var l;return l=function(d){function f(){var a=this;return this.renderInboxPlaceholder=function(){return f.prototype.renderInboxPlaceholder.apply(a,arguments)},this.parseNotifications=function(){return f.prototype.parseNotifications.apply(a,arguments)},this.onFirstSync=function(){return f.prototype.onFirstSync.apply(a,arguments)},f.__super__.constructor.apply(this,arguments)}return b(f,d),f.prototype.infiniteScroll=!0,f.prototype.initialize=function(a){return this.collection=new h,this.listenToOnce(this.collection,"sync",this.onFirstSync),f.__super__.initialize.call(this,a),this.renderNotifications(),this.renderPointFromDD()},f.prototype.track={"click .point-list-item":{name:"Clicked Point Item",data:{list:"inbox"}}},f.prototype.onFirstSync=function(a){var b,d;return a.length<2?(b=a.length?c.user.get("pnts_sent")?"oneSent":"oneReceived":"inboxZero",this.renderInboxPlaceholder(b)):(b=null!=(d=c.DEV)?d.inboxPlaceholder:void 0)?(a="inboxZero"===b?new h:new h(a.first()),this.empty(),this.renderInboxPlaceholder(b),this.renderPoints(a)):void 0},f.prototype.renderNotifications=function(){return this.messageFlashView=new j,this.messageFlashView.$el.prependTo(this.$page),this.listenTo(this.messageFlashView.collection,"remove",function(a){var b,d;return b=null!=(d=a.get("ids"))?d:a.id,c.notifications.requestRemoval(b)}),c.notifications.length?this.parseNotifications():this.listenToOnce(c.notifications,"reset",this.parseNotifications)},f.prototype.parseNotifications=function(){var a=this;return c.notifications.bundle().forEach(function(b){return"friends:request"!==b.type?(b=e.get(b),b?a.messageFlashView.collection.add(b):void 0):void 0})},f.prototype.loadNextPage=function(){return this.collection.fetchMore(),c.router.navigate("inbox")},f.prototype.renderInboxPlaceholder=function(a){var b,c;return c=i({state:a}),b=$("<div></div>").css("padding","30px 40px").html(c).appendTo(this.$page),this.referralClipboardView=new k({el:b.find(".referral-clipboard-wrapper"),from:"Inbox"}),_.extend(this.events,{"click #send-first-point":"onSendFirstPointClick"}),this.delegateEvents()},f.prototype.onSendFirstPointClick=function(){return a.trigger("openFirstPointPage"),!1},f.prototype.renderPointFromDD=function(){},f}(f)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/unreadPointsView",["backbone","common.config","cs!common/browser/browser","cs!views/PointsView","cs!views/pointFromDDView","cs!common/collections/pointCollection"],function(a,c,d,e,f,g){var h;return h=function(a){function d(){var a=this;return this.onPointsSync=function(){return d.prototype.onPointsSync.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.infiniteScroll=!0,d.prototype.initialize=function(a){return this.collection=new g([],{url:c.baseURL+"points/filter/unread"}),d.__super__.initialize.call(this,a),this.$placeholder=$("<div></div>").css("padding","50px 0px").html('<div class="pnt-h2 pnt-txt-align-c">\n    You\'re all caught up.\n</div>').hide().appendTo(this.$page),this.listenTo(this.collection,"sync",this.onPointsSync)},d.prototype.track={"click .point-list-item":{name:"Clicked Point Item",data:{list:"inbox"}}},d.prototype.onPointsSync=function(){return this.collection.length?this.$placeholder.hide():this.$placeholder.show()},d.prototype.loadNextPage=function(){return this.collection.fetchMore(),c.router.navigate("inbox/new")},d}(e)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/searchPointsView",["backbone","common.config","cs!common/browser/browser","cs!views/PointsView","cs!collections/searchablePointCollection"],function(a,c,d,e,f){var g;return g=function(a){function c(){var a=this;return this.renderPoints=function(b,d){return null==d&&(d={}),c.prototype.renderPoints.apply(a,arguments)},c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.infiniteScroll=!0,c.prototype.initialize=function(a){return null==a&&(a={}),this.collection=new f,c.__super__.initialize.call(this,a)},c.prototype.track={"click .point-list-item":{name:"Clicked Point Item",data:{list:"inbox"}}},c.prototype.clearSearch=function(){return this.searchOmniboxView.clearSearch(),this.collection.reset([])},c.prototype.focusSearchBar=function(){return this.searchOmniboxView.focusInput()},c.prototype.searchBy=function(a){if("string"==typeof a)try{a=decodeURIComponent(a),a=JSON.parse(a)}catch(b){a={term:"",users:[],isEmpty:!0}}return this.collection.fetchWithFilter(a.term,a.users)},c.prototype.renderPoints=function(a,b){var c;return null==b&&(b={}),null!=(c=this.$page)&&c.parent().scrollTop(0),this.empty(),b.xhr?this.collection.length?this.collection.each(this.renderPoint):this.$list.html('<h1 style="font-size: 1.7em; padding: 57px 65px; line-height: 1.2em; text-align: center; font-weight: 100; ">No results for that search term.</h1><svg version="1.1" style="position: absolute; left: 50%; margin-left: -150px; width: 300px; bottom: 0;" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1080 1080" enable-background="new 0 0 1080 1080" xml:space="preserve"> <g> <defs> <rect id="SVGID_1_" x="0" y="0" width="1080" height="1080"/> </defs> <clipPath id="SVGID_2_"> <use xlink:href="#SVGID_1_"  overflow="visible"/> </clipPath> <rect x="0" y="0" display="none" clip-path="url(#SVGID_2_)" fill="#D35A29" stroke="#000000" stroke-miterlimit="10" width="1080" height="1080"/> <g clip-path="url(#SVGID_2_)"> <g> <path fill="#F5DED4" stroke="#D6C2BD" stroke-width="4" stroke-miterlimit="10" d="M1410.143,1314.173 c-0.419-0.291-0.847-0.557-1.284-0.797c-2.991-1.646-4.114-5.375-2.519-8.393l7.549-14.287c3.741-7.08,1.034-15.854-6.046-19.595 c-7.079-3.743-15.854-1.034-19.595,6.046l-36.427,68.933c-0.38,0.719-0.897,1.357-1.521,1.878l-0.158,0.132 c-4.437,3.705-11.139-0.085-10.183-5.785c2.192-13.072,0.34-20.09-2.074-24.916c-12.641-25.272-35.428-39.835-58.065-37.104 c-7.951,0.96-13.617,8.184-12.658,16.134c0.96,7.951,8.194,13.624,16.133,12.657c9.817-1.182,20.905,6.768,27.941,19.908 c0.455,0.85,0.702,1.799,0.715,2.763c0.045,3.303-0.83,11.695-7.598,29.675c-0.559,1.484-1.656,2.72-3.081,3.414 c-9.892,4.817-20.832,11.382-30.847,18.155c-3.754,2.539-8.841,0.319-9.646-4.14c-1.391-7.711-1.529-15.315-1.656-22.538 c-0.018-1.025-0.036-2.032-0.057-3.024c-0.022-1.046,0.214-2.076,0.694-3.006l11.537-22.343c4.18-8.097,1.006-18.05-7.091-22.231 c-8.099-4.183-18.052-1.007-22.232,7.091l-14.268,27.633c-1.358,2.629-1.983,5.575-1.811,8.529 c0.134,2.298,0.183,5.034,0.231,7.932c0.257,14.573,0.643,36.316,13.036,58.021c0.608,1.065,0.913,2.277,0.842,3.501 l-1.902,33.013c-0.085,1.476-0.688,2.877-1.709,3.947c-8.695,9.12-30.445,30.478-43.431,49.217 c-0.452,0.652-1.016,1.21-1.677,1.649l-201.529,42.433c-3.758,2.492-8.838,0.309-9.616-4.132l-66.721-380.747l-86.062,26.561 l100.846,435.568c1.824,10.198,8.779,18.734,18.398,22.577c3.597,1.438,7.374,2.143,11.131,2.143 c6.295,0,12.532-1.98,17.761-5.82l264.449-99.801c0.564-0.414,1.05-0.913,1.446-1.49c4.191-6.092,29.335-42.552,35.42-49.263 c0.08-0.088,0.153-0.172,0.227-0.265l22.795-28.369c0.588-0.731,1.334-1.316,2.182-1.719c1.477-0.704,2.86-1.665,4.073-2.9 l65.688-66.828c0.82-0.834,1.568-1.736,2.235-2.696l39.756-57.136C1418.339,1327.784,1416.718,1318.747,1410.143,1314.173z"/> <g> <circle fill="#D6C2BD" cx="959.367" cy="1641.989" r="30.035"/> <circle fill="#F5DED4" cx="961.354" cy="1639.543" r="29.051"/> </g> </g> <path fill="#565554" d="M816.777,1706.136c0,11.046-8.954,20-20,20h-442c-11.045,0-20-8.954-20-20v-718c0-11.046,8.955-20,20-20 l135.182-22c0,0,25.762,9.668,85.129,9.668s92.952-9.668,92.952-9.668l128.737,20c11.046,0,20,8.954,20,20V1706.136z"/> <g> <path fill="#F5DED4" d="M828.751,470.278c-6.967-36.323-42.061-60.121-78.384-53.154c-36.323,6.967-60.121,42.06-53.153,78.383 c0.195,1.02,0.416,2.026,0.654,3.025c-22.051,14.425-34.395,41.2-29.125,68.683c6.969,36.322,42.061,60.12,78.385,53.153 c36.322-6.966,60.122-42.058,53.154-78.383c-0.195-1.018-0.415-2.026-0.654-3.026 C821.679,524.535,834.023,497.76,828.751,470.278z"/> <path fill="#F5DED4" d="M326.573,510.088c-0.353-36.983,29.342-67.251,66.324-67.604c36.983-0.355,67.251,29.339,67.606,66.323 c0.009,1.038-0.009,2.069-0.046,3.096c24.469,9.78,41.863,33.585,42.13,61.566c0.355,36.982-29.341,67.25-66.325,67.604 c-36.982,0.353-67.25-29.34-67.604-66.324c-0.009-1.038,0.008-2.07,0.045-3.097C344.234,561.874,326.843,538.069,326.573,510.088 z"/> <path fill="#F5DED4" d="M723.722,683.152c-67.916,110.837-70.598,317.136-70.598,317.136l-146.193,0.005 c-5.765-40.932-3.535-86.629-11.829-124.3c-22.782-103.476-59.516-184.119-59.491-184.089L723.722,683.152z"/> <g> <path fill="#D6C2BD" d="M818.487,354.336c-12.585-104.176-134.352-175.15-271.975-158.524 c-137.623,16.627-238.984,114.558-226.4,218.734c4.811,39.813,53.118,117.152,78.17,186.493 c25.052,69.342,21.562,128.58,42.754,156.482c23.15,30.479,92.723,12.505,92.723,12.505l11.549-0.385 c13.754,19.755,37.738,31.391,63.27,28.143c21.109-2.685,38.643-14.958,48.821-31.879l18.092-0.604 c10.786,2.385,46.081,1.533,71.585-19.855c18.021-15.11,18.839-143.632,23.496-182.096 C775.228,524.885,822.963,391.361,818.487,354.336z"/> <path fill="#F5DED4" d="M817.525,340.369c-12.585-104.176-85.577-225.346-265.394-212.952 C321.69,143.3,306.565,296.402,319.151,400.578c4.809,39.814,53.116,117.152,78.168,186.494 c25.052,69.341,22.182,137.559,43.373,165.46c23.15,30.48,92.102,3.527,92.102,3.527l11.551-0.386 c13.754,19.756,37.738,31.391,63.271,28.144c21.108-2.685,38.643-14.958,48.82-31.879l18.092-0.604 c10.785,2.386,23.43-7.686,48.934-29.074c18.019-15.111,35.504-134,40.161-172.466 C768.278,511.332,822.001,377.394,817.525,340.369z"/> </g> <path fill="#D6C2BD" d="M550.726,613.076l-5.766-3.603c-33.151,7.333-76.59,73.773-78.756,76.406l1.729,1.422 c0,0,29.938-37.045,43.96-49.533C526.474,624.78,550.726,613.076,550.726,613.076z"/> <path fill="#D6C2BD" d="M620.665,607.209l5.466-5.335c33.843,2.716,85.985,62.565,88.493,64.88l-1.518,1.644 c0,0-39.715-37.086-56.459-45.582C639.901,614.32,620.665,607.209,620.665,607.209z"/> <g> <path fill="#D6C2BD" d="M596.357,771.445c-36.761,2.533-62.635-21.19-67.922-57.036c-0.015,1.821,0.018,3.654,0.146,5.501 c2.661,38.608,36.113,67.75,74.725,65.089c38.607-2.661,67.748-36.115,65.088-74.725c-0.127-1.849-0.347-3.667-0.613-5.47 C667.464,741.037,633.117,768.912,596.357,771.445z"/> </g> <g> <path fill="#545554" d="M487.22,449.371c-15.755,1.234-29.532-10.537-30.767-26.297c-1.233-15.76,10.539-29.533,26.296-30.767 c15.761-1.235,29.532,10.537,30.768,26.295C514.751,434.36,502.979,448.135,487.22,449.371z"/> <circle fill="#FFFFFF" cx="492.275" cy="424.321" r="11.67"/> </g> <path fill="#FFFFFF" d="M402.655,368.858c0,0,87.862-24.769,140.197-15.111l-1.599-23.192l-13.914,0.959l-3.863-9.381 l-6.658,6.488l-13.665-5.086l0.497,7.199l-16.048-6.128l-10.566,11.581l-11.824-4.01l-5.554,8.824l-12.86-13.583l-5.342,10.014 l-16.12,7.141l0.414,6l-11.772,8.048L402.655,368.858z"/> <path fill="#FFFFFF" d="M526.381,605.242c0,0-14.781,15.969-22.431,22.932c-7.647,6.962-23.333,9.962-23.333,9.962 s59.524,7.929,101.919,5.008c42.393-2.922,105.664-18.219,105.664-18.219s-17.035-1.957-24.905-7.5 c-7.87-5.543-23.766-19.982-23.766-19.982L526.381,605.242z"/> <path fill="#FFFFFF" d="M758.298,351.261c0,0-91.229,3.256-138.113,28.439l-5.561-22.573l13.541-3.337l0.812-10.112l8.322,4.143 l11.457-9.017l1.727,7.008l13.409-10.736l13.599,7.798l10.033-7.429l7.984,6.706l8.098-16.862l8.143,7.904l17.533,1.874 l1.439,5.839l13.667,4.068L758.298,351.261z"/> <g> <path fill="none" stroke="#5B534B" stroke-width="8" stroke-miterlimit="10" d="M560.973,509.336 c0.279,1.663-0.843,3.241-2.505,3.523l-160.549,27.098c-1.668,0.282-3.242-0.843-3.526-2.505l-37.669-168.07 c-0.282-1.664,0.84-3.244,2.506-3.524c0,0,9.213-9.724,73.642-23.115c64.431-13.392,95.952-5.51,95.952-5.51 c1.668-0.282,3.243,0.843,3.525,2.509L560.973,509.336z"/> <path fill="none" stroke="#5B534B" stroke-width="8" stroke-miterlimit="10" d="M593.364,507.088 c-0.047,1.686,1.283,3.095,2.969,3.145l162.752,4.668c1.689,0.05,3.096-1.28,3.146-2.967l14.102-171.662 c0.049-1.686-1.279-3.095-2.967-3.146c0,0-10.473-8.355-76.129-12.723c-65.663-4.37-95.797,7.789-95.797,7.789 c-1.687-0.049-3.096,1.284-3.146,2.973L593.364,507.088z"/> <polyline fill="none" stroke="#5B534B" stroke-width="8" stroke-miterlimit="10" points="540,385.074 568.044,376.658 596.979,381.123 				"/> </g> <g> <circle fill="#D6C2BD" cx="580.327" cy="544.387" r="83.491"/> <path fill="#F5DED4" d="M650.548,523.509c3.171,46.002-31.551,85.863-77.554,89.034c-46.003,3.171-73.892-32.375-77.062-78.378 c-3.169-46.002,30.45-101.825,76.452-104.996C618.386,426,647.378,477.506,650.548,523.509z"/> </g> <g> <path fill="#D6C2BD" d="M557.057,317.708c-65.134-15.998-117.755,7.856-118.278,8.097l0,0 c1.467-0.681,22.611-16.853,57.934-19.236C514.736,305.349,539.405,310.368,557.057,317.708L557.057,317.708z"/> <path fill="#D6C2BD" d="M591.696,315.322L591.696,315.322c21.507-8.556,39.637-17.334,57.277-17.782 c35.066-0.892,59.442,9.1,60.994,9.575l0,0C709.414,306.947,653.921,290.574,591.696,315.322z"/> <path fill="#D6C2BD" d="M570.273,286.44c-54.362,3.747-134.994-3.645-135.797-3.66l0.522-0.035 c0.802,0.015,80.766,1.439,134.863-2.291c54.161-3.733,137.432-13.44,138.268-13.536l0,0 C707.291,267.014,624.578,282.697,570.273,286.44z"/> </g> <g> <circle fill="#FFFFFF" cx="329.284" cy="253.263" r="20.999"/> <circle fill="#FFFFFF" cx="339.044" cy="264.014" r="20.999"/> <circle fill="#FFFFFF" cx="318.755" cy="275.038" r="20.999"/> <circle fill="#FFFFFF" cx="340.488" cy="284.963" r="20.999"/> <circle fill="#FFFFFF" cx="332.954" cy="306.532" r="20.999"/> <circle fill="#FFFFFF" cx="342.714" cy="317.261" r="20.999"/> <circle fill="#FFFFFF" cx="349.572" cy="242.239" r="20.999"/> <circle fill="#FFFFFF" cx="322.427" cy="328.306" r="20.999"/> <circle fill="#FFFFFF" cx="351.675" cy="272.768" r="20.999"/> </g> <g> <circle fill="#FFFFFF" cx="785.531" cy="221.815" r="21"/> <circle fill="#FFFFFF" cx="777.337" cy="233.804" r="20.999"/> <circle fill="#FFFFFF" cx="798.947" cy="241.94" r="20.999"/> <circle fill="#FFFFFF" cx="778.782" cy="254.753" r="20.999"/> <circle fill="#FFFFFF" cx="789.203" cy="275.085" r="21"/> <circle fill="#FFFFFF" cx="781.007" cy="287.052" r="20.999"/> <circle fill="#FFFFFF" cx="763.922" cy="213.68" r="20.999"/> <circle fill="#FFFFFF" cx="801.175" cy="274.259" r="20.999"/> <circle fill="#FFFFFF" cx="766.026" cy="244.21" r="20.999"/> </g> <path fill="#5B534B" d="M658.667,417.222c26.704-9.564,65.412-0.555,65.828-0.409l0.256-0.945 c-1.858-0.649-44.085-15.117-72.117-1.326c13.221-14.03,29.084-20.696,42.174-22.754c16.876-2.649,32.752-3.407,32.89-3.382 l0.116-0.76c-0.581-0.097-14.402-2.377-31.805,0.337c-23.231,3.626-41.577,14.591-53.055,31.71l-0.365,0.749l1.264,0.138 c0,0,67.018,3.864,78.271,14.252l1.148-0.75C713.766,425.307,675.83,419.466,658.667,417.222z"/> </g> <g> <path fill="#BCB2AA" d="M816.777,1710.136c0,11.046-8.954,20-20,20h-442c-11.045,0-20-8.954-20-20v-722c0-11.046,8.955-20,20-20 l135.182-22c0,0,30.762,52,90.129,52s87.952-52,87.952-52l128.737,20c11.046,0,20,8.954,20,20V1710.136z"/> <polygon fill="#BCB2AA" points="347.917,969.343 249.93,946.136 220.875,1072.994 388.839,1139.435 			"/> <polygon fill="#BCB2AA" points="809.435,969.343 919.429,1163.806 823.847,1196.77 768.513,1139.435 			"/> </g> <g> <path fill="#645B54" d="M786.368,1058.671c0-31.766,3.65-61.985,10.221-89.385l-81.085-16.753 c-31.196,77.876-114.366,209.631-139.089,209.631c-24.792,0-101.449-127.432-128.288-205.221l-96.095,15.025 c-1.475,0-2.906,0.166-4.291,0.464c6.105,26.56,9.481,55.684,9.481,86.238c0,51.294-11.505,106.569-27.497,144.413l-5,522.243 c0,11.214,9.093,18.305,20.307,18.305c0,0,143.837,7.258,238.15,6.575c94.312-0.683,228.615-7.575,228.615-7.575 c11.215,0,20.305-10.091,20.305-21.305l-12-521.765C798.595,1159.125,786.368,1119.192,786.368,1058.671z"/> <path fill="#81756B" d="M786.368,1052.671c0-31.766,3.65-61.985,10.221-89.385l-81.085-16.753 c-31.196,77.876-114.366,209.631-139.089,209.631c-24.792,0-101.449-127.432-128.288-205.221l-96.095,15.025 c-1.475,0-2.906,0.166-4.291,0.464c6.105,26.56,9.481,55.685,9.481,86.238c0,51.294-11.505,106.569-27.497,144.413l-5,522.243 c0,11.214,9.093,20.305,20.307,20.305h466.766c11.215,0,20.305-9.091,20.305-20.305l-12-525.765 C798.595,1153.125,786.368,1113.192,786.368,1052.671z"/> <path fill="#645B54" d="M581.261,1740.632c1.668-114.992,4.518-470.499-3.414-583.826c-0.846,0.232-1.644,0.358-2.388,0.358 v583.468H581.261z"/> <circle fill="#645B54" cx="625.007" cy="1250.658" r="8.262"/> <circle fill="#645B54" cx="625.007" cy="1402.15" r="8.262"/> <circle fill="#645B54" cx="625.007" cy="1553.642" r="8.262"/> </g> <g> <path fill="#F5DED4" stroke="#D6C2BD" stroke-width="4" stroke-miterlimit="10" d="M992.526,1908.649l-91.568-24.783 c-13.391-5.706-26.67-9.848-36.617-11.16c0,0-84.463,10.531-90.256,9.644l-386.584-69.43l141.522-35.237 c50.913-12.677,81.91-64.226,69.233-115.139c-5.349-21.478-18.964,4.992-35.183-12.554 c-22.225-24.043-191.928-45.594-191.928-45.594l-260.949,81.768c-50.913,12.677-81.909,64.226-69.232,115.139 c5.016,20.146,16.12,29.167,30.859,41.604c7.574,10.334,19.094,17.775,32.76,19.867l565.9,110.097 c30.33,10.698,68.791,17.434,82.256,19.209l75.584,42.345c26.006,3.426,93.758,22.226,108.59,13.957l22.619-0.35 c0.846,0.137,1.688,0.201,2.518,0.201c7.65,0,11.742-1.592,12.986-9.387c1.381-8.642-4.506-16.766-13.146-18.146l-16.59-3.07 l31.459-1.34c0.574,0.064,1.146,0.096,1.711,0.096c7.629,0,14.201-5.734,15.072-13.494c0.936-8.334-5.064-15.848-13.398-16.783 l-30.242-3.393l31.514-2.359c0.99,0.154,1.979,0.229,2.953,0.229c9.281,0,17.432-6.762,18.896-16.219 c1.619-10.449-5.541-20.233-15.99-21.85l-31.432-4.867l35.807,2.193c1.043,0.168,8.684-1.07,9.705-1.07 c9.221,0,9.42-1.393,10.951-10.787C1014.007,1917.549,1002.964,1910.35,992.526,1908.649z"/> <g> <path fill="#D6C2BD" d="M68.376,1752.465c-11.934-11.429-30.042-11.304-40.447,0.283c-10.404,11.584-9.162,30.239,2.773,41.667 c11.935,11.43,30.042,11.305,40.448-0.28C81.553,1782.55,80.31,1763.893,68.376,1752.465z"/> <path fill="#F5DED4" d="M73.96,1750.025c-11.541-11.053-29.058-10.932-39.121,0.274c-10.063,11.203-8.862,29.251,2.684,40.305 c11.545,11.056,29.059,10.936,39.121-0.271C86.708,1779.128,85.509,1761.083,73.96,1750.025z"/> </g> <path fill="#F5DED4" stroke="#D6C2BD" stroke-width="4" stroke-miterlimit="10" d="M1015.581,1701.591l-259.498-77.833 c0,0-215.885,3.3-228.562,54.213c-12.677,50.913,18.321,102.462,69.232,115.139l94.663,23.57l-376.049,55.301 c-10.523,1.34-85.861-8.311-85.861-8.311c-9.596,1.566-22.322,5.812-35.098,11.477l-99.687,19.194 c-10.056,1.937-16.568,11.081-14.545,20.426c1.823,8.411,9.935,14.116,18.875,13.76c0.992-0.04,1.992-0.155,2.998-0.347 l40.113-7.724l0.969,5.301l-30.295,5.602c-10.074,1.863-16.662,10.958-14.719,20.317c1.76,8.471,9.904,14.254,18.903,13.894 c0.943-0.037,1.897-0.143,2.854-0.319l29.472-5.45l1.161,6.36l-29.195,4.226c-8.046,1.166-13.592,8.173-12.385,15.651 c1.121,6.961,7.699,11.878,15.094,11.582c0.549-0.021,1.102-0.071,1.656-0.151l29.762-4.307l0.783,4.301l-18.533,3.511 c-8.325,1.578-13.739,9.13-12.093,16.869c1.487,6.979,8.214,11.726,15.63,11.432c0.805-0.031,1.619-0.123,2.432-0.278 l21.801-4.13c14.674,6.884,54.729-5.368,79.816-9.462l84.211-41.661c10.532-1.721,76.268-28.84,96.835-33.887 c165.966-16.312,603.183-59.504,603.183-59.504c14.805-1.384,50.291-43.466,55.309-63.62 C1097.49,1765.817,1066.494,1714.268,1015.581,1701.591z"/> <g> <path fill="#D6C2BD" d="M1045.29,1792.726c-4.822,15.805,3.451,31.913,18.484,35.979c15.029,4.066,31.123-5.452,35.945-21.256 c4.822-15.806-3.451-31.912-18.482-35.979C1066.206,1767.404,1050.112,1776.922,1045.29,1792.726z"/> <path fill="#F5DED4" d="M1040.595,1788.841c-4.664,15.285,3.34,30.867,17.879,34.799c14.537,3.933,30.105-5.274,34.769-20.561 c4.665-15.29-3.337-30.87-17.876-34.802C1060.827,1764.345,1045.261,1773.55,1040.595,1788.841z"/> </g> </g> <path fill="#81756B" d="M203.626,1656.054c0,0,157.172-68.749,216.086,151.92l129.658-22.331l110.256,27 c0,0,111.244-167.138,223.244-150l-52.646-64l-253.689,32.194l-253.688-37.798L203.626,1656.054z"/> <polygon fill="#645B54" points="582.977,1636.669 849.898,1620.11 832.757,1599.272 573.806,1614.669 325.38,1593.669 272.49,1617.787 278.149,1615.669 		"/> <path fill="#D6C2BD" d="M398.384,1815.006c-2.291-0.7-60.402-14.436-86.938-39.023l1.797-1.336 c24.872,23.046,93.524,34.631,94.064,34.796L398.384,1815.006z"/> <path fill="#D6C2BD" d="M681.606,1817.931l-8.288-5.916c0.559-0.073,67.844-1.089,96.186-19.642l0.889,1.969 C740.124,1814.155,683.981,1817.624,681.606,1817.931z"/> <g> <defs> <path id="SVGID_3_" d="M588.384,708.672c-78.481,4.432-99.557-37.394-99.557-37.394s75.041,3.953,97.598,2.68 c20.743-1.171,97.74-14.356,97.74-14.356S666.864,704.243,588.384,708.672z"/> </defs> <clipPath id="SVGID_4_"> <use xlink:href="#SVGID_3_"  overflow="visible"/> </clipPath> <path clip-path="url(#SVGID_4_)" fill="#545554" d="M711.288,695.63c0,0-28.193,40.599-120.5,45.809 c-92.304,5.211-126.193-31.882-126.193-31.882l-1.727-30.607c0,0,97.065-1.066,123.594-2.565 c24.396-1.377,123.131-10.822,123.131-10.822L711.288,695.63z"/> <g clip-path="url(#SVGID_4_)"> <path fill="#FFFFFF" d="M588.223,679.371c0.245,4.326-3.065,8.031-7.389,8.275l-12.474,0.704 c-4.325,0.244-8.031-3.063-8.275-7.391l-2.063-36.541c-0.244-4.324,3.065-8.027,7.392-8.271l12.473-0.704 c4.323-0.244,8.029,3.063,8.272,7.388L588.223,679.371z"/> <path fill="#FFFFFF" d="M617.308,677.729c0.244,4.326-3.062,8.031-7.391,8.275l-12.471,0.703 c-4.325,0.244-8.031-3.065-8.275-7.391l-2.062-36.539c-0.244-4.325,3.066-8.029,7.391-8.273l12.471-0.703 c4.328-0.244,8.031,3.062,8.275,7.388L617.308,677.729z"/> <path fill="#FFFFFF" d="M645.909,673.441c0.572,4.296-2.188,8.206-6.16,8.733l-11.453,1.525 c-3.973,0.527-7.658-2.525-8.229-6.818l-4.827-36.279c-0.571-4.295,2.188-8.203,6.159-8.73l11.455-1.523 c3.973-0.531,7.658,2.52,8.228,6.816L645.909,673.441z"/> <path fill="#FFFFFF" d="M673.371,667.787c0.571,4.296-2.187,8.206-6.16,8.733l-11.454,1.526 c-3.973,0.528-7.656-2.526-8.227-6.821l-4.827-36.275c-0.571-4.297,2.186-8.204,6.159-8.732l11.453-1.525 c3.974-0.528,7.659,2.523,8.229,6.819L673.371,667.787z"/> <path fill="#FFFFFF" d="M694.596,661.142c0.573,4.298-1.486,8.114-4.593,8.526l-8.964,1.195 c-3.11,0.414-6.094-2.734-6.665-7.029l-4.827-36.277c-0.573-4.294,1.485-8.109,4.595-8.523l8.964-1.192 c3.108-0.417,6.094,2.73,6.665,7.028L694.596,661.142z"/> <path fill="#FFFFFF" d="M531.588,679.895c-0.086,4.332,3.096,7.907,7.102,7.984l11.554,0.227 c4.008,0.077,7.325-3.371,7.411-7.702l0.713-36.591c0.084-4.332-3.096-7.905-7.102-7.982l-11.556-0.225 c-4.007-0.08-7.324,3.366-7.408,7.7L531.588,679.895z"/> <path fill="#FFFFFF" d="M503.664,677.367c-0.087,4.334,3.097,7.908,7.104,7.984l11.553,0.229 c4.007,0.077,7.323-3.372,7.407-7.704l0.715-36.589c0.084-4.334-3.096-7.905-7.102-7.983l-11.553-0.227 c-4.009-0.078-7.327,3.369-7.411,7.702L503.664,677.367z"/> <path fill="#FFFFFF" d="M481.826,673.153c-0.087,4.336,2.39,7.896,5.523,7.955l9.043,0.179c3.134,0.061,5.746-3.401,5.83-7.734 l0.714-36.589c0.085-4.332-2.389-7.891-5.526-7.951l-9.039-0.176c-3.136-0.066-5.748,3.397-5.834,7.731L481.826,673.153z"/> </g> </g> </g> <g clip-path="url(#SVGID_2_)"> <g> <path fill="none" d="M507.883,590.77c0.638-0.146,1.251-0.293,1.847-0.441C509.116,590.48,508.501,590.628,507.883,590.77z"/> <path fill="none" d="M505.346,591.319c-0.172,0.036-0.345,0.069-0.517,0.104C504.999,591.39,505.173,591.354,505.346,591.319z"/> <path fill="none" d="M507.883,590.77c-0.623,0.143-1.246,0.279-1.869,0.411C506.621,591.054,507.242,590.917,507.883,590.77z"/> <path fill="none" d="M510.855,590.042c-0.119,0.03-0.238,0.062-0.357,0.092C510.618,590.104,510.738,590.073,510.855,590.042z"/> <path fill="none" d="M462.204,391.687c-48.216,11.063-78.335,59.119-67.272,107.335c8.951,39.011,42.118,66.17,79.993,69.261 c8.938,0.729,18.136,0.123,27.342-1.989s17.749-5.577,25.474-10.129c32.739-19.293,50.749-58.195,41.798-97.206 C558.476,410.743,510.421,380.624,462.204,391.687z"/> <path fill="#6D645D" d="M456.588,367.211c-61.734,14.165-100.297,75.693-86.132,137.427 c11.68,50.905,55.564,86.048,105.213,88.872c1.816,0.103,3.64,0.16,5.47,0.177l32.648,165.953 c3.954,17.232,19.219,19.675,36.45,15.722c17.231-3.954,29.904-12.808,25.95-30.039l-43.446-163.346 c1.806-0.884,3.583-1.813,5.329-2.784c43.451-24.186,67.625-74.945,55.946-125.849 C579.85,391.609,518.322,353.047,456.588,367.211z M506.014,591.181c0.623-0.132,1.246-0.268,1.869-0.411 c0.618-0.142,1.233-0.29,1.847-0.441c-0.595,0.148-1.209,0.295-1.847,0.441C507.242,590.917,506.621,591.054,506.014,591.181z M504.829,591.423c0.172-0.035,0.345-0.069,0.517-0.104C505.173,591.354,504.999,591.39,504.829,591.423z M510.499,590.134 c0.119-0.03,0.238-0.062,0.357-0.092C510.738,590.073,510.618,590.104,510.499,590.134z M527.741,556.165 c-7.726,4.553-16.269,8.017-25.474,10.129s-18.404,2.719-27.342,1.989c-37.875-3.091-71.042-30.25-79.993-69.261 c-11.063-48.216,19.056-96.272,67.272-107.335c48.216-11.063,96.272,19.056,107.335,67.272 C578.49,497.97,560.48,536.872,527.741,556.165z"/> </g> <g opacity="0.81"> <path fill="#EEF2F4" d="M462.443,392.727c-48.216,11.063-78.335,59.119-67.272,107.335c8.951,39.011,42.118,66.17,79.993,69.261 c8.938,0.729,18.136,0.123,27.342-1.989s17.749-5.577,25.474-10.129c32.739-19.293,50.749-58.195,41.798-97.206 C558.715,411.783,510.659,381.664,462.443,392.727z"/> <path opacity="0.2" fill="#EEF2F4" d="M527.98,557.205c-7.726,4.553-16.269,8.017-25.474,10.129s-18.404,2.719-27.342,1.989 c-37.875-3.091-71.042-30.25-79.993-69.261c-11.063-48.216,19.056-96.272,67.272-107.335 c48.216-11.063,96.272,19.056,107.335,67.272C578.729,499.01,560.719,537.912,527.98,557.205z"/> </g> </g> <g clip-path="url(#SVGID_2_)"> <path fill="#D6C2BD" d="M112.615,928.24c7.166,13.162,3.328,29.944-8.846,38.682c-14.208,10.199-33.842,6.184-42.999-8.402 c-8.816-14.049-4.578-32.586,9.473-41.405C84.828,907.96,104.252,912.88,112.615,928.24z"/> <path fill="#F5DED4" d="M112.801,924.662c8.855,14.107,4.097,32.897-10.761,40.986c-12.731,6.931-28.963,3.218-37.416-8.558 c-9.865-13.744-5.984-32.734,8.126-41.59C86.34,906.971,104.27,911.072,112.801,924.662z"/> </g> <path clip-path="url(#SVGID_2_)" fill="#F5DED4" d="M608.309,781.16c-2.212-6.357-9.192-9.638-15.484-7.324l-18.545,6.83 l-2.209-4.938l26.004-11.532c5.806-2.575,8.426-9.369,5.851-15.175c-2.576-5.806-9.369-8.425-15.175-5.851l-26.073,11.563 l-2.515-5.62l26.828-11.261c7.2-3.022,11.073-11.157,8.391-18.491c-2.862-7.829-11.641-11.595-19.237-8.408l-27.828,11.681 l-1.865-4.168l29.163-11.995c7.221-2.97,11.152-11.075,8.526-18.428c-2.804-7.85-11.557-11.684-19.177-8.549l-73.419,30.198 c-10.901,1.634-21.109,4.235-28.044,7.338l-41.337,48.648c-8.118,3.631-30.388,16.461-49.431,29.153L79.101,924.052v38 l144.759,97.908l24.605-107.426l-24.365-9.725l172.39-87.695c22.275-5.608,46.136-14.182,53.652-17.545l73.878-7.749 c16.084-7.197,42.772-15.064,52.984-24.58l23.745-8.745C606.949,794.211,610.48,787.401,608.309,781.16z"/> </g> </svg>'):void 0
},c.prototype.loadNextPage=function(){return this.collection.fetchMore()},c}(e)})}.call(this),define("jade!templates/inboxTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<div class="inbox-top-bar"><div class="inbox-top-bar-search-send-row"><div class="inbox-top-bar-search-wrapper"><div data-js-search-icon="data-js-search-icon" class="inbox-top-bar-search-icon"><i class="pnticn-loupe_1x"></i></div><div style="width: 100%" class="inbox-top-bar-search-input"></div><div data-js-search-close="data-js-search-close" class="inbox-top-bar-search-close"><i class="pnticn-x_1x"></i></div></div><div class="point-send"><div class="point-send-label">Point Current Tab</div><div class="point-send-meta"><img src="" data-js-point-send-favicon="data-js-point-send-favicon" class="point-send-favicon"/><div data-js-point-send-url="data-js-point-send-url" class="point-send-url"></div><div data-js-point-send-title="data-js-point-send-title" class="point-send-title"></div></div></div></div><div class="inbox-top-bar-tabs"><div data-js-inbox-tab data-inbox-tab="new" class="inbox-top-bar-tab"><span>New</span><div class="inbox-top-bar-badge pnt-is-hidden">0</div></div><div data-js-inbox-tab data-inbox-tab="all" class="inbox-top-bar-tab is-active"><span>All</span></div></div></div><div class="inbox-page-container"></div>');return buf.join("")}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/InboxView",["common.config","cs!common/collections/pointCollection","cs!collections/searchablePointCollection","cs!views/pageView","cs!views/searchOmniboxView","cs!views/inboxPointsView","cs!views/unreadPointsView","cs!views/searchPointsView","cs!views/pointFromDDView","jade!templates/inboxTemplate"],function(a,c,d,e,f,g,h,i,j,k){var l,m,n;return n=function(a){return/(input|textarea)/i.test(a.tagName)||a.isContentEditable},m=function(a){return"number"==typeof a.which&&a.which>0?!a.ctrlKey&&!a.metaKey&&!a.altKey&&8!==a.which:!1},l=function(c){function e(){var a=this;return this.onKeyDown=function(){return e.prototype.onKeyDown.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,c),e.prototype.id="inbox-view",e.prototype.onRoute=function(a){var b;switch(b=a[0]){case"new":return this.showNewPointsView();case"search":return this.showSearchViewWith(a[1]);default:return this.showAllPointsView()}},e.prototype.initialize=function(b){var c;return window.inbox=this,b.template=k,e.__super__.initialize.call(this,b),this.$inboxContainer=this.$(".inbox-page-container"),this.inboxPointsView=new g({appendTo:this.$inboxContainer,hidden:!0}),this.newPointsView=new h({appendTo:this.$inboxContainer,hidden:!0}),c=new d,this.searchPointsView=new i({appendTo:this.$inboxContainer,collection:c,hidden:!0}),this.searchOmniboxView=new f({el:this.$(".inbox-top-bar-search-input"),searchCollection:c}),this.renderSearchParams=_.once(this.searchOmniboxView.renderSearchParams),this.pointFromDDView=new j({el:this.$(".point-send")}),this.listenTo(a.badges,"change:points",this.updateBadge),this.updateBadge(),$("body").on("keydown",this.onKeyDown)},e.prototype.setActiveTab=function(a){var b,c,d,e,f,g;for(d=["new","all"],g=[],e=0,f=d.length;f>e;e++)c=d[e],b=this.$("[data-inbox-tab="+c+"]"),a===c?g.push(b.addClass("is-active")):g.push(b.removeClass("is-active"));return g},e.prototype.events={"click [data-js-inbox-tab]":"onTabClick","click [data-js-search-icon]":"showSearchBar","click [data-js-search-close]":"onSearchCloseClick"},e.prototype.onTabClick=function(b){var c;switch(c=$(b.target).closest("[data-js-inbox-tab]"),c.attr("data-inbox-tab")){case"new":return a.router.navigate("inbox/new",{trigger:!0});case"all":return a.router.navigate("inbox",{trigger:!0})}},e.prototype.showSearchBar=function(){return this.$el.addClass("is-searching"),this.searchOmniboxView.ensureFocus()},e.prototype.onSearchCloseClick=function(){return this.$el.removeClass("is-searching"),this.searchOmniboxView.clearSearch()},e.prototype.onKeyDown=function(b){var c;if(/^inbox/.test(a.router.currentRoute))return c=b.target,!n(c)&&m(b)?this.showSearchBar():void 0},e.prototype.updateActiveView=function(a){var b;return this.activeView!==a?(null!=(b=this.activeView)&&b.hide(),a.show(),this.prevActiveView=this.activeView,this.activeView=a):void 0},e.prototype.showNewPointsView=function(){return this.setActiveTab("new"),this.updateActiveView(this.newPointsView),this.newPointsView.refresh()},e.prototype.showSearchViewWith=function(b){var c,d;return this.searchPointsView.searchBy(b)?(this.setActiveTab("search"),this.updateActiveView(this.searchPointsView),this.showSearchBar()):(c=this.activeView===this.searchPointsView?this.prevActiveView:this.activeView,d=c===this.newPointsView?"inbox/new":"inbox",a.router.navigate(d,{trigger:!0}))},e.prototype.showAllPointsView=function(){return this.setActiveTab("all"),this.updateActiveView(this.inboxPointsView),this.inboxPointsView.refresh()},e.prototype.updateBadge=function(){var b,c;return c=a.badges.get("points"),b=this.$(".inbox-top-bar-badge"),c?b.removeClass("pnt-is-hidden").text(Math.min(c,99)):b.addClass("pnt-is-hidden")},e}(e)})}.call(this),define("jade!templates/settingsTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{}){var checkbox_wrapper_mixin=function(a,b,c){this.block,this.attributes||{},this.escaped||{};var d={checked:c,type:"checkbox",name:a};d["data-js-"+a]=!0,buf.push("<div"+jade.attrs({"data-js-setting":!0,"data-setting":a,"class":"pnt-form-input-checkbox-wrapper pnt-m-top-1"},{"data-setting":!0})+"><!-- TODO: Use this line instead if we ever figure out--><!-- how to update jade:-->"+(null==(jade.interp="<input type='checkbox' class='pnt-form-input-checkbox-input' data-js-"+a+" id="+a+(c?" checked":"")+">")?"":jade.interp)+"<label"+jade.attrs({"for":a,"class":"pnt-form-input-checkbox-label"},{"for":!0})+">"+(null==(jade.interp=b)?"":jade.interp)+"</label></div>")};buf.push('<div class="grid-container"><div class="col-6"><div data-js-settings="data-js-settings"><div class="pnt-h2 pnt-m-top-p5">Settings</div>'),function(){var a=settings;if("number"==typeof a.length)for(var b=0,c=a.length;c>b;b++){var d=a[b];checkbox_wrapper_mixin(d.name,d.label,d.value)}else{var c=0;for(var b in a)if(c++,a.hasOwnProperty(b)){var d=a[b];checkbox_wrapper_mixin(d.name,d.label,d.value)}}}.call(this),buf.push('<div class="pnt-fb-is-connected"><div class="pnt-h2 pnt-txt-align-c"><i class="pnticn-check pnticngreen pnticnlarge pnticn-space-r pnt-is-hidden">Your Facebook account is currently connected.</i></div><div class="pnt-txt-align-c"><a data-js-settings-logout="data-js-settings-logout" class="pnt-btn pnt-btn-dd pnt-m-top-1">Logout of Point</a></div></div><div class="pnt-fb-is-expired pnt-is-hidden"><div class="pnt-h2 pnt-m-top-1"><i class="pnticn-warning pnticn pnticnlarge pnticn-space-r"></i>Your friend list is out of sync with your Facebook\nfriends. Login to re-sync friends.</div><div class="pnt-clear pnt-txt-align-c"><a data-js-settings-login="data-js-settings-login" class="pnt-btn pnt-btn-dd pnt-m-top-1 pnt-btn-facebook"><i class="pnticn-facebook_fill"></i>Login with Facebook</a></div><div class="pnt-clear pnt-txt-align-c"><a data-js-settings-logout="data-js-settings-logout" class="pnt-btn pnt-btn-dd pnt-m-top-1">Logout of Point</a></div></div><div class="pnt-clear pnt-txt-align-c"><a data-js-settings-restart="data-js-settings-restart" class="pnt-btn pnt-btn-dd pnt-m-top-1">Restart Point</a></div><div class="pnt-txt-align-c"><div data-js-need-support="data-js-need-support" class="pnt-btn pnt-btn-cta pnt-btn-dd pnt-m-top-1">Contact Support</div></div></div></div><div class="col-6"><div data-js-profile="data-js-profile"><div class="pnt-m-top-1 pnt-hrule"></div><div class="pnt-h2 pnt-m-top-p5">Profile</div><form class="pnt-form profile-page"><div class="pnt-form-input pnt-m-top-2"><label for="input-first-name" class="pnt-form-profile-label">First Name</label><input id="input-first-name" name="input-first-name" type="text" placeholder="Ben"/><div style="display: none" class="form-input-error">Enter your first name here.</div></div><div class="pnt-form-input pnt-m-top-1"><label for="input-last-name" class="pnt-form-profile-label">Last Name</label><input id="input-last-name" name="input-last-name" type="text" placeholder="Franklin"/><div style="display: none" class="form-input-error">Enter your last name here.</div></div><div class="pnt-form-input pnt-m-top-1"><label for="input-email" class="pnt-form-profile-label">Email</label><input id="input-email" name="input-email" type="text" placeholder="name@domain.com"/><div style="display: none" class="form-input-error">Please provide a valid email address.</div></div><div class="pnt-form-input-checkbox-wrapper pnt-m-top-1"><input id="input-searchable" name="input-searchable" type="checkbox" class="pnt-form-input-checkbox-input"/><label for="input-searchable" class="pnt-form-input-checkbox-label">Let other Point users find me. (Your email will remain private)</label></div><div class="profile-fixed-bar pnt-txt-align-c pnt-is-hidden"><div class="pnt-form-options"><div class="pnt-clearfix">Changes have been made.</div><button type="submit" id="update-profile-submit" class="pnt-btn pnt-btn-s">Save</button><button id="update-profile-cancel" class="pnt-btn pnt-btn-s pnt-m-left-p5">Cancel</button></div><div id="update-profile-success" class="pnt-h2 pnt-m-top-0 pnt-is-success pnt-is-hidden"><i class="pnticn-check pnticn-space-r"></i>Profile Updated</div><div id="update-profile-error" class="pnt-h2 pnt-m-top-0 pnt-is-error pnt-is-hidden"><i class="pnticn-x pnticnsmall pnticn-space-r"></i>There was a problem updating your profile. Please try again.</div></div></form></div></div></div>')}return buf.join("")}}),Backbone.Gravy=Backbone.View,_.extend(Backbone.Gravy.prototype,{_VERSION:"1.0",_r:{success:"success",error:"error",clear:"clear",submit:"submit"},_v:!1,_reserved:function(a){for(w in this._r)if(a===this._r[w])return!0;return!1},_validateNode:function(a,b){var c=this.gravy,d=null,e=null,f=c[a];if(!(validator=f instanceof Object?f:this[f]||this.model[f]))throw new Error("[Gravy] Unable to find validator for: "+a);if(_.isObject(validator)&&!_.isFunction(validator)&&(d=validator.success,e=validator.error,!(validator=validator.validator)||!(validator=this[validator]||this.model[validator])))throw new Error("[Gravy] Unable to find validator for: "+a);return{result:validator.apply(this,[b]),success:d||c.success||this[this._r.success],error:e||c.error||this[this._r.error]}},_applyCallback:function(a,b){return a=a.result?a.success:a.error,_.isFunction(a)||(a=this[a]),a.apply(this,[b])},validate:function(a){var b,c,d,e,f;if(c=$(a.target),e=a.target.value,f=this.gravy,!this._v&&!e.length){if(!f.clear&&!this[this._r.clear])throw new Error("[Gravy] Unable to find clear callback!");return this[f.clear||this._r.clear].apply(this,[c])}return d=a.target.name,f[d]?(b=this._validateNode(d,e),this._applyCallback(b,c)):console.error("[Gravy] Did not find "+d+" in gravy hash")},validateAll:function(a){a.preventDefault();var b,c,d=!0,e=this.gravy,f=e.submit;this._v=!0;for(field in e)this._reserved(field)||(c=this.$("#"+field),b=c.val(),callback=this._validateNode(field,b),callback.result||(d=!1),this._applyCallback(callback,c));if(this._v=!1,d||this[f.error]){if(d&&!this[f.success])throw new Error("[Gravy] Unable to find submission success callback!");return this[d?f.success:f.error].apply(this,[$(a.target)])}}}),define("gravy",function(){}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].slice;define("cs!common/views/updateProfileView",["common.config","underscore","jquery","backbone","gravy"],function(a,d,e,f){var g;return g=function(g){function h(){var a=this;return this.emailValidate=function(){return h.prototype.emailValidate.apply(a,arguments)},this.nameSuccess=function(){return h.prototype.nameSuccess.apply(a,arguments)},this.save=function(){return h.prototype.save.apply(a,arguments)},this.cancelForm=function(){return h.prototype.cancelForm.apply(a,arguments)},this.cancelOnClick=function(){return h.prototype.cancelOnClick.apply(a,arguments)},this.onInputChange=function(){return h.prototype.onInputChange.apply(a,arguments)},this.toggleSubmitDisplay=function(){return h.prototype.toggleSubmitDisplay.apply(a,arguments)},this.hasChanged=function(){return h.prototype.hasChanged.apply(a,arguments)},this.updateStates=function(){return h.prototype.updateStates.apply(a,arguments)},this.fillInfoFromUser=function(){return h.prototype.fillInfoFromUser.apply(a,arguments)},h.__super__.constructor.apply(this,arguments)}return b(h,g),h.prototype.initialize=function(){var b=this;return this.model=a.user,this.$firstName=this.$("#input-first-name"),this.$lastName=this.$("#input-last-name"),this.$email=this.$("#input-email"),this.$avatars=this.$(".profile-avatar"),this.$searchable=this.$("#input-searchable"),this.$formOptions=this.$(".pnt-form-options"),this.$inputs=this.$("input"),this.fillInfoFromUser(),null!=a.router&&this.listenTo(a.router,"route",this.cancelOnRouteChange),this.nameIsPrefilled?this.emailIsPrefilled?void 0:d.delay(function(){return b.$email.focus()},500):d.delay(function(){return b.$firstName.focus()},500)},h.prototype.fillInfoFromUser=function(){var b,c,e,f,g,h;return this.toggleSubmitDisplay(!1),null!=(b=a.user.get("email"))&&(this._setVal(this.$email,b),this.emailIsPrefilled=!0),null!=(f=a.user.get("names"))?(c=f.first,e=f.last):(null!=(g=f=null!=(h=a.user.get("name"))?h.split(" "):void 0)?g.length:void 0)&&(c=f[0],e=d.last(f,f.length-1).join(" ")),null!=c&&null!=e&&(this._setVal(this.$firstName,c),this._setVal(this.$lastName,e),this.nameIsPrefilled=!0),this.$searchable.length&&this._setVal(this.$searchable,a.user.get("searchable")),this.updateStates()},h.prototype.updateStates=function(){var a=this;return this.$inputs.each(function(b,c){return a._initVal(e(c))})},h.prototype.hasChanged=function(){var a,b;for(a=!1,b=0;b<this.$inputs.length&&!a;)a=this._hasChanged(this.$inputs.eq(b)),b++;return a},h.prototype.toggleSubmitDisplay=function(a){var b;return b=a?"removeClass":"addClass",this.$formOptions[b]("pnt-is-hidden")},h.prototype.events={"change input":"onInputChange","keyup input":"onInputChange","focusout input":"validate",submit:"validateAll","click .profile-avatar":"onAvatarSelect","click #update-profile-cancel":"cancelOnClick"},h.prototype.onInputChange=function(){return this.hasChanged()?(f.trigger("updateProfileChanged"),this.toggleSubmitDisplay(!0)):(f.trigger("updateProfileReverted"),this.toggleSubmitDisplay(!1))},h.prototype.cancelOnClick=function(a){return a.preventDefault(),this.cancelForm()},h.prototype.cancelOnRouteChange=function(){var a,b;return b=arguments[0],a=2<=arguments.length?c.call(arguments,1):[],this.cancelForm()},h.prototype.cancelForm=function(){return this.fillInfoFromUser(),this.toggleSubmitDisplay(!1),d.defer(function(){return f.trigger("updateProfileCancelled")})},h.prototype.save=function(){var b,c,e,g,h=this;return c=this.$firstName.val(),e=this.$lastName.val(),b=this.$email.val(),g={},(this._hasChanged(this.$firstName)||this._hasChanged(this.$lastName))&&(g.names={first:c,last:e}),this._hasChanged(this.$email)&&(g.email=b),this.$searchable.length&&this._hasChanged(this.$searchable)&&(g.searchable=this.$searchable.is(":checked")),d.isEmpty(g)?(f.trigger("updateProfileCompleted"),this.fillInfoFromUser()):a.user.save(g,{success:function(){return f.trigger("updateProfileCompleted"),h.trackEvent("Profile Updated",{updated:g}),h.fillInfoFromUser()},error:function(){return h.trackEvent("Profile Update Error"),f.trigger("updateProfileError")}})},h.prototype.onAvatarSelect=function(a){var b;return this.$avatars.removeClass("is-profile-avatar-selected"),b=e(a.target),b.addClass("is-profile-avatar-selected")},h.prototype.gravy={submit:{success:"save"},"input-first-name":{validator:"nameValidate",success:"nameSuccess"},"input-last-name":{validator:"nameValidate",success:"nameSuccess"},"input-email":{validator:"emailValidate",success:"emailSuccess"}},h.prototype.nameValidate=function(a){return a.trim().length>0},h.prototype.nameSuccess=function(a){return a.val(this._capitalizeFirstLetter(a.val().trim())),a.siblings(".form-input-error").hide()},h.prototype.emailValidate=function(a){return this._emailRegex.test(a)},h.prototype.emailSuccess=function(a){return a.val(a.val().trim()),a.siblings(".form-input-error").hide()},h.prototype.error=function(a){return a.siblings(".form-input-error").show()},h.prototype.clear=function(){},h.prototype._getProp=function(a){return"checkbox"===a.prop("type")?"checked":"value"},h.prototype._getVal=function(a){return a.prop(this._getProp(a))},h.prototype._setVal=function(a,b){return a.prop(this._getProp(a),b)},h.prototype._initVal=function(a,b){return null!=b?this._setVal(a,b):b=this._getVal(a),a.attr("data-prev",b)},h.prototype._hasChanged=function(a){var b;return b=this._getVal(a),b.toString()!==a.attr("data-prev")},h.prototype._capitalizeFirstLetter=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},h.prototype._emailRegex=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h}(f.Gravy)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/profileView",["common.config","underscore","backbone","cs!views/pageView","cs!common/views/updateProfileView"],function(a,c,d,e,f){var g;return $.fn.flash=function(){var a=this;return $(this).addClass("pnt-anim-flash").removeClass("pnt-is-hidden"),c.delay(function(){return $(a).removeClass("pnt-anim-flash").addClass("pnt-is-hidden")},2e3)},g=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.id="profile-page",e.prototype.initialize=function(a){return e.__super__.initialize.apply(this,arguments),this.mainView=a.mainView,this.updateProfileView=new f({el:this.$("form")}),this.$fixedBar=this.$(".profile-fixed-bar"),this.listenTo(d,"keyDownTab",this.onTabKeyDown),this.listenTo(d,"updateProfileCompleted",this.onUpdateProfileSuccess),this.listenTo(d,"updateProfileError",this.onUpdateProfileError),this.listenTo(d,"updateProfileChanged",this.showFixedBar),this.listenTo(d,"updateProfileReverted",this.hideFixedBar),this.listenTo(d,"updateProfileCancelled",this.hideFixedBar)},e.prototype.onTabKeyDown=function(a){var b;if(this.mainView.activePageView===this)return b=$(a.target),b.is("#input-first-name")?this.$("#input-last-name").focus():b.is("#input-last-name")?this.$("#input-email").focus():this.$("#input-first-name").focus()},e.prototype.onUpdateProfileSuccess=function(){var a=this;return console.log("success"),this.$("#update-profile-error").addClass("pnt-is-hidden"),this.$("#update-profile-success").flash(),c.delay(function(){return a.hideFixedBar()},1500)},e.prototype.onUpdateProfileError=function(){return this.$("#update-profile-error").removeClass("pnt-is-hidden"),this.showFixedBar()},e.prototype.showFixedBar=function(){return this.$fixedBar.removeClass("pnt-is-hidden")},e.prototype.hideFixedBar=function(){return this.$fixedBar.addClass("pnt-is-hidden")},e}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/settingsView",["common.config","underscore","backbone","cs!views/pageView","jade!templates/settingsTemplate","cs!common/browser/browser","cs!views/profileView"],function(a,c,d,e,f,g,h){var i,j;return i={enabled:!1,name:"on_page_button_rule",key:"pnt_on_page_button_rule",set:function(a){var b;return b={},i.enabled=a,b[i.key]={disabled:!a},chrome.storage.local.set(b)}},chrome.storage.local.get(i.key,function(a){var b;return b=a[i.key],i.enabled=!(null!=b?b.disabled:void 0),$("#"+i.name).prop("checked",i.enabled)}),j=function(c){function e(){var a=this;return this.onSettingChange=function(){return e.prototype.onSettingChange.apply(a,arguments)},this.onRestartClick=function(){return e.prototype.onRestartClick.apply(a,arguments)},this.onLogoutClick=function(){return e.prototype.onLogoutClick.apply(a,arguments)},this.render=function(){return e.prototype.render.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,c),e.prototype.id="settings-page",e.prototype.initialize=function(a){return this.mainView=a.mainView,e.__super__.initialize.apply(this,arguments)},e.prototype.events={"click [data-js-settings-logout]":"onLogoutClick","click [data-js-settings-login]":"onLoginClick","click [data-js-settings-restart]":"onRestartClick","click [data-js-need-support]":"onReportBugClick"},e.prototype.track={"click [data-js-settings-logout]":"Settings Logout","click [data-js-settings-login]":"Settings Login","click [data-js-settings-restart]":"Settings Restart","click [data-js-need-support]":"Settings Need Support"},e.prototype.render=function(){var b,c,d,e,g;for(this.settings=[{name:i.name,label:"Show Point button on pages.",value:i.enabled},{name:"email_cc_invites",label:"CC me when I point to an email contact."},{name:"email_new_points",label:"Email me about new points."},{name:"email_new_activity",label:"Email me about new activity.<br> (Digest-style comments, friends, and requests)"},{name:"chime-control",label:"Play a sound on new messages.",value:null==localStorage.chimeDisabled}],this.settings.forEach(function(b){var c;return null!=(c=b.value)?c:b.value=a.user.getSetting(b.name)}),b=f({name:a.user.get("name"),id:a.user.id,settings:this.settings}),this.$el.html("<div class='dropdown-page-content'>"+b+"</div>"),this.profileView=new h({el:this.$h("profile"),mainView:this.mainView}),g=this.settings,d=0,e=g.length;e>d;d++)c=g[d],this.events["change [data-js-"+c.name+"]"]="onSettingChange";return this.delegateEvents()},e.prototype.onLoginClick=function(){var a;return null!=(a=g.extension)?a.sendMessage({request:"open:login",details:{provider:"facebook"}}):void 0},e.prototype.onLogoutClick=function(){return d.ajax({url:a.baseURL+"logout",complete:function(){return a.router.navigate(""),d.trigger("unauthorized")}})},e.prototype.onRestartClick=function(){var a;return delete window.localStorage.lastRoute,"function"==typeof(a=chrome.runtime).reload&&a.reload(),window.close()},e.prototype.onReportBugClick=function(){return d.trigger("messageFlash:openFeedbackPage"," I need help with...")},e.prototype.onSettingChange=function(b){var c,d,e,f;switch(c=$(b.target).closest("[data-js-setting]"),d=c.attr("data-setting"),e=c.find("input")[0].checked,d){case"chime-control":e?(delete localStorage.chimeDisabled,null!=(f=chrome.runtime)&&f.sendMessage({request:"chime:play"})):localStorage.chimeDisabled=!0,delete localStorage.chime;break;case i.name:i.set(e);break;default:a.user.updateSetting(d,e)}return this.trackEvent("Setting Changed",{setting:d,value:e})},e}(e)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/friendRequestModel",["backbone","common.config"],function(a,c){var d;return d=function(d){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,d),e.prototype.urlRoot=c.baseURL+"friends/requests",e.prototype.idAttribute="_id",e.prototype.defaults=function(){return{from:c.user.id}},e.prototype.request=function(a,b){return null==this.id?(this.save("to",a,b),this.trigger("change:status")):void 0},e.prototype.accept=function(b){var d,e;return null==b&&(b={}),d=this.get("user"),null==(e=b.error)&&(b.error=function(){var b,e;return b=null!=(e=d.uid)?e:d._id,c.friends.remove(b),a.trigger("error")}),this.updateStatus(1,b),c.friends.newFriend(d)},e.prototype.reject=function(a){return this.updateStatus(2,a)},e.prototype.cancel=function(a){return this.updateStatus(3,a)},e.prototype.updateStatus=function(a,b){var c;return this.save("status",a,b),null!=(c=this.collection)?c.remove(this):void 0},e}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/friendsListItemModel",["backbone","common.config","cs!common/models/friendRequestModel","cs!common/modules/helpers"],function(a,c,d,e){var f;return f=function(a){function f(){var a=this;return this.getType=function(){return f.prototype.getType.apply(a,arguments)},this.getStatus=function(){return f.prototype.getStatus.apply(a,arguments)},this.removeRequest=function(){return f.prototype.removeRequest.apply(a,arguments)},this.onStatusChange=function(){return f.prototype.onStatusChange.apply(a,arguments)},this.listenToStatusChanges=function(){return f.prototype.listenToStatusChanges.apply(a,arguments)},f.__super__.constructor.apply(this,arguments)}return b(f,a),f.prototype.initialize=function(a){return this.friend=a.friend,this.request=a.request,this.listenToStatusChanges()},f.prototype.accept=function(){var a;return null!=(a=this.request)?a.accept():void 0},f.prototype.reject=function(){var a;return null!=(a=this.request)?a.reject():void 0},f.prototype.cancel=function(){var a;return null!=(a=this.request)?a.cancel():void 0},f.prototype.requestFriendship=function(){return this.request=new d,c.friendRequests.add(this.request),this.request.request(this.friend.get("_id")),this.listenToStatusChanges()},f.prototype.listenToStatusChanges=function(){return null!=this.request?this.listenTo(this.request,"change:status",this.onStatusChange):void 0},f.prototype.onStatusChange=function(){var a;return(null!=(a=this.request)?a.get("status"):void 0)>0&&this.removeRequest(),this.trigger("statusChange",this.getStatus())},f.prototype.removeRequest=function(){return null!=this.request?(this.stopListening(this.request),this.request=null):void 0},f.prototype.getName=function(){return this.friend.get("name")},f.prototype.getAvatar=function(){return e.getAvatar(this.friend.toJSON())},f.prototype.getFriendID=function(){return this.friend.id},f.prototype.getStatus=function(){var a;return 0!==(null!=(a=this.request)?a.get("status"):void 0)?null!=c.friends.get(this.friend.id)?"friends":"stranger":this.request.get("to")===c.user.id?"incoming":this.request.get("from")===c.user.id?"outgoing":void 0},f.prototype.getType=function(){return this.friend.getType()},f}(a.Model)})}.call(this),define("jade!common/templates/friendsListItemTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{}){var klass=locals.selected?"is-list-item-selected":"";buf.push("<div"+jade.attrs({"data-friend-status":status,"data-friend-id":id,"class":"pnt-menu-list-item pnt-menu-friendslist "+klass},{"class":!0,"data-friend-status":!0,"data-friend-id":!0})+">"),onPoint&&(buf.push('<div class="pnt-avatar pnt-avatar-m pnt-menu-friendslist"><div'+jade.attrs({"data-src":avatar,"class":"pnt-avatar-placeholder"},{"data-src":!0})+">"+jade.escape(null==(jade.interp=initials)?"":jade.interp)+"</div>"),onPoint&&"friends"==status&&buf.push('<div class="pnt-avatar-status"><i class="pnticnsmall pnticn-check_1x"></i></div>'),buf.push("</div>")),buf.push('<div class="pnt-menu-list-item-name pnt-menu-friendslist">'+jade.escape(null==(jade.interp=name)?"":jade.interp)+"</div>"),locals.email&&buf.push('<div class="pnt-menu-list-item-email pnt-menu-friendslist">'+jade.escape(null==(jade.interp=email)?"":jade.interp)+"</div>"),buf.push('<div class="pnt-menu-list-item-actions"><div class="pnt-menu-list-item-action-add pnt-btn pnt-btn-outline pnt-menu-list-item-action"><i class="pnticnsmall pnticn-plus_1x"></i>Add</div><div class="pnt-menu-list-item-action-cancel pnt-btn pnt-btn-outline pnt-menu-list-item-action"><i class="pnticnsmall pnticn-x_1x"></i>Cancel</div><div class="pnt-menu-list-item-action-friend pnt-btn pnt-btn-outline pnt-menu-list-item-action"><i class="pnticnsmall pnticn-check pnt-is-success"></i></div><div class="pnt-menu-list-item-action-accept pnt-btn pnt-btn-outline pnt-menu-list-item-action"><i class="pnticnsmall pnticn-check pnt-is-success_1x"></i>Accept</div><div class="pnt-menu-list-item-action-deny pnt-btn pnt-btn-outline pnt-menu-list-item-action"><i class="pnticnsmall pnticn-x pnt-is-success_1x"></i>Not Now</div>'),locals.email&&(locals.selected?buf.push('<input type="checkbox"/>'):buf.push('<input type="checkbox"/>')),buf.push("</div></div>")}return buf.join("")}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/views/friendsListItemView",["common.config","underscore","backbone","cs!common/modules/english","cs!common/modules/helpers","jade!common/templates/friendsListItemTemplate"],function(a,c,d,e,f,g){var h;return h=function(a){function d(){var a=this;return this.onItemClick=function(){return d.prototype.onItemClick.apply(a,arguments)},this.onSelectChange=function(){return d.prototype.onSelectChange.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.initialize=function(a){return this.$list=a.appendTo,this.render(a.newFriend),this.$input=this.$el.find("input"),this.onClick=a.onClick,this.friendModel=this.model.friend,this.listenTo(this.model,"statusChange",this.onStatusChange),this.listenTo(this.friendModel,"change:selected",this.onSelectChange)},d.prototype.render=function(a){var b,d,h,i,j,k,l=this;return h=this.model.getName(),k=this.model.getType(),i="facebookOnPoint"===k||"gmailOnPoint"===k||"gdomain"===k,d={name:h,initials:e.getInitials(h),avatar:this.model.getAvatar(),status:this.model.getStatus(),type:k,id:this.model.getFriendID(),onPoint:i},b=this.model.friend.get("email"),j=this.model.friend.get("selected"),b&&(d.email=b),j&&(d.selected=j),this.$el=$(g(d)),a?(this.$list.prepend(this.$el),c.delay(function(){return l.$el.addClass("pnt-menu-list-item-is-new")},350)):this.$list.append(this.$el),f.fetchAvatars(this.$el)},d.prototype.onSelectChange=function(a,b){return this.$input.prop("checked",b),b?this.$el.addClass("is-list-item-selected"):this.$el.removeClass("is-list-item-selected")},d.prototype.onStatusChange=function(a){return"incoming"===this.$el.attr("data-friend-status")?this.remove():this.$el.attr("data-friend-status",a)},d.prototype.events={click:"onItemClick","click .pnt-menu-list-item-action-add":"onAddFriendClick","click .pnt-menu-list-item-action-cancel":"onCancelRequestClick","click .pnt-menu-list-item-action-accept":"onAcceptRequestClick","click .pnt-menu-list-item-action-deny":"onDenyRequestClick"},d.prototype.track={"click .pnt-menu-list-item-action-add":"Friend Request Add","click .pnt-menu-list-item-action-cancel":"Friend Request Cancel","click .pnt-menu-list-item-action-accept":"Friend Request Accept","click .pnt-menu-list-item-action-deny":"Friend Request Deny"},d.prototype.onItemClick=function(a){var b,c,d;return b=$(a.target),b.is("input")?(a.preventDefault(),c=b.prop("checked")):c=!this.$input.prop("checked"),null!=(d=this.onClick)?d.call(this,a,this.$el,this.friendModel,c):void 0},d.prototype.onAddFriendClick=function(){return this.model.requestFriendship()},d.prototype.onCancelRequestClick=function(){return this.model.cancel()},d.prototype.onAcceptRequestClick=function(){return this.model.accept()},d.prototype.onDenyRequestClick=function(){return this.model.reject()
},d.prototype.append=function(){return this.$el.appendTo(this.$list),this.delegateEvents()},d}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/friendRequestCollection",["backbone","common.config","cs!common/models/friendRequestModel"],function(a,c,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.model=d,e.prototype.url=function(){return c.baseURL+"friends/requests/"+c.user.id},e.prototype.from=function(a){return this.findWhere({from:a})},e.prototype.to=function(a){return this.findWhere({to:a})},e.prototype.getPending=function(){return this.where({from:c.user.id})},e.prototype.getRequests=function(){return this.where({to:c.user.id})},e}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/friendsListView",["common.config","underscore","backbone","cs!common/models/friendModel","cs!common/models/friendsListItemModel","cs!common/views/friendsListItemView","cs!common/collections/friendRequestCollection"],function(a,c,d,e,f,g,h){var i;return i=function(d){function i(){var a=this;return this.onResponsiveSizeChange=function(){return i.prototype.onResponsiveSizeChange.apply(a,arguments)},this.onRequestRemoved=function(){return i.prototype.onRequestRemoved.apply(a,arguments)},this.renderFriendsList=function(){return i.prototype.renderFriendsList.apply(a,arguments)},this.renderFriendRequests=function(){return i.prototype.renderFriendRequests.apply(a,arguments)},this.initialize=function(){return i.prototype.initialize.apply(a,arguments)},i.__super__.constructor.apply(this,arguments)}return b(i,d),i.FRIENDS_TO_DISPLAY=3,i.prototype.initialize=function(b){var d=this;return this.$friendsCount=this.$h("friends-count"),this.$friendsList=this.$h("friends-list-menu"),this.$friendRequestsList=this.$h("friend-request-list"),a.friendRequests=new h,a.friendRequests.fetch({success:this.renderFriendRequests}),this.listenTo(a.friendRequests,"remove",this.onRequestRemoved),this.listenTo(a.friends,"add",this.onFriendAdd),this.listenTo(a.friends,"remove",this.onFriendRemove),this.friends=b.friends,this.renderFriendsList(),c.defer(function(){var b;return null!=(b=a.views.responsiveManager)?b.doOnceAndListen(d.onResponsiveSizeChange):void 0})},i.prototype.renderFriendRequests=function(){var b,d,f=this;return d=a.friendRequests.getRequests(),this.requestViews=[],d.length?(b=this.$friendRequestsList.find(".pnt-menu"),b.html(""),this.$friendRequestsList.removeClass("pnt-is-hidden"),c.each(d,function(a){var c,d;return c=new e(a.get("user")),d=f.renderFriendsListItem(c,a,b),f.requestViews.push(d)})):this.$friendRequestsList.addClass("pnt-is-hidden"),c.each(a.notifications.where({type:"friends:request"}),function(b){var c,d;return c=null!=(d=b.get("id"))?d:b.get("aid"),null==a.friendRequests.get(c)?a.notifications.requestRemoval(b.id):void 0})},i.prototype.renderFriendsList=function(){var a,b=this;return this.restOfFriends=[],a=0,c.each(this.friends,function(c){return a++>i.FRIENDS_TO_DISPLAY-1?b.restOfFriends.push(c):b.renderFriendsListItem(c,null,b.$friendsList)}),this.$friendsCount.html(a),this.restOfFriends.length?$('<div data-friend-status="friends" class="pnt-menu-list-item pnt-menu-see-more pnt-menu-friendslist">\n<div class="pnt-menu-list-item-name pnt-menu-friendslist">See All Friends ...</div>\n</div>').appendTo(this.$friendsList).on("click",function(a){return $(a.target).closest(".pnt-menu-list-item").remove(),c.each(b.restOfFriends,function(a){return b.renderFriendsListItem(a,null,b.$friendsList)})}):void 0},i.prototype.onRequestRemoved=function(b){var c;return a.friendRequests.getRequests().length||this.$friendRequestsList.addClass("pnt-is-hidden"),null!=(c=a.notifications.get(b.id))?a.notifications.remove(c):void 0},i.prototype.onFriendAdd=function(a){return this.$friendsCount.html(parseInt(this.$friendsCount.html())+1),this.renderFriendsListItem(a,null,this.$friendsList,!0)},i.prototype.onFriendRemove=function(a){var b;return b=".pnt-menu-list-item.pnt-menu-friendslist",this.$friendsList.find(b+("[data-friend-id='"+a.id+"']")).remove()},i.prototype.renderFriendsListItem=function(a,b,c,d){var e,h;return null==d&&(d=!1),e=new f({friend:a,request:b}),h=new g({model:e,appendTo:c,newFriend:d})},i.prototype.onResponsiveSizeChange=function(a){switch(this.$friendRequestsList.remove(),a){case"smallScreen":case"dropdown":this.$friendRequestsList.prependTo(this.$h("left-column"));break;case"fullScreen":this.$friendRequestsList.prependTo(this.$h("right-column"))}return c.each(this.requestViews,function(a){return a.delegateEvents()})},i}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/modalView",["common.config","underscore","backbone"],function(a,c,d){var e;return e=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.className="modal",c.prototype.initialize=function(){return this.$nonModals=$("[js-data-non-modals]"),this.$el.remove().appendTo("[js-data-modals-container]")},c.prototype.render=function(){return this.$("body").html('<div class="modal-screen"></div>\n<div class="modal-content" data-js-modal-content>\n    <div class="modal-close" data-js-modal-close>\n        <i class=\'pnticn-x\'></i>\n    <div>\n</div>'),this.$content=this.$h("modal-content"),this.$close=this.$h("modal-close")},c.prototype.events={"click [data-js-modal-close]":"close"},c.prototype.close=function(){return this.$nonModals.removeClass("modal-is-active"),this.$el.addClass("pnt-is-hidden"),this.trigger("close")},c.prototype.open=function(){return this.$nonModals.addClass("modal-is-active"),this.$el.removeClass("pnt-is-hidden"),this.trigger("open")},c}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/friendsSearchView",["common.config","underscore","backbone","cs!views/modalView","cs!common/models/friendModel","cs!common/models/friendsListItemModel","cs!common/views/friendsListItemView"],function(a,c,d,e,f,g,h){var i;return i=function(e){function i(){var a=this;return this.onSearchKeypress=function(){return i.prototype.onSearchKeypress.apply(a,arguments)},this.onSearchFocus=function(){return i.prototype.onSearchFocus.apply(a,arguments)},this.renderResults=function(){return i.prototype.renderResults.apply(a,arguments)},this.onSearchResultsFetch=function(){return i.prototype.onSearchResultsFetch.apply(a,arguments)},this.renderFriendsResults=function(){return i.prototype.renderFriendsResults.apply(a,arguments)},this.initialize=function(){return i.prototype.initialize.apply(a,arguments)},i.__super__.constructor.apply(this,arguments)}return b(i,e),i.INPUT_DEBOUNCE=200,i.prototype.initialize=function(){var a;return i.__super__.initialize.call(this),window.friendsView=this,this.$input=this.$h("search-friends-input"),this.$toHide=this.$h("search-friends-guide"),this.$noResults=this.$h("search-no-results"),this.$resultsList=this.$h("search-friends-results"),this.$friendsResultsList=this.$h("search-your-friends-results"),a=d.Collection.extend({model:f}),this.searchResults=new a},i.prototype.render=function(){return this.$content=this.$h("modal-content")},i.prototype.searchForTerm=function(b){return this.term=b,this.searchResults.url=a.baseURL+("users/search/"+b),this.searchResults.fetch({reset:!0,success:c.partial(this.onSearchResultsFetch,b)})},i.prototype.clearResults=function(){return this.$resultsList.addClass("pnt-is-hidden")},i.prototype.resetSearch=function(){return this.$resultsList.addClass("pnt-is-hidden"),this.$friendsResultsList.addClass("pnt-is-hidden"),this.$toHide.removeClass("pnt-is-hidden"),this.$noResults.addClass("pnt-is-hidden"),this.$input.val("")},i.prototype.renderFriendsResults=function(b){return this.searchResultsFriends=a.friends.searchNames(b,!0),this.renderResults(this.searchResultsFriends,this.$friendsResultsList,!0)},i.prototype.onSearchResultsFetch=function(b){var c;if(b===this.term&&this.$input.val().length)return c=this.searchResults.reject(function(b){var c;return c=b.get("uid"),null!=a.friends.get(c)||null!=a.friendRequests.from(c)||a.user.id===c}),this.trackEvent("Display Friends Search Results",{numResults:c.length,term:b}),this.renderResults(c,this.$resultsList),c.length||this.searchResultsFriends.length?void 0:this.$noResults.removeClass("pnt-is-hidden")},i.prototype.renderResults=function(b,d,e){var f,g=this;return b.length?(f=d.find(".pnt-menu"),f.html(""),d.removeClass("pnt-is-hidden"),c.each(b,function(b){var c;return c=null,e||(c=a.friendRequests.to(b.get("uid"))),g.renderFriendsListItem(b,c,f)})):d.addClass("pnt-is-hidden")},i.prototype.events={"focus [data-js-search-friends-input]":"onSearchFocus","keyup [data-js-search-friends-input]":"onSearchKeypress","click [data-js-modal-close]":"close"},i.prototype.track={"focus [data-js-search-friends-input]":"Friends Search Focus"},i.prototype.onSearchFocus=function(){return this.$h("friends-search-wrapper").addClass("is-focused")},i.prototype.onSearchKeypress=function(){var a,b;return a=this.$input.val(),a!==this.term?(this.term=a,null==(b=this.debouncedSearch)&&(this.debouncedSearch=c.debounce(this.searchForTerm,i.INPUT_DEBOUNCE)),this.$noResults.addClass("pnt-is-hidden"),this.$toHide.addClass("pnt-is-hidden"),this.term.length?(this.renderFriendsResults(this.term),this.term.length>2?this.debouncedSearch(this.term):this.clearResults()):this.resetSearch()):void 0},i.prototype.renderFriendsListItem=function(a,b,c,d){var e,f;return null==d&&(d=!1),e=new g({friend:a,request:b}),f=new h({model:e,appendTo:c,newFriend:d})},i.prototype.close=function(){return i.__super__.close.call(this),this.resetSearch()},i.prototype.open=function(){return i.__super__.open.call(this),this.$input.focus()},i}(e)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/inviteCollection",["backbone","common.config","cs!common/models/friendModel","cs!common/models/inviteModel"],function(a,c,d,e){var f;return f=function(a){function d(){var a=this;return this.setSelectGdomain=function(){return d.prototype.setSelectGdomain.apply(a,arguments)},this.setSelectedAll=function(){return d.prototype.setSelectedAll.apply(a,arguments)},this.setSelected=function(){return d.prototype.setSelected.apply(a,arguments)},this.onSelectChange=function(){return d.prototype.onSelectChange.apply(a,arguments)},this.sendInvites=function(){return d.prototype.sendInvites.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.initialize=function(){return this.listenTo(this,"change:selected",this.onSelectChange),this.selectedCount=0},d.prototype.parse=function(a,b){var e,f,g,h,i,j,k,l,m,n;for(j=[],g=[],f=c.user.getGdomain(),i=/(^(\d|(hello|support|service|help|info|careers|jobs|no-reply|rollup|cash|alerts)@)|(\+|\.craigslist|reply|replies|feedback|unsubscribe))/,k=0,m=a.length;m>k;k++)if(h=a[k],h.unset("selected"),e=h.get("email")){if(i.test(e))continue;f&&e.indexOf(f)>-1?(h.set("gdomain",f),g.unshift(h)):j.push(h)}if(g.length)for(l=0,n=g.length;n>l;l++)h=g[l],j.unshift(h);return d.__super__.parse.call(this,j,b)},d.prototype.sendInvites=function(){var a,b,d=this;return b=this.getSelectedToInvite(),b.length?(a=new e,c.DEVELOPMENT?_.delay(function(){return d.trigger("inviteSuccess",b.length)},200):a.save({type:"emailBlast",recip:b},{success:function(){return d.trigger("inviteSuccess",b.length)}}),this.moveInvitedToBack(b)):this.trigger("nothingSelected")},d.prototype.moveInvitedToBack=function(a){var b,c=this;return b=_.map(a,function(a){var b;return b=c.get(a.pid),b.set("selected",!1)}),this.remove(b),this.add(b),this.trigger("invitesMoved"),this.trigger("selectedCountChange",this.selectedCount)},d.prototype.getSelectedToInvite=function(){var a,b,c,d,e;for(c=[],b=_.where(this.toJSON(),{selected:!0}),d=0,e=b.length;e>d;d++)a=b[d],a.name||delete a.name,delete a.selected,c.push(a);return c},d.prototype.onSelectChange=function(a,b){return b?this.selectedCount++:this.selectedCount--,this.trigger("selectedCountChange",this.selectedCount)},d.prototype.setSelected=function(a,b){return a.set({selected:b}),b?this.selectedCount++:this.selectedCount--,this.trigger("selectedCountChange",this.selectedCount)},d.prototype.setSelectedAll=function(a){return this.each(function(b){return b.set({selected:a},{silent:!0})}),this.selectedCount=a?this.length:0,this.trigger("selectedCountChange",this.selectedCount)},d.prototype.setSelectGdomain=function(a){var b;return(b=c.user.getGdomain())?this.each(function(c){return c.isInGdomain(b)?c.set({selected:a}):void 0}):void 0},d.prototype.search=function(a,b){var c,d,e=this;return null==b&&(b=!1),c=[],d=[],this.each(function(f){var g,h;if(b&&!f.get("pnt_user"))return!1;if(f.has("name")){if(g=e._compare(f.get("name"),a),0===g)return c.push(f);if(g>0)return d.push(f)}if(f.has("email")){if(h=e._compare(f.get("email"),a),0===h)return c.push(f);if(h>0)return d.push(f)}}),_.each(d,function(a){return c.push(a)}),c},d.prototype._compare=function(a,b){return a.toUpperCase().indexOf(b.toUpperCase())},d}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/views/inviteView",["backbone","cs!common/collections/inviteCollection","cs!common/models/inviteModel","cs!common/models/friendsListItemModel","cs!common/views/friendsListItemView","jqCSSAnim"],function(a,c,d,e,f){var g;return g=function(a){function d(){var a=this;return this.sendInvitesOnClick=function(){return d.prototype.sendInvitesOnClick.apply(a,arguments)},this.onSearchKeypress=function(){return d.prototype.onSearchKeypress.apply(a,arguments)},this.onCheckInOrgClick=function(){return d.prototype.onCheckInOrgClick.apply(a,arguments)},this.onCheckAllClicked=function(){return d.prototype.onCheckAllClicked.apply(a,arguments)},this.onListItemClicked=function(){return d.prototype.onListItemClicked.apply(a,arguments)},this._renderFriend=function(){return d.prototype._renderFriend.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.initialize=function(a){var b=this;if(null==a.models)throw"no models provided";return this.collection=new c(a.models,{parse:!0}),this.$list=this.$h("invite-friends-list"),this.$input=this.$h("search-friends-input"),this.$checkAll=this.$h("check-all"),this.$checkAllOrg=this.$h("check-all-in-org"),this.render(this.collection.models),this.listenTo(this.collection,"invitesMoved",function(){return b.render(b.collection.models)})},d.prototype.render=function(a){return this.$list.html(""),_.each(a,this._renderFriend)},d.prototype._renderFriend=function(a){return null==a.model||null==a.view?(a.model=new e({friend:a}),a.view=new f({model:a.model,appendTo:this.$list,onClick:this.onListItemClicked})):a.view.append()},d.prototype.events={"keyup [data-js-search-friends-input]":"onSearchKeypress","click [data-js-check-all]":"onCheckAllClicked","click [data-js-check-all-in-org]":"onCheckInOrgClick","click [data-js-send-invites]":"sendInvitesOnClick"},d.prototype.onListItemClicked=function(a,b,c,d){var e;return d||(this.$checkAll.prop("checked",!1),c.isInGdomain()&&null!=(e=this.$checkAllOrg)&&e.prop("checked",!1)),_.defer(function(){return c.set("selected",d)})},d.prototype.onCheckAllClicked=function(){var a;return a=this.$checkAll.prop("checked"),this.$(".pnt-menu-list-item input[type='checkbox']").prop("checked",a),this.collection.setSelectedAll(a)},d.prototype.onCheckInOrgClick=function(){var a;return a=this.$checkAllOrg.prop("checked"),this.collection.setSelectGdomain(a)},d.prototype.onSearchKeypress=function(){var a,b;return b=this.$input.val(),b!==this.term?(this.term=b,a=this.collection.search(b),this.render(a)):void 0},d.prototype.sendInvitesOnClick=function(){return this.collection.sendInvites()},d}(a.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/friendsInviteView",["common.config","underscore","backbone","cs!views/modalView","cs!common/views/inviteView","cs!common/views/referralClipboardView"],function(a,c,d,e,f,g){var h;return h=function(d){function e(){var a=this;return this.onSelectedCountChange=function(){return e.prototype.onSelectedCountChange.apply(a,arguments)},this.showMessage=function(){return e.prototype.showMessage.apply(a,arguments)},this.onNothingSelected=function(){return e.prototype.onNothingSelected.apply(a,arguments)},this.onInviteSuccess=function(){return e.prototype.onInviteSuccess.apply(a,arguments)},this.initialize=function(){return e.prototype.initialize.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,d),e.prototype.initialize=function(a){var b,d=this;return e.__super__.initialize.call(this),this.inviteFriends=a.inviteFriends,this.renderInviteView=c.once(function(){return c.delay(function(){return d.inviteView=new f({el:d.$h("invite-friend-wrapper"),models:d.inviteFriends}),d.listenTo(d.inviteView.collection,"nothingSelected",d.onNothingSelected),d.listenTo(d.inviteView.collection,"inviteSuccess",d.onInviteSuccess),d.listenTo(d.inviteView.collection,"selectedCountChange",d.onSelectedCountChange),c.defer(function(){return d.$nonModals.addClass("modal-is-active")})},400)}),this.$sendInvitesBtn=this.$h("send-invites"),b=this.$h("copy-invite-link"),b.length?this.referralClipboardView=new g({el:b,from:"Friends Page Modal"}):void 0},e.prototype.onInviteSuccess=function(a){return this.showMessage("                <i class='pnticn-check pnticn-space-r'></i>                 Great, you sent "+(1===a?"1 invite.":""+a+" invites.")),this.trackEvent("Invites Sent",{numInvited:a})},e.prototype.onNothingSelected=function(){var a=this;return this.$sendInvitesBtn.addClass("pnt-btn-error"),this.showMessage("Select friends to invite!"),this.$sendInvitesBtn.onCssAnimationEnd(function(){return a.$sendInvitesBtn.removeClass("pnt-btn-error")})},e.prototype.showMessage=function(b){return a.views.tooltip.show({innerHtml:b,div:this.$h("invite-friends-list"),preferDirection:"center",size:"large",showArrow:!1,offset:{x:0,y:0},duration:2500,enterAnimation:{name:"fadeIn"},exitAnimation:{name:"fadeOut"}})},e.prototype.hideMessage=function(){return a.views.tooltip.hide()},e.prototype.onSelectedCountChange=function(a){var b;return this.count=a,0===a?(b="Invite Friends",this.$sendInvitesBtn.removeClass("pnt-btn-active"),this.$h("hide-when-inviting").removeClass("pnt-is-hidden")):1===a?(b="Invite 1 Friend",this.$sendInvitesBtn.addClass("pnt-btn-active"),this.$h("hide-when-inviting").addClass("pnt-is-hidden"),this.hideMessage()):(b="Invite "+a+" Friends",this.$sendInvitesBtn.addClass("pnt-btn-active"),this.$h("hide-when-inviting").addClass("pnt-is-hidden"),this.hideMessage()),this.$sendInvitesBtn.find("span").text(b)},e.prototype.open=function(){return this.$el.removeClass("pnt-is-hidden"),this.trigger("open"),this.renderInviteView()},e.prototype.render=function(){return this.$content=this.$h("modal-content")},e}(e)})}.call(this),define("jade!templates/friendsPageTemplate",["jade"],function(jade){return function anonymous(locals){var buf=[];with(locals||{})buf.push('<div class="grid-container"><div data-js-left-column="data-js-left-column" class="col-left"><div class="pnt-friends-list-header">Search for People on Point</div><div style="padding: 20px"><div data-js-friends-search-clicktarget="data-js-friends-search-clicktarget" class="pnt-search-wrapper pnt-form-input-wrapper modal-friends modal-friends-search-clicktarget"><i class="pnticn-loupe_1x pnticnlarge pnticn-space-r"></i><input type="text" placeholder="Search by name or email." class="pnt-form pnt-form-input"/></div></div><div class="pnt-friends-list-header">Invite Friends to Point</div>'),authedGoogle?buf.push('<div style="padding: 20px" class="pnt-txt-align-c"><div js-data-btn-invite-friends="js-data-btn-invite-friends" class="pnt-btn pnt-btn-dd pnt-btn-green">Invite Friends to Point</div></div><div data-js-modal-invite="data-js-modal-invite" class="modal modal-friends pnt-is-hidden"><div class="modal-screen modal-friends"></div><div data-js-modal-content="data-js-modal-content" class="modal-content modal-friends"><div data-js-modal-close="data-js-modal-close" style="top: 4px; right: 4px" class="modal-close"><i class="pnticn-x"></i></div><div class="pnt-h2 pnt-txt-align-c">Select friends to invite.</div><div data-js-invite-friend-wrapper="data-js-invite-friend-wrapper"><div class="pnt-menu-wrapper invite-friends-list"><div class="pnt-menu-header"><div class="pnt-search-wrapper pnt-form-input-wrapper modal-friends invite-friends-list"><i class="pnticn-loupe_1x pnticnlarge pnticn-space-r"></i><input data-js-search-friends-input="data-js-search-friends-input" name="search-friends-input" type="text" placeholder="" class="pnt-form pnt-form-input invite-friends-list"/></div></div><div data-js-invite-friends-list="data-js-invite-friends-list" class="pnt-menu pnt-menu-friendslist invite-friends-list"></div></div><div class="pnt-m-top-1 pnt-txt-align-c"><button data-js-send-invites="data-js-send-invites" class="pnt-btn pnt-btn-dd pnt-btn-l pnt-btn-send-invites"><span>Invite Friends</span></button><div style="padding: 20px" data-js-hide-when-inviting="data-js-hide-when-inviting"><div class="pnt-orline pnt-m-top-1"></div><div class="pnt-m-top-2"><div class="pnt-h2">Share this link with friends to get them using Point!</div><div data-js-copy-invite-link="data-js-copy-invite-link" class="copy-invite-link"></div></div></div></div></div></div></div>'):buf.push('<div style="padding: 20px"><p>Share this link with friends to get them using Point!</p><div data-js-copy-invite-link="data-js-copy-invite-link" class="copy-invite-link"></div></div>'),buf.push('<div class="pnt-friends-list-header">Find Friends in your Contacts</div><div style="padding: 20px"><div class="pnt-txt-align-c">'),authedFacebook&&authedGoogle?buf.push('<div js-data-login-google="js-data-login-google" class="pnt-btn pnt-btn-dd pnt-btn-google pnt-m-top-p5"><i class="pnticn-gmail pnticnlarge"></i>Find Gmail Contacts</div>'):authedFacebook?buf.push('<div js-data-login-google="js-data-login-google" class="pnt-btn pnt-btn-dd pnt-btn-google"><i class="pnticn-gmail pnticnlarge"></i>Find Gmail Contacts</div>'):authedGoogle&&buf.push('<div><div js-data-login-facebook="js-data-login-facebook" class="pnt-btn pnt-btn-dd pnt-btn-facebook"><i class="pnticn-facebook_fill pnticnlarge"></i>Find Facebook Friends</div></div><div class="pnt-m-top-p2"><div js-data-login-google="js-data-login-google" class="pnt-btn pnt-btn-dd pnt-btn-google pnt-m-top-p5"><i class="pnticn-gmail pnticnlarge"></i>Find Gmail Contacts</div></div>'),buf.push('</div></div><div data-js-modal-search="data-js-modal-search" class="modal modal-friends pnt-is-hidden"><div class="modal-screen modal-friends"></div><div data-js-modal-content="data-js-modal-content" class="modal-content modal-friends"><div class="pnt-search-wrapper pnt-form-input-wrapper modal-friends"><i class="pnticn-loupe pnticnlarge pnticn-space-r"></i><input data-js-search-friends-input="data-js-search-friends-input" name="search-friends-input" type="text" placeholder="Search by name or email." class="pnt-form pnt-form-input"/><div style="top: 5px" data-js-modal-close="data-js-modal-close" class="modal-close"><i class="pnticn-x"></i></div></div><div class="pnt-friends-list-scroll"><div data-js-search-friends-results="data-js-search-friends-results" class="pnt-is-hidden"><div class="pnt-friends-list-header">People on Point</div><div class="pnt-menu pnt-menu-friendslist"></div></div><div data-js-search-your-friends-results="data-js-search-your-friends-results" class="pnt-is-hidden"><div class="pnt-friends-list-header">Your Friends</div><div class="pnt-menu pnt-menu-friendslist"></div></div><div data-js-search-no-results="data-js-search-no-results" class="pnt-m-top-3 pnt-txt-align-c pnt-is-hidden"><div style="padding: 20px" class="pnt-h2">No users found with that name.</div></div><div data-js-search-friends-guide="data-js-search-friends-guide" class="pnt-m-top-3 pnt-txt-align-c"><div style="padding: 20px" class="pnt-h2">Search for people you may know to add them as friends.</div></div></div></div></div></div><div data-js-right-column="data-js-right-column" class="col-right"><div data-js-friend-request-list="data-js-friend-request-list" class="pnt-is-hidden pnt-menu-friendrequests"><div class="pnt-friends-list-header">Friend Requests</div><div class="pnt-menu pnt-menu-friendslist"></div></div><div class="pnt-friends-list-header">Your Friends (<span data-js-friends-count="data-js-friends-count"></span>)</div><div data-js-friends-list-menu="data-js-friends-list-menu" class="pnt-menu pnt-menu-friendslist"></div></div></div>');return buf.join("")}}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/friendsCollection",["backbone","common.config","cs!common/browser/browser","cs!common/models/friendModel"],function(a,c,d,e){var f,g,h,i,j;return h={pid:"523727c402c6d2b3516968e3",uid:"523727c402c6d2b3516968e3",id:"100006630185561",name:"Point Team",pnt_user:!0},g={email:"hi@getpoint.co",name:"",pid:"hi@getpoint.co",value:"hi@getpoint.co"},i=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},j=function(a){var b;if(null!=a)return b=a.split(", "),b.length>1&&(a=b.reverse().join(" ")),b=a.split(" "),b.forEach(function(a,c){return b[c]=i(a)}),b.join(" ")},f=function(f){function i(){var a=this;return this.getGrouped=function(){return i.prototype.getGrouped.apply(a,arguments)},this.addPointTeamToBack=function(){return i.prototype.addPointTeamToBack.apply(a,arguments)},this.afterStorageSave=function(){return i.prototype.afterStorageSave.apply(a,arguments)},this.saveToStorage=function(){return i.prototype.saveToStorage.apply(a,arguments)},this.onStorageChange=function(){return i.prototype.onStorageChange.apply(a,arguments)},this.getById=function(){return i.prototype.getById.apply(a,arguments)},this.clone=function(){return i.prototype.clone.apply(a,arguments)},this.fetch=function(b){return null==b&&(b={}),i.prototype.fetch.apply(a,arguments)},this.load=function(b){return null==b&&(b={}),i.prototype.load.apply(a,arguments)},i.__super__.constructor.apply(this,arguments)}return b(i,f),i.prototype.canModify=!1,i.prototype.fetchIfEmpty=!1,i.prototype.saving=!1,i.prototype.token="pnt_friends",i.prototype.model=e,i.prototype.url=function(){return c.baseURL+"friends/"+c.user.id},i.prototype.initialize=function(b,c){return null==c&&(c={}),this.saveToStorageDebounced=_.debounce(this.saveToStorage,100),this.fetchIfEmpty=c.fetchIfEmpty,this.listenTo(this,"sync",this.saveToStorage),this.listenTo(a,"storage:pnt_friends",this.onStorageChange),this.debouncedFetch=_.debounce(this.fetch,100)},i.prototype.load=function(a){var b,e,f,g=this;return null==a&&(a={}),null==(f=a.fetch)&&(a.fetch=!0),e=this,b=function(b){var d;if(null==(d=b[g.token])||!d.length&&g.fetchIfEmpty){if(c.user.id&&a.fetch)return g.fetch(a);g.addPointTeamToBack()}else g.reset(d);return"function"==typeof a.success?a.success(e,g.toJSON(),a):void 0},d.storage.get(this.token,b,"local")},i.prototype.fetch=function(a){var b,d,e,f=this;return null==a&&(a={}),null==(b=a.data)&&(a.data={}),c.user.hasFacebook()&&(a.data.facebook=!0),c.user.hasGoogle()&&(a.data.google=!0),null==(d=a.reset)&&(a.reset=!0),null==(e=a.error)&&(a.error=function(){return a.fetch=!1,f.load(a)}),i.__super__.fetch.call(this,a)},i.prototype.clone=function(){return new a.Collection(this.models)},i.prototype.getById=function(a){return this.get(a)||this.findWhere({uid:a})||this.findWhere({id:a})},i.prototype.newFriend=function(a){var b=this;if(null==this.get(a.uid))return this.addFriend(a,null,!0),this.debouncedFetch({error:function(){return b.addPointTeamToBack(),b.addFriend(a)}})},i.prototype.addFriend=function(a,b,c){var d,e;return null==b&&(b={}),_.isEmpty(a)?void 0:(a.pnt_user=!0,a.pid=a.uid||a.id,(e=this.get(a.uid))?e.set(a,b):a.id&&(d=this.findWhere({id:a.id}))?d.set(a,b):this.add(a,b),c?void 0:this.saveToStorage())},i.prototype.parse=function(a){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r;if(null==a&&(a={}),_.isArray(a))return a;for(d=a.friends||[],f=[],i=null!=(o=a.scores)?o:{},k=0,m=d.length;m>k;k++)c=d[k],c.pid=null!=(p=c.uid)?p:c.id,c.score=null!=(h=i[c.uid])?-1*h||0:0,c.pnt_user=!0,c._term=c.name,f[c.uid]=c,null!=c.id&&(f[c.id]=c.name),null!=c.gmail&&(f[c.gmail]=c.gmail);if(d=_.sortBy(d,"name"),d=_.sortBy(d,"score"),g=[],e=[],_.isArray(a.google))for(q=a.google,l=0,n=q.length;n>l;l++){if(b=q[l],b.uid){if(null!=f[b.uid]||null!=f[b.email])continue;delete b.uid}b.pid=b.email,b._term=b.email,(null!=(r=b.name)?r.length:void 0)&&/^[a-z]/i.test(b.name.trim())?(b.name=j(b.name),b._term=b.name+" "+b._term,g.push(b)):(delete b.name,e.push(b))}return g.length&&(g=_.sortBy(g,"name")),e.length&&_.each(_.sortBy(e,"email"),function(a){return g.push(a)}),d.concat(g)},i.prototype.onStorageChange=function(a){return this.saving?this.saving=!1:null!=a.newValue?this.reset(a.newValue):void 0},i.prototype.saveToStorage=function(){var a;return this.saving=!0,_.delay(this.afterStorageSave,1e3),a={pnt_friends:this.toJSON()},d.storage.set(a,"local")},i.prototype.afterStorageSave=function(){return this.saving=!1},i.prototype.addPointTeamToBack=function(){var a,b,c;return a={silent:!0,sort:!1},(c=this.get(h.uid))&&this.remove(c,a),this.add(h,a),(b=this.get(g.pid))&&this.remove(b,a),this.add(g,a)},i.prototype.sort=function(){return i.__super__.sort.apply(this,arguments),this.addPointTeamToBack()},i.prototype.comparator=function(a){return a.get("score")},i.prototype.searchNames=function(a,b){var c,d,e=this;return null==b&&(b=!1),c=[],d=[],this.each(function(f){var g;return b&&!f.get("pnt_user")?!1:(g=e._compare(f.get("name"),a),0===g?c.push(f):g>0?d.push(f):void 0)}),_.each(d,function(a){return c.push(a)}),c},i.prototype.getGrouped=function(){var a;return a=c.user.gdomain,this.groupBy(function(b){return b.getType(a)})},i.prototype._compare=function(a,b){return a.toUpperCase().indexOf(b.toUpperCase())},i.prototype.increaseScoreOf=function(a){var b;return this.remove(a,{silent:!0}),b=(parseInt(a.get("score"))||0)-1,a.set("score",b),this.add(a,{silent:!0,sort:!0}),this.saveToStorageDebounced()},i}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/friendsView",["common.config","underscore","backbone","cs!views/pageView","cs!views/friendsListView","cs!views/friendsSearchView","cs!views/friendsInviteView","jade!templates/friendsPageTemplate","cs!common/browser/browser","cs!common/collections/friendsCollection","cs!common/views/referralClipboardView"],function(a,c,d,e,f,g,h,i,j,k,l){var m;return m=function(d){function e(){var a=this;return this.onSearchModalClose=function(){return e.prototype.onSearchModalClose.apply(a,arguments)
},this.onFriendsSearchClick=function(){return e.prototype.onFriendsSearchClick.apply(a,arguments)},this.renderViewsOnFriendsFetch=function(){return e.prototype.renderViewsOnFriendsFetch.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,d),e.prototype.id="friends-list",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.render()},e.prototype.render=function(){var b,c,d;return c=a.user.hasFacebook(),d=a.user.hasGoogle(),b=i({authedFacebook:c,authedGoogle:d}),this.$page.html(b),this.$searchClick=this.$h("friends-search-clicktarget"),this.renderViewsOnFriendsFetch()},e.prototype.renderViewsOnFriendsFetch=function(){var b,d;return this.friends=a.friends.getGrouped(),this.friendsSearchView=new g({el:this.$h("modal-search")}),d=c.sortBy(c.union(this.friends.facebookOnPoint,this.friends.gmailOnPoint),function(a){return a.get("score")}),this.friendsListView=new f({el:this.$el,friends:d}),this.friendsInviteView=new h({el:this.$h("modal-invite"),inviteFriends:this.friends.gmail}),this.listenTo(this.friendsSearchView,"close",this.onSearchModalClose),b=this.$h("copy-invite-link"),b.length?this.referralClipboardView=new l({el:b,from:"Friends Page"}):void 0},e.prototype.events={"click [js-data-login-google]":"onLoginGoogleClick","click [js-data-login-facebook]":"onLoginFacebookClick","click [data-js-friends-search-clicktarget]":"onFriendsSearchClick","click [js-data-btn-invite-friends]":"onInviteFriendsClick"},e.prototype.track={"click [js-data-login-google]":"Click Add Google Account","click [js-data-login-facebook]":"Click Add Facebook Account"},e.prototype.onLoginGoogleClick=function(){var a;return null!=(a=j.extension)&&a.sendMessage({request:"open:login",details:{provider:"google"}}),!1},e.prototype.onLoginFacebookClick=function(){var a;return null!=(a=j.extension)&&a.sendMessage({request:"open:login",details:{provider:"facebook"}}),!1},e.prototype.onFriendsSearchClick=function(){return this.friendsSearchView.open(),this.$searchClick.addClass("search-modal-is-open")},e.prototype.onSearchModalClose=function(){return this.$searchClick.removeClass("search-modal-is-open")},e.prototype.onInviteFriendsClick=function(){return this.friendsInviteView.open()},e}(e)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/alertView",["jquery","backbone","jqCSSAnim"],function(a,c){var d;return d=function(d){function e(){var a=this;return this.closeAlertOnClick=function(){return e.prototype.closeAlertOnClick.apply(a,arguments)},this.hide=function(){return e.prototype.hide.apply(a,arguments)},this.show=function(){return e.prototype.show.apply(a,arguments)},this.onErrorClose=function(){return e.prototype.onErrorClose.apply(a,arguments)},this.onError=function(){return e.prototype.onError.apply(a,arguments)},e.__super__.constructor.apply(this,arguments)}return b(e,d),e.prototype.initialize=function(a){return this.listenTo(c,"error",this.onError),this.listenTo(c,"errorClose",this.onErrorClose),this.appendTo=a.appendTo},e.prototype.onError=function(a,b){return a=null!=a?a:"Something went wrong!",this.render(),this.setText(a),this.show(),this.trackEvent("Error Shown"),null!=b?_.delay(this.hide,b):void 0},e.prototype.onErrorClose=function(){return this.hide()},e.prototype.render=function(){return this.rendered?void 0:(this.$el=a("<div class='alert pnt-is-hidden'>\n    <i class='alert-icon pnticn-warning pnticnlarge'></i>\n    <div class='alert-text'></div>\n    <i class='alert-close pnticn-x pnticnsmall'></i>\n</div>").appendTo(this.appendTo),this.$text=this.$(".alert-text"),this.$icon=this.$(".alert-icon"),this.delegateEvents(),this.rendered=!0)},e.prototype.setText=function(a){return this.$text.text(a)},e.prototype.show=function(){var a=this;return _.defer(function(){return a.$el.removeClass("pnt-is-hidden")})},e.prototype.hide=function(){var a=this;return _.defer(function(){return a.$el.addClass("pnt-is-hidden")})},e.prototype.events={click:"closeAlertOnClick","click .alert-close":"closeAlertOnClick"},e.prototype.track={"click .alert-close":"Close Alert"},e.prototype.closeAlertOnClick=function(){return this.hide()},e}(c.View)})}.call(this),function(a,b){"function"==typeof define&&define.amd?define("jqTransit",["jquery"],b):"object"==typeof exports?module.exports=b(require("jquery")):b(a.jQuery)}(this,function(a){function b(a){if(a in l.style)return a;for(var b=["Moz","Webkit","O","ms"],c=a.charAt(0).toUpperCase()+a.substr(1),d=0;d<b.length;++d){var e=b[d]+c;if(e in l.style)return e}}function c(){return l.style[m.transform]="",l.style[m.transform]="rotateY(90deg)",""!==l.style[m.transform]}function d(a){return"string"==typeof a&&this.parse(a),this}function e(a,b,c){b===!0?a.queue(c):b?a.queue(b,c):a.each(function(){c.call(this)})}function f(b){var c=[];return a.each(b,function(b){b=a.camelCase(b),b=a.transit.propertyMap[b]||a.cssProps[b]||b,b=i(b),m[b]&&(b=i(m[b])),-1===a.inArray(b,c)&&c.push(b)}),c}function g(b,c,d,e){var g=f(b);a.cssEase[d]&&(d=a.cssEase[d]);var h=""+k(c)+" "+d;parseInt(e,10)>0&&(h+=" "+k(e));var i=[];return a.each(g,function(a,b){i.push(b+" "+h)}),i.join(", ")}function h(b,c){c||(a.cssNumber[b]=!0),a.transit.propertyMap[b]=m.transform,a.cssHooks[b]={get:function(c){var d=a(c).css("transit:transform");return d.get(b)},set:function(c,d){var e=a(c).css("transit:transform");e.setFromString(b,d),a(c).css({"transit:transform":e})}}}function i(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function j(a,b){return"string"!=typeof a||a.match(/^[\-0-9\.]+$/)?""+a+b:a}function k(b){var c=b;return"string"!=typeof c||c.match(/^[\-0-9\.]+/)||(c=a.fx.speeds[c]||a.fx.speeds._default),j(c,"ms")}a.transit={version:"0.9.12",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var l=document.createElement("div"),m={},n=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;m.transition=b("transition"),m.transitionDelay=b("transitionDelay"),m.transform=b("transform"),m.transformOrigin=b("transformOrigin"),m.filter=b("Filter"),m.transform3d=c();var o={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},p=m.transitionEnd=o[m.transition]||null;for(var q in m)m.hasOwnProperty(q)&&"undefined"==typeof a.support[q]&&(a.support[q]=m[q]);return l=null,a.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},a.cssHooks["transit:transform"]={get:function(b){return a(b).data("transform")||new d},set:function(b,c){var e=c;e instanceof d||(e=new d(e)),b.style[m.transform]="WebkitTransform"!==m.transform||n?e.toString():e.toString(!0),a(b).data("transform",e)}},a.cssHooks.transform={set:a.cssHooks["transit:transform"].set},a.cssHooks.filter={get:function(a){return a.style[m.filter]},set:function(a,b){a.style[m.filter]=b}},a.fn.jquery<"1.8"&&(a.cssHooks.transformOrigin={get:function(a){return a.style[m.transformOrigin]},set:function(a,b){a.style[m.transformOrigin]=b}},a.cssHooks.transition={get:function(a){return a.style[m.transition]},set:function(a,b){a.style[m.transition]=b}}),h("scale"),h("scaleX"),h("scaleY"),h("translate"),h("rotate"),h("rotateX"),h("rotateY"),h("rotate3d"),h("perspective"),h("skewX"),h("skewY"),h("x",!0),h("y",!0),d.prototype={setFromString:function(a,b){var c="string"==typeof b?b.split(","):b.constructor===Array?b:[b];c.unshift(a),d.prototype.set.apply(this,c)},set:function(a){var b=Array.prototype.slice.apply(arguments,[1]);this.setter[a]?this.setter[a].apply(this,b):this[a]=b.join(",")},get:function(a){return this.getter[a]?this.getter[a].apply(this):this[a]||0},setter:{rotate:function(a){this.rotate=j(a,"deg")},rotateX:function(a){this.rotateX=j(a,"deg")},rotateY:function(a){this.rotateY=j(a,"deg")},scale:function(a,b){void 0===b&&(b=a),this.scale=a+","+b},skewX:function(a){this.skewX=j(a,"deg")},skewY:function(a){this.skewY=j(a,"deg")},perspective:function(a){this.perspective=j(a,"px")},x:function(a){this.set("translate",a,null)},y:function(a){this.set("translate",null,a)},translate:function(a,b){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==a&&void 0!==a&&(this._translateX=j(a,"px")),null!==b&&void 0!==b&&(this._translateY=j(b,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var a=(this.scale||"1,1").split(",");return a[0]&&(a[0]=parseFloat(a[0])),a[1]&&(a[1]=parseFloat(a[1])),a[0]===a[1]?a[0]:a},rotate3d:function(){for(var a=(this.rotate3d||"0,0,0,0deg").split(","),b=0;3>=b;++b)a[b]&&(a[b]=parseFloat(a[b]));return a[3]&&(a[3]=j(a[3],"deg")),a}},parse:function(a){var b=this;a.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(a,c,d){b.setFromString(c,d)})},toString:function(a){var b=[];for(var c in this)if(this.hasOwnProperty(c)){if(!m.transform3d&&("rotateX"===c||"rotateY"===c||"perspective"===c||"transformOrigin"===c))continue;"_"!==c[0]&&(a&&"scale"===c?b.push(c+"3d("+this[c]+",1)"):a&&"translate"===c?b.push(c+"3d("+this[c]+",0)"):b.push(c+"("+this[c]+")"))}return b.join(" ")}},a.fn.transition=a.fn.transit=function(b,c,d,f){var h=this,i=0,j=!0,l=a.extend(!0,{},b);"function"==typeof c&&(f=c,c=void 0),"object"==typeof c&&(d=c.easing,i=c.delay||0,j="undefined"==typeof c.queue?!0:c.queue,f=c.complete,c=c.duration),"function"==typeof d&&(f=d,d=void 0),"undefined"!=typeof l.easing&&(d=l.easing,delete l.easing),"undefined"!=typeof l.duration&&(c=l.duration,delete l.duration),"undefined"!=typeof l.complete&&(f=l.complete,delete l.complete),"undefined"!=typeof l.queue&&(j=l.queue,delete l.queue),"undefined"!=typeof l.delay&&(i=l.delay,delete l.delay),"undefined"==typeof c&&(c=a.fx.speeds._default),"undefined"==typeof d&&(d=a.cssEase._default),c=k(c);var n=g(l,c,d,i),o=a.transit.enabled&&m.transition,q=o?parseInt(c,10)+parseInt(i,10):0;if(0===q){var r=function(a){h.css(l),f&&f.apply(h),a&&a()};return e(h,j,r),h}var s={},t=function(b){var c=!1,d=function(){c&&h.unbind(p,d),q>0&&h.each(function(){this.style[m.transition]=s[this]||null}),"function"==typeof f&&f.apply(h),"function"==typeof b&&b()};q>0&&p&&a.transit.useTransitionEnd?(c=!0,h.bind(p,d)):window.setTimeout(d,q),h.each(function(){q>0&&(this.style[m.transition]=n),a(this).css(l)})},u=function(a){this.offsetWidth,t(a)};return e(h,j,u),this},a.transit.getTransitionValue=g,a}),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/modalPointView",["jquery","common.config","backbone","cs!views/PointView","cs!views/dropdownMessagesView","cs!common/models/pointModel","jqTransit","jqCSSAnim"],function(a,c,d,e,f){var g,h;return h=function(a){function c(){var a=this;return this.hide=function(){return c.prototype.hide.apply(a,arguments)},c.__super__.constructor.apply(this,arguments)}return b(c,a),c.REPLIES_MAX_HEIGHT=375,c.prototype.className="modal pntlistitem-modal",c.prototype.initialize=function(a){return this.$el.html("<div class='modal-screen pntlistitem-modal'></div>\n<div class='modal-content pntlistitem-modal'>\n    <div class=\"modal-close pntlistitem-modal\" data-js-modal-close style='top: -31px; right: -6px;' >\n        <i class='pnticn-x_1x'></i>\n    <div>\n</div>"),this.$modalContent=this.$(".modal-content"),this.$modalContent.append(a.toAppend),this.pointView=a.pointView,this.model=this.pointView.model},c.prototype.events={"click .modal-screen":"hide","click [data-js-modal-close]":"hide","mouseenter .pntlistitem-meta .pnt-avatar":"onMouseEnterAvatar","mouseleave .pntlistitem-meta .pnt-avatar":"onMouseLeaveAvatar"},c.prototype.hide=function(){var a=this;return this.pointView.open=!1,this.$clickedEl?_.defer(function(){return a.$modalContent.transition({top:a.top-10},250),a.$(".pnt-quickreply-wrapper").transition({"max-height":0},250),a.$clickedEl.transition({opacity:100,delay:150},250),_.delay(function(){return a.$el.addClass("is-hidden")},0)}):this.$el.addClass("is-hidden"),this.model.trigger("modal:hidden"),this.trackEvent("Close Point Modal")},c.prototype.show=function(a,b){var d=this;return this.$clickedEl=a,this.$clickedEl?(this.top=this.$clickedEl.offset().top,this.$modalContent.css({top:this.top}),this.$(".pnt-quickreply-wrapper").css({"max-height":0}),_.defer(function(){return d.$modalContent.transition({top:30},450),d.$(".pnt-quickreply-wrapper").transition({"max-height":c.REPLIES_MAX_HEIGHT},450),d.$clickedEl.transition({opacity:0,delay:200},250)}),_.delay(function(){return b(),d.model.trigger("modal:visible")},450)):this.model.trigger("modal:visible")},c}(d.View),g=function(a){function c(){var a=this;return this.postAnimate=function(){return c.prototype.postAnimate.apply(a,arguments)},this.initWithModel=function(){return c.prototype.initWithModel.apply(a,arguments)},c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.className="point-list-item pntlistitem-modal",c.prototype.initialize=function(a){return this.mainView=a.mainView,this.$appendTo=a.appendTo,this.listenTo(d,"pointView:openModalPoint",this.openModalPoint)},c.prototype.openModalPoint=function(a,b){return this.open?void 0:(this.open=!0,b&&(this.$clickedEl=b,this.animate=!0),this.model=a,this.initWithModel())},c.prototype.initWithModel=function(){var a;return this.messages=this.model.messages,this.render(),this.model.afterFirstFetch||(this.messages.reset(),this.model.fetch({reset:!0})),null!=(a=this.messagesView)&&a.remove(),this.messagesView=new f({model:this.model,scroll:!0,el:this.$(".pnt-messages"),$msgCount:this.$msgCount,msgCount:this.messages.length})},c.prototype.remove=function(){return this.messagesView.remove(),this.modalView.remove(),c.__super__.remove.call(this)},c.prototype.render=function(){return c.__super__.render.call(this),this.modalView=new h({toAppend:this.$el,pointView:this}),this.$modalContent=this.modalView.$(".modal-content"),this.$appendTo.append(this.modalView.$el),this.modalView.show(this.$clickedEl,this.postAnimate),this.$input.focus()},c.prototype.postAnimate=function(){var a=this;return _.defer(function(){return a.messagesView.scrollToBottom(),a.$input.focus(),a.markAsRead()})},c.prototype.mxpSentFromProp="DD Point Modal",c.prototype.events={"click .pnt-omnibox":"focusOmniboxOnClick","click .pnt-content":"linkClicked","keypress .pnt-omnibox-input-box":"onKeypress"},c}(e)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/responsiveManagerView",["jquery","backbone"],function(a,c){var d;return d=function(c){function d(){var a=this;return this.doOnceAndListen=function(){return d.prototype.doOnceAndListen.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,c),d.prototype.el=a(window),d.prototype.getSize=function(){return this.name?this.name:(this.onResize(),this.name)},d.prototype.doOnceAndListen=function(a){return a(this.getSize()),this.listenTo(this,"sizeChange",a)},d.prototype.events={resize:"onResize"},d.prototype.onResize=function(){var a;return this.width=this.$el.width(),a=this.width>800?"fullScreen":this.width>340?"smallScreen":"dropdown",null==this.name||a!==this.name?(this.name=a,this.trigger(a),this.trigger("sizeChange",a)):void 0},d}(c.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/views/tooltipView",["jquery","backbone","common.config","jqTransit"],function(a,c){var d;return d=function(c){function d(){var a=this;return this.hide=function(b){return null==b&&(b={name:"none"}),d.prototype.hide.apply(a,arguments)},this.enter=function(){return d.prototype.enter.apply(a,arguments)},this.show=function(){return d.prototype.show.apply(a,arguments)},this.showDelay=function(){return d.prototype.showDelay.apply(a,arguments)},d.__super__.constructor.apply(this,arguments)}return b(d,c),d.prototype.className="pnt-tooltip pnt-master-tooltip",d.prototype.initialize=function(b){return this.$container=b.appendTo,this.$el.appendTo(this.$container),this.$content=a("<div class='pnt-tooltip-content'></div>").appendTo(this.$el),this.$triangle=a("<div class='pnt-tooltip-triangle'></div>").appendTo(this.$el),this.hide()},d.prototype.showDelay=function(a,b){var c=this;return this.cancelled=!1,this.timeout=_.delay(function(){return c.cancelled?void 0:c.show.call(c,b)},a)},d.prototype.tooltipClasses="pnt-mstr-tt-size-l\npnt-mstr-tt-no-arrow",d.DEFAULT_DURATION=250,d.prototype.configDefaults={innerHtml:"tooltip",div:a(window)[0],preferDirection:"top",alignment:"center",showArrow:!0,size:"",offset:{x:0,y:0},duration:-1,enterAnimation:{name:"none",duration:d.DEFAULT_DURATION},exitAnimation:{name:"none",duration:d.DEFAULT_DURATION}},d.prototype.show=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;switch(this.reset(),a=_.extend({},this.configDefaults,a),j=a.innerHtml,e=a.div,m=a.preferDirection,b=a.alignment,n=a.showArrow,o=a.size,l=a.offset,g=a.duration,h=a.enterAnimation,i=a.exitAnimation,this.$div=e,this.$el.show(),this._setInnerHTML(j),f=this.$div.offset(),d={},p={},o){case"large":this.$el.addClass("pnt-mstr-tt-size-l")}switch(m){case"top":if("left"!==b&&"center"!==b&&"right"!==b)throw"tooltip alignment must be left, center, or right";this.$el.addClass(".pnt-tt-arrow-bottom"),d.bottom=this.$container.height()-f.top+l.y,p.bottom=0;break;case"bottom":if("left"!==b&&"center"!==b&&"right"!==b)throw"tooltip alignment must be left, center, or right";this.$el.addClass(".pnt-tt-arrow-top"),d.top=f.top+this.$div.outerHeight()+l.y,p.top=0;break;case"left":if("top"!==b&&"center"!==b&&"bottom"!==b)throw"tooltip alignment must be top, center, or bottom";p.right=0;break;case"right":if("top"!==b&&"center"!==b&&"bottom"!==b)throw"tooltip alignment must be top, center, or bottom";p.left=0;break;case"center":d.top=f.top+(this.$div.outerHeight()-this.$el.outerHeight())/2+l.y,p.top=0}switch(b){case"left":d.left=f.left+l.x,p.left=9;break;case"right":d.right=this.$container.width()-f.left-l.x,p.right=9;break;case"top":d.top=f.top+this.$div.outerHeight()+l.y,p.top=9;break;case"bottom":d.bottom=f.top+this.$div.outerHeight()-l.y,p.bottom=9;break;default:"top"===m||"bottom"===m||"center"===m?(d.left=f.left-this.$content.outerWidth()/2+this.$div.outerWidth()/2,p.left="50%"):(d.top=f.top-this.$content.outerHeight()/2,p.top="50%")}return this.$el.css(d),this.$triangle.css(p),k=this.$el.offset(),c={top:k.top<0,left:k.left<0,bottom:k.top+this.$el.outerWidth>this.$container.width(),right:k.left+this.$el.outerWidth>this.$container.width()},c.left?("left"===m?a.preferDirection="right":("top"===m||"bottom"===m)&&(a.alignment="left"),this.show(a)):c.right?("right"===m?a.preferDirection="left":("top"===m||"bottom"===m)&&(a.alignment="right"),this.show(a)):c.top&&"top"===m?("top"===m?a.preferDirection="bottom":("left"===m||"right"===m)&&(a.alignment="top"),this.show(a)):c.bottom&&"bottom"===m?("bottom"===m?a.preferDirection="top":("left"===m||"right"===m)&&(a.alignment="bottom"),this.show(a)):(n||this.$el.addClass("pnt-mstr-tt-no-arrow"),this.enter(h),g>0?this.timeout=_.delay(this.hide,g,i):void 0)},d.prototype.enter=function(a){var b;if(this.$el.show(),"none"!==a.name){switch(a.name){case"fadeIn":this.$el.css({opacity:0});break;case"fadeInTop":this.$el.css({opacity:0,translate:[0,-15]});break;case"fadeInBottom":this.$el.css({opacity:0,translate:[0,15]});break;case"scaleIn":this.$el.css({opacity:0,scale:.9})}return this.$el.transition({opacity:1,translate:[0,0],scale:1,duration:null!=(b=a.duration)?b:d.DEFAULT_DURATION,easing:"in"})}},d.prototype.hide=function(a){var b,c=this;switch(null==a&&(a={name:"none"}),a.name){case"fadeOut":return this.$el.transition({opacity:0,duration:null!=(b=a.duration)?b:d.DEFAULT_DURATION,easing:"in",complete:function(){return c.$el.hide(),c.reset()}});default:return this.$el.hide(),this.reset()}},d.prototype.reset=function(){var a;return window.clearTimeout(this.timeout),this.cancelled=!0,this.$el.removeClass(this.tooltipClasses),a={top:"auto",bottom:"auto",left:"auto",right:"auto"},this.$el.css(a),this.$triangle.css(a),this.$content.css(a)},d.prototype._setInnerHTML=function(a){return this.$content.html(a)},d}(c.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b},c=[].slice;define("cs!views/MainView",["jquery","backbone","common.config","cs!common/browser/browser","cs!common/collections/pointCollection","cs!collections/searchablePointCollection","cs!views/loginView","cs!views/tabBarView","cs!views/InboxView","cs!views/settingsView","cs!views/friendsView","cs!views/alertView","cs!views/modalPointView","cs!views/responsiveManagerView","cs!common/views/tooltipView"],function(a,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r;return r=function(g){function h(){var a=this;return this.onSeeFriendsClicked=function(){return h.prototype.onSeeFriendsClicked.apply(a,arguments)},this.onFacebookLoginClicked=function(){return h.prototype.onFacebookLoginClicked.apply(a,arguments)},this.initView=function(){return h.prototype.initView.apply(a,arguments)},h.__super__.constructor.apply(this,arguments)}return b(h,g),h.INPUT_DELAY=800,h.prototype.id="main-view",h.prototype.el=a("#point-app-wrapper"),h.prototype.pageViews={inbox:{viewType:k,order:1,onRoute:function(a,b,c){return console.log(b,c),a.onRoute(b,c)}},friends:{viewType:m,order:2},settings:{viewType:l,order:5,onInit:function(a){return a.render()}}},h.prototype.initialize=function(){var b;return null==e.user.id||null==e.user.getAuth()?(this.loginView=new i({el:a("#login")}),this.loginView.show()):(this.$pageContainer=this.$(".dropdown-page-container"),e.badges=new d.Model({inbox:0,friends:0}),this.tabBarView=new j({el:this.$("#tab-bar-menu"),mainView:this}),this.listenTo(d,"searchTermChanged",this.onSearchTermChange),this.listenTo(d,"messageFlash:facebookLoginClicked",this.onFacebookLoginClicked),this.listenTo(d,"messageFlash:seeFriendsClicked",this.onSeeFriendsClicked),this.listenTo(d,"messageFlash:openFeedbackPage",this.onFeedbackClicked),this.listenTo(d,"openFirstPointPage",this.onFirstTimeClicked),this.listenTo(e.router,"route",this.onRoute),e.router.trackEvent=this.trackEvent,e.router.navigateLastRoute(),this.modalPointView=new o({mainView:this,appendTo:this.$el}),this.alertView=new n({appendTo:this.$el,mainView:this}),chrome.runtime.onMessage.addListener(function(a){var b;return(null!=(b=a.request)?b.indexOf("socket:message"):void 0)>-1&&d.trigger("dropdown:socket:message",a.details),!0}),null!=(b=chrome.runtime)&&"function"==typeof b.connect&&b.connect({name:"dropdown"}),e.views={responsiveManager:new p,tooltip:new q({appendTo:this.$el})})},h.prototype.initView=function(a){var b,d,e,f;return e=this.pageViews[a],d={appendTo:this.$pageContainer,mainView:this,order:e.order},e.collection&&(d.collection=this[e.collection]),b=e.viewType,e.viewInstance=new b(d),null!=e.onInit?(f=e.onInit).call.apply(f,[this,e.viewInstance].concat(c.call(arguments))):void 0},h.prototype.onRoute=function(){var a,b,d,e;return d=arguments[0],a=2<=arguments.length?c.call(arguments,1):[],_.has(this.pageViews,d)?(b=this.pageViews[d],null==b.viewInstance&&this.initView(d),null!=b.onRoute&&(e=b.onRoute).call.apply(e,[this,b.viewInstance].concat(c.call(a))),this.showPageView(d)):void 0},h.prototype.showPageView=function(a){var b;if(!_.has(this.pageViews,a))throw"Not a real list view.";if(null==(b=this.pageViews[a].viewInstance))throw"View not initialized.";return null==this.activePageView?this.activePageView=b.show():this.activePageView!==b?(this.activePageView.$("input").blur(),this.activePageView.order<b.order?(this.activePageView.hideLeft(),this.activePageView=b.enterRight()):(this.activePageView.hideRight(),this.activePageView=b.enterLeft())):void 0},h.prototype.onFacebookLoginClicked=function(){var a;return null!=(a=f.extension)?a.sendMessage({request:"open:login",details:{provider:"facebook"}}):void 0},h.prototype.onSeeFriendsClicked=function(){return e.router.navigate("friends/true",{trigger:!0})},h.prototype.onFirstTimeClicked=function(){return f.extension.sendMessage({request:"open:splashPage",details:{via:"dropdown"}})},h.prototype.onFeedbackClicked=function(a){return f.extension.sendMessage({request:"open:feedback",details:{message:a}})},h.prototype.events={keydown:"onBodyKeydown"},h.prototype.onBodyKeydown=function(a){return 9===(a.keyCode||a.which)?(d.trigger("keyDownTab",a),a.preventDefault()):void 0},h}(d.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!views/onboardingView",["backbone","common.config","cs!common/browser/browser"],function(a,c,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.initialize=function(){var a=this;return c.router.on("route:onboarding",function(b){return a.goTo(parseInt(b),!0)}),this.initPanels()},e.prototype.show=function(){return this.$el.removeClass("pnt-is-hidden").addClass("pnt-is-visible"),this.goTo(1,!1)},e.prototype.initPanels=function(){var a,b=this;return this.$back=$("#onboarding-back"),this.$next=$("#onboarding-next"),this.$breadcrumbs=$("#onboarding-breadcrumbs"),this.$animation=$("#onboarding-animation"),a=0,this.panels=_.object(_.map($(".onboarding-panel"),function(c){var d,e;return e=$(c),e.attr("data-panel",++a),d=$("<div class='onboarding-navigation-breadcrumb'\n     data-panel='"+a+"'>\n</div>"),b.$breadcrumbs.append(d),[a,{$el:e,$breadcrumb:d}]}))},e.prototype.goTo=function(a,b,e){var f;return null==b&&(b=!0),null!=this.activePanel&&(null!=e&&"left"===e&&this.activePanel.$el.addClass("pnt-is-hidden-right"),null!=e&&"right"===e?this.activePanel.$el.addClass("pnt-is-hidden-left"):this.activePanel.$el.addClass("pnt-is-hidden"),this.activePanel.$breadcrumb.removeClass("breadcrumb-is-active")),this.has(a)?(this.currentPanelNumber=a,this.activePanel=this.panels[a],this.activePanel.$el.removeClass("pnt-is-hidden pnt-is-hidden-left pnt-is-hidden-right"),this.activePanel.$breadcrumb.addClass("breadcrumb-is-active"),this.trackEvent("1UX: Onboarding Panel",{"Panel Number":a}),b&&c.router.navigate("onboarding/"+a),this.$el.attr("data-panel",a),this.has(a+1)&&this.$next.removeClass("pnt-is-invisible"),this.has(a-1)?this.$back.removeClass("pnt-is-invisible"):this.$back.addClass("pnt-is-invisible"),4===a?(f=function(){return d.extension.sendMessage({request:"chime:play",details:{animate:!1}})},setTimeout(f,1e3)):void 0):(c.user.setFlag("dd_onboarding"),delete window.localStorage.lastRoute,c.router.navigate("inbox",{trigger:!0}),this.$el.addClass("pnt-is-invisible"),void 0)},e.prototype.has=function(a){return _.has(this.panels,a)},e.prototype.events={"click #onboarding-back":"panelBack","click #onboarding-next":"panelNext"},e.prototype.panelBack=function(){return null!=this.currentPanelNumber?this.goTo(this.currentPanelNumber-1,!0,"left"):void 0},e.prototype.panelNext=function(){return null!=this.currentPanelNumber?this.goTo(this.currentPanelNumber+1,!0,"right"):void 0},e}(a.View)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/userModel",["backbone","common.config","cs!common/browser/browser"],function(a,c,d){var e;return e=function(e){function f(){var a=this;return this.saveSettings=function(){return f.prototype.saveSettings.apply(a,arguments)},this.isLoggedIn=function(){return f.prototype.isLoggedIn.apply(a,arguments)},this.isMe=function(){return f.prototype.isMe.apply(a,arguments)},this.hasFlag=function(){return f.prototype.hasFlag.apply(a,arguments)},this.save=function(){return f.prototype.save.apply(a,arguments)},this.setFlag=function(b,c){return null==c&&(c={}),f.prototype.setFlag.apply(a,arguments)},this.simple=function(){return f.prototype.simple.apply(a,arguments)},this.afterStorageSave=function(){return f.prototype.afterStorageSave.apply(a,arguments)},this.saveToStorage=function(){return f.prototype.saveToStorage.apply(a,arguments)},this.onStorageChange=function(){return f.prototype.onStorageChange.apply(a,arguments)},this.onAuthChange=function(){return f.prototype.onAuthChange.apply(a,arguments)},this.getAuth=function(){return f.prototype.getAuth.apply(a,arguments)},this.setAuth=function(){return f.prototype.setAuth.apply(a,arguments)},this.logOut=function(){return f.prototype.logOut.apply(a,arguments)},this.load=function(b){return null==b&&(b={}),f.prototype.load.apply(a,arguments)},f.__super__.constructor.apply(this,arguments)}return b(f,e),f.prototype.defaults=function(){return{flags:[],settings:{email_cc_invites:!0,email_new_points:!0,email_new_activity:!0}}},f.prototype.saving=!1,f.prototype.token="pnt_user",f.prototype.authToken="pnt_token",f.prototype.urlRoot=c.baseURL+"users",f.prototype.idAttribute="_id",f.prototype.initialize=function(b,c){return null==c&&(c={}),this.listenTo(this,"sync",this.saveToStorage),this.listenTo(a,"storage:pnt_user",this.onStorageChange,this),this.listenTo(a,"storage:pnt_token",this.onAuthChange,this),this.debouncedSaveSettings=_.debounce(this.saveSettings,500),null!=c.master?this.master=c.master:void 0},f.prototype.load=function(a){var b=this;return null==a&&(a={}),d.storage.get(["pnt_user","pnt_token"],function(c){return null!=c.pnt_token&&b.setAuth(c.pnt_token),null!=c.pnt_user&&b.set(c.pnt_user),"function"==typeof a.success?a.success(b,b.toJSON(),a):void 0})},f.prototype.logOut=function(){var a;return this.setAuth(null),d.storage.remove("pnt_token"),d.storage.remove(["pnt_friends","pnt_notifs"],"local"),a=this.get("flags"),this.clear(),this.setFlag(a,{silent:!0}),this.saveToStorage()},f.prototype.setAuth=function(a){return this._authorization=a},f.prototype.getAuth=function(){return this._authorization},f.prototype.onAuthChange=function(a){return this.setAuth(a.newValue)},f.prototype.onStorageChange=function(a){var b,c;return this.saving?this.saving=!1:(b=null!=(c=this.get("flags"))?c:[],this.clear(),null!=a.newValue&&(this.set(a.newValue),this.master&&b.length)?_.defer(this.setFlag,b):void 0)
},f.prototype.saveToStorage=function(){return this.saving=!0,_.delay(this.afterStorageSave,1e3),d.storage.set({pnt_user:this.toJSON()})},f.prototype.afterStorageSave=function(){return this.saving=!1},f.prototype.simple=function(){var a;return a={uid:this.id,name:this.get("name")},null!=this.get("id")&&(a.id=this.get("id")),null!=this.get("gid")&&(a.gid=this.get("gid")),null!=this.get("gmail")&&(a.gmail=this.get("gmail")),a},f.prototype.setFlag=function(a,b){var c;return null==b&&(b={}),_.isArray(a)||(a=[a]),a=_.chain(a).compact().uniq().reject(this.hasFlag).value(),a.length?(c=(this.get("flags")||[]).concat(a),b.silent?this.set("flags",c,b):this.save("flags",c,b)):void 0},f.prototype.save=function(a,b){var c,d;return null===a||"object"==typeof a?(c=a,d=b):(c={})[a]=b,null==this.id||null==this.getAuth()?(null!=c&&this.set(c,d),this.saveToStorage(d),void 0):(_.isEmpty(c)&&(c=this.changedAttributes()),_.isEmpty(c)?!1:(d=_.extend({patch:!0},d),f.__super__.save.call(this,c,d)))},f.prototype.hasFlag=function(a){return _.contains(this.get("flags"),a)},f.prototype.hasPointed=function(){return this.get("pnts_sent")>0},f.prototype.isMe=function(a){return null!=a&&(a===this.id||a===this.get("id"))},f.prototype.isAuthedWith=function(a){return null!=_.findWhere(this.get("accounts"),{provider:a})},f.prototype.hasFacebook=function(){return this.isAuthedWith("facebook")},f.prototype.hasGoogle=function(){return this.isAuthedWith("google")},f.prototype.getGdomain=function(){var a,b,c,d,e;for(d=this.get("accounts"),b=0,c=d.length;c>b;b++)if(a=d[b],-1===(null!=(e=a.dom)?e.indexOf(".edu"):void 0))return a.dom},f.prototype.isLoggedIn=function(){return null!=this.id&&null!=this.getAuth()},f.prototype.getSettings=function(){return this.get("settings")},f.prototype.getSetting=function(a){var b;return b=this.getSettings()[a],null!=b?b:!1},f.prototype.saveSettings=function(){return this.save("settings",this.getSettings())},f.prototype.updateSetting=function(a,b){var c;return c=_.clone(this.getSettings()),c[a]=b,this.set("settings",c),this.debouncedSaveSettings()},f}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/models/notificationModel",["backbone","common.config"],function(a,c){var d;return d=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.prototype.urlRoot=c.notifBaseURL+"notifications",d.prototype.idAttribute="_id",d}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/notificationCollection",["backbone","common.config","cs!common/browser/browser","cs!common/models/notificationModel"],function(a,c,d,e){var f;return f=function(f){function g(){var a=this;return this.bundle=function(){return g.prototype.bundle.apply(a,arguments)},this.count=function(){return g.prototype.count.apply(a,arguments)},this.saveToStorage=function(){return g.prototype.saveToStorage.apply(a,arguments)},this.clearAll=function(){return g.prototype.clearAll.apply(a,arguments)},g.__super__.constructor.apply(this,arguments)}return b(g,f),g.TYPES={point:{badge:!0},"friends:request":{},"friends:accepted":{bundle:!0},"friends:new":{bundle:!0},"fb:expired":{bundle:!0},"engage:feedback":{}},g.prototype.model=e,g.prototype.saving=!1,g.prototype.token="pnt_notifs",g.prototype.initialize=function(){var b;return _.bindAll(this,"load","onStorageChange","saveToStorage","afterStorageSave"),this.listenTo(a,"storage:pnt_notifs",this.onStorageChange),this.debouncedSave=_.debounce(this.saveToStorage,100),b=_.debounce(this.onAdjustment,100),this.listenTo(this,"add",b),this.listenTo(this,"change",b),this.listenTo(this,"remove",b)},g.prototype.url=c.notifBaseURL+"notifications",g.prototype.load=function(a){var b=this;return null==a&&(a={}),d.storage.get(this.token,function(c){var d;return null!=(d=c[b.token])&&b.reset(d),"function"==typeof a.success?a.success(b,d,a):void 0},"local")},g.prototype.clearAll=function(){return a.ajax({url:c.notifBaseURL+"clear"}),this.reset(),this.saveToStorage()},g.prototype.requestRemoval=function(a){return d.extension.sendMessage({request:"remove:notification",details:{id:a}})},g.prototype.onStorageChange=function(a){return this.saving?this.saving=!1:this.reset(a.newValue)},g.prototype.saveToStorage=function(){var a;return a={},a[this.token]=this.toJSON(),this.saving=!0,_.delay(this.afterStorageSave,1e3),d.storage.set(a,"local")},g.prototype.afterStorageSave=function(){return this.saving=!1},g.prototype.onAdjustment=function(){return this.debouncedSave()},g.prototype.remove=function(a,b){var c;return null==b&&(b={}),c=g.__super__.remove.call(this,a,b),null==c||b.remove||this.destroy(c),c},g.prototype.destroy=function(b){var c,d;if(d=b,d instanceof Array){if(c={destroy:[]},d.forEach(function(a){return(null!=a?a.toJSON:void 0)?c.destroy.push(a.toJSON()):void 0}),!c.destroy.length)return}else d instanceof a.Model&&(d=d.toJSON()),c={destroy:d};return a.ajax({type:"POST",url:this.url,data:c})},g.prototype.count=function(){var a,b,c,d,e;a=0,e=g.TYPES;for(d in e)if(b=e[d],b.bundle)null!=this.findWhere({type:d})&&a++;else{if(c=this.where({type:d}),!c.length)continue;b.badge||(c=_.reject(c,function(a){return a.get("silent")})),a+=c.length}return a},g.prototype.bundle=function(){var a,b,c,d,e,f;if(!this.length)return[];e=[],d=this.groupBy("type");for(f in d)b=d[f],c=g.TYPES[f],null!=c?c.bundle?(a=b[0].toJSON(),a.ids=[],a.value=[],a.bundle=!0,b.forEach(function(b){return a.ids.push(b.id),a.value.push(b.get("value"))}),e.push(a)):b.forEach(function(a){return e.push(a.toJSON())}):b.forEach(function(a){return a.set("silent",!0)});return e},g.prototype.isValidType=function(a){return null!=g.TYPES[a]},g}(a.Collection)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};define("cs!common/collections/hashtagCollection",["backbone","common.config","cs!common/models/hashtagModel"],function(a,c,d){var e;return e=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,a),e.prototype.model=d,e.prototype.fetched=!1,e.prototype.initialize=function(){var a=this;return this.listenToOnce(this,"sync",function(){return a.fetched=!0})},e.prototype.url=function(){return c.baseURL+"hashtags/user/"+c.user.id},e}(a.Collection)})}.call(this),function(){define("cs!application",["common.config","backbone","cs!routers/applicationRouter","cs!views/MainView","cs!views/onboardingView","cs!common/models/userModel","cs!common/collections/notificationCollection","cs!common/collections/hashtagCollection","cs!common/collections/friendsCollection","cs!common/modules/encryptor","cs!common/browser/browser"],function(a,b,c,d,e,f,g,h,i,j,k){var l;return l=function(){function h(){var a=this;this.onUserLoad=function(){return h.prototype.onUserLoad.apply(a,arguments)}}return h.prototype.initialize=function(){return a.router=new c,a.friends=new i([],{fetchIfEmpty:!0,canModify:!0}),a.friends.load(),this.onboardingView=new e({el:$("#onboarding")}),this.fetchCurrentTab(),null!=k.storage&&(a.notifications=new g,a.user=new f,a.user.load({success:this.onUserLoad}),k.storage.addListener(this.onStorageChange),k.extension.sendMessage({dropdown_opened:!0}),b.on("unauthorized",this.deauthorizeUser,this)),_.defer(function(){return k.extension.sendMessage({request:"dropdown:opened"})})},h.prototype.onUserLoad=function(){var b,c;return null!=(b=a.user.getAuth())&&j.setEncryptor(b),(!a.user.hasFlag("dd_onboarding")||(null!=(c=a.DEV)?c.showOnboarding:void 0))&&this.onboardingView.show(),this.start()},h.prototype.start=function(){return this.mainView=new d({onboardingView:this.onboardingView})},h.prototype.fetchCurrentTab=function(){return chrome.tabs.getSelected(function(a){return window.currentTab=a})},h.prototype.deauthorizeUser=function(){return k.storage.remove("pnt_token"),a.user.setAuth(null)},h.prototype.onStorageChange=function(a){return null!=a.pnt_token?window.location.reload():_.each(_.keys(a),function(c){return b.trigger("storage:"+c,a[c])})},h}()})}.call(this),require(["cs!application","common.config"],function(a,b){b.eventNameSpace="dd",app=new a,app.initialize()}),define("main",function(){});