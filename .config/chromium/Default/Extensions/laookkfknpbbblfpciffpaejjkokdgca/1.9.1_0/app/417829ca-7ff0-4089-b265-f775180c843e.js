var fn_addin=function(o,r,t){var s=s||{};return s.styles=s.styles||{},s.commands=s.commands||{},s.dependencies=t||s.dependencies||{},s.styles.style=function(){},s.views=s.views||{},s.collect=s.collect||{},s.models=s.models||{},s.templates=s.templates||{},s.info={id:"links_common",class:"links",appClass:"links-app",region:"top-left",order:"prepend",width:220,addin:"417829ca-7ff0-4089-b265-f775180c843e",toggleEvent:"globalEvent:key:L",closeOnEsc:"true",visibleSetting:"linksVisible"},o.console.log(o.elapsed()+": "+s.info.id+" started"),s.templates=s.templates||{},s.templates["quicklinks-item-template"]=Handlebars.template({1:function(t,e,i,n){return' class="local"'},3:function(t,e,i,n){var s;return null!=(s=e.if.call(t,null!=t?t.hasUrls:t,{name:"if",hash:{},fn:this.program(4,n,0),inverse:this.program(6,n,0),data:n}))?s:""},4:function(t,e,i,n){return'<svg class="folder-icon" xmlns="http://www.w3.org/2000/svg" width="510" height="510" viewBox="0 0 510 510"><path d="M204 51H51C22.95 51 0 73.95 0 102v306c0 28.05 22.95 51 51 51h408c28.05 0 51-22.95 51-51V153c0-28.05-22.95-51-51-51H255l-51-51z"/></svg>\n\t'},6:function(t,e,i,n){var s;return null!=(s=e.if.call(t,null!=t?t.favicon_url:t,{name:"if",hash:{},fn:this.program(7,n,0),inverse:this.program(9,n,0),data:n}))?s:""},7:function(t,e,i,n){var s;return'<img src="'+this.escapeExpression("function"==typeof(s=null!=(s=e.favicon_url||(null!=t?t.favicon_url:t))?s:e.helperMissing)?s.call(t,{name:"favicon_url",hash:{},data:n}):s)+'">'},9:function(t,e,i,n){return'\n\t\t<span class="link-icon-placeholder">&nbsp;</span>'},11:function(t,e,i,n){var s;return null!=(s=e.if.call(t,null!=t?t.noMenu:t,{name:"if",hash:{},fn:this.program(12,n,0),inverse:this.program(14,n,0),data:n}))?s:""},12:function(t,e,i,n){return'\t\t\t<div class="icon-wrapper destroy"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212.982 212.982" class="icon icon-hide"><path d="M131.804 106.491l75.936-75.936c6.99-6.99 6.99-18.323 0-25.312-6.99-6.99-18.322-6.99-25.312 0L106.491 81.18 30.554 5.242c-6.99-6.99-18.322-6.99-25.312 0-6.989 6.99-6.989 18.323 0 25.312l75.937 75.936-75.937 75.937c-6.989 6.99-6.989 18.323 0 25.312 6.99 6.99 18.322 6.99 25.312 0l75.937-75.937 75.937 75.937c6.989 6.99 18.322 6.99 25.312 0 6.99-6.99 6.99-18.322 0-25.312l-75.936-75.936z"/></svg></div>\n'},14:function(t,e,i,n){var s;return'\t<div class="dropdown-wrapper">\n\t\t<div class="icon-wrapper more"><i class="icon-ellipsis more-icon"></i></div>\n\n\t\t<div class="dropdown more-dropdown">\n\t\t\t<ul class="dropdown-list">\n'+(null!=(s=e.if.call(t,null!=t?t.showPinOption:t,{name:"if",hash:{},fn:this.program(15,n,0),inverse:this.noop,data:n}))?s:"")+(null!=(s=e.if.call(t,null!=t?t.hasUrls:t,{name:"if",hash:{},fn:this.program(17,n,0),inverse:this.noop,data:n}))?s:"")+'\t\t\t\t<li class="destroy">\n\t\t\t\t\t<span class="item-label">Delete</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n'},15:function(t,e,i,n){var s;return'\t\t\t\t<li class="link-pin toggleable '+this.escapeExpression("function"==typeof(s=null!=(s=e.pinnedClass||(null!=t?t.pinnedClass:t))?s:e.helperMissing)?s.call(t,{name:"pinnedClass",hash:{},data:n}):s)+'">\n\t\t\t\t\t<span class="item-label pin">Pin</span>\n\t\t\t\t\t<span class="item-label unpin">Unpin</span>\n\t\t\t\t</li>\n'},17:function(t,e,i,n){return'\t\t\t\t<li class="detail">\n\t\t\t\t\t<span class="item-label">Modify</span>\n\t\t\t\t</li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,i,n){var s,l,a=e.helperMissing,o="function",r=this.escapeExpression;return'<div draggable="true" class="link-wrapper '+r(typeof(l=null!=(l=e.classes||(null!=t?t.classes:t))?l:a)==o?l.call(t,{name:"classes",hash:{},data:n}):l)+'">\n\t<div class="status">Opening...</div>\n\t<a draggable="false" href="'+r(typeof(l=null!=(l=e.url||(null!=t?t.url:t))?l:a)==o?l.call(t,{name:"url",hash:{},data:n}):l)+'"'+(null!=(s=e.if.call(t,null!=t?t.local:t,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?s:"")+">"+(null!=(s=e.unless.call(t,null!=t?t.noIcon:t,{name:"unless",hash:{},fn:this.program(3,n,0),inverse:this.noop,data:n}))?s:"")+' <span class="link-text">'+r(typeof(l=null!=(l=e.title||(null!=t?t.title:t))?l:a)==o?l.call(t,{name:"title",hash:{},data:n}):l)+"</span></a>\n"+(null!=(s=e.unless.call(t,null!=t?t.readOnly:t,{name:"unless",hash:{},fn:this.program(11,n,0),inverse:this.noop,data:n}))?s:"")+"</div>\n"},useData:!0}),s.templates.quicklinks=Handlebars.template({1:function(t,e,i,n){return'\t\t\t\t\t\t<li data-momo-id="chromeTab" data-place="links" class="optional-link"><a\n\t\t\t\t\t\t\thref="chrome-search://local-ntp/local-ntp.html" class="local">\n\t\t\t\t\t\t\t<svg class="icon-favicon icon-svg icon-chrome-tab" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t\t\t\t viewBox="0 0 497.401 497.401"><g><path\n\t\t\t\t\t\t\t\t\t\td="M478.742 154.382H320.714c28.366 21.765 47.111 55.717 47.111 94.307 0 30.63-14.345 56.386-30.933 79.445-28.322 39.41-95.817 168.878-95.817 168.878 2.567.043 5.026.388 7.636.388 137.341 0 248.69-111.348 248.69-248.69-.022-33.412-6.709-65.229-18.659-94.328z"/><path\n\t\t\t\t\t\t\t\t\t\td="M248.172 129.619c54.402-.388 217.628-2.049 217.628-2.049C423.24 51.511 342.069 0 248.69 0 170.819 0 101.361 35.829 55.782 91.848l75.972 134.925c10.268-55.113 58.349-96.744 116.418-97.154z"/><path\n\t\t\t\t\t\t\t\t\t\td="M248.668 367.825c-51.964 0-91.568-35.117-111.974-79.855-20.535-45.018-98.061-171.984-98.061-171.984C14.301 154.425 0 199.832 0 248.69c0 124.744 91.935 227.744 211.696 245.648l77.288-134.019c-12.641 4.615-26.101 7.506-40.316 7.506z"/><circle cx="248.668" cy="248.711" r="80.416"/></g></svg>\n\t\t\t\t\t\t\tChrome Tab</a></li>\n\t\t\t\t\t\t<li data-momo-id="apps" class="optional-link" data-place="links"><a href="chrome://apps" id="app-return" class="local">\n\t\t\t\t\t\t\t<svg class="icon-favicon icon-svg icon-apps" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M3 3h6v6H3V3zm10 0h6v6h-6V3zm10 0h6v6h-6V3zM3 13h6v6H3v-6zm10 0h6v6h-6v-6zm10 0h6v6h-6v-6zM3 23h6v6H3v-6zm10 0h6v6h-6v-6zm10 0h6v6h-6v-6z"/></svg>\n\t\t\t\t\t\t\tApps</a></li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,i,n){var s,l;return'<div class="subviews-wrapper">\n\t<div class="subviews no-transition">\x3c!--\n\n\n\t--\x3e<div class="subview main-subview">\n\t\t\t\x3c!-- <header class="header">\n\t\t\t\t<span class="title">Links</span>\n\t\t\t\t<div class="controls">\n\t\t\t\t</div>\n\t\t\t</header> --\x3e\n\t\t\t<div class="body">\n\n\t\t\t\t<div class="message"><i class="loading-icon"></i><span class="loading-label">Loading...</span></div>\n\t\t\t\t<ol class="links-list" style="max-height:'+this.escapeExpression("function"==typeof(l=null!=(l=e.maxHeight||(null!=t?t.maxHeight:t))?l:e.helperMissing)?l.call(t,{name:"maxHeight",hash:{},data:n}):l)+'px">\n'+(null!=(s=e.if.call(t,null!=t?t.isChrome:t,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?s:"")+'\t\t\t\t</ol>\n\t\t\t\t<div class="empty">\n\t\t\t\t\t<div class="title">No links yet</div>\n\t\t\t\t\t<div class="description">Add your favorite links</div>\n\t\t\t\t\t<span class="button new-toggle empty-toggle new-single-toggle">New Link</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="footer-input new">\n\t\t\t\t\t<div class="icon-wrapper new-hide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212.982 212.982" class="icon icon-hide"><path d="M131.804 106.491l75.936-75.936c6.99-6.99 6.99-18.323 0-25.312-6.99-6.99-18.322-6.99-25.312 0L106.491 81.18 30.554 5.242c-6.99-6.99-18.322-6.99-25.312 0-6.989 6.99-6.989 18.323 0 25.312l75.937 75.936-75.937 75.937c-6.989 6.99-6.989 18.323 0 25.312 6.99 6.99 18.322 6.99 25.312 0l75.937-75.937 75.937 75.937c6.989 6.99 18.322 6.99 25.312 0 6.99-6.99 6.99-18.322 0-25.312l-75.936-75.936z"/></svg></div>\n\t\t\t\t\t<input type="text" id="new-title" class="new-single-title new-title new-toggle new-single-toggle" placeholder="New Link" autocomplete="off">\n\t\t\t\t\t<input type="text" id="new-url" class="new-url new-single-url" placeholder="URL" autocomplete="off">\n\t\t\t\t\t<button class="button new-group-toggle new-footer"><span class="icon">+</span> Open Multiple Tabs</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\x3c!--\n\n\n\t\t--\x3e<div class="subview add-subview links-add">\n\t\t\t<header class="header">\n\t\t\t\t<span class="control icon-wrapper back"><i class="icon icon-left"></i></span>\n\n\t\t\t\t<span class="title add-mode">Add Tab Group</span>\n\t\t\t\t<span class="title edit-mode">Edit Tab Group</span>\n\n\t\t\t\t<div class="edit-mode controls">\n\t\t\t\t\t<div class="control more">\n\t\t\t\t\t\t<div class="icon-wrapper more-toggle">\n\t\t\t\t\t\t\t<i class="icon-ellipsis more-icon"></i>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="dropdown more-dropdown">\n\t\t\t\t\t\t\t<ul class="dropdown-list">\n\t\t\t\t\t\t\t\t<li class="delete">Delete</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</header>\n\n\t\t\t<div class="body">\n\t\t\t\t<div class="input-group">\n\t\t\t\t\t<label for="new-title">Name</label>\n\t\t\t\t\t<input type="text" id="new-title" class="new-title new-group-title">\n\t\t\t\t</div>\n\n\t\t\t\t<label>Links</label>\n\t\t\t\t<ol class="urls">\n\t\t\t\t</ol>\n\n\t\t\t\t<input type="text" class="new-url new-group-url" placeholder="URL">\n\t\t\t\t<span class=\'add-tab\'>+ Add Tab</span>\n\t\t\t</div>\n\t\t</div>\n\n\n\t</div>\n</div>\n'},useData:!0}),s.templates.teamlinks=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,i,n){var s,l=e.helperMissing,a="function",o=this.escapeExpression;return'<div class="app-dash">\n\t<div class="team-dash-links-wrapper">\n\t\t<ol class="team-dash-links add-shadow"></ol>\n\t\t<span class="more-links">'+o(typeof(s=null!=(s=e.moreDropdownText||(null!=t?t.moreDropdownText:t))?s:l)==a?s.call(t,{name:"moreDropdownText",hash:{},data:n}):s)+'<i class="icon icon-angle-down"></i></span>\n\t</div>\n</div>\n\n<div class="app-wrapper nipple-top-left">\n\t<div class="app links-app">\n\t\t<div class="subviews-wrapper">\n\t\t\t<div class="subviews no-transition">\x3c!--\n\t\t\t--\x3e<div class="subview main-subview">\n\t\t\t\t\t<div class="body">\n\t\t\t\t\t\t<ol class="more-links-list" style="max-height: '+o(typeof(s=null!=(s=e.maxHeight||(null!=t?t.maxHeight:t))?s:l)==a?s.call(t,{name:"maxHeight",hash:{},data:n}):s)+'px"></ol>\n\t\t\t\t\t\t<div class="add-error-message message">Connection required to add link. <span\n\t\t\t\t\t\t\tclass="message-action retry-add">Retry</span></div>\n\t\t\t\t\t\t<div class="message-empty"><i class="loading-icon"></i>Loading...</div>\n\n\t\t\t\t\t\t<div class="footer-input new">\n\t\t\t\t\t\t\t<div class="icon-wrapper new-hide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212.982 212.982" class="icon icon-hide"><path d="M131.804 106.491l75.936-75.936c6.99-6.99 6.99-18.323 0-25.312-6.99-6.99-18.322-6.99-25.312 0L106.491 81.18 30.554 5.242c-6.99-6.99-18.322-6.99-25.312 0-6.989 6.99-6.989 18.323 0 25.312l75.937 75.936-75.937 75.937c-6.989 6.99-6.989 18.323 0 25.312 6.99 6.99 18.322 6.99 25.312 0l75.937-75.937 75.937 75.937c6.989 6.99 18.322 6.99 25.312 0 6.99-6.99 6.99-18.322 0-25.312l-75.936-75.936z"/></svg></div>\n\t\t\t\t\t\t\t<input type="text" class="new-single-title new-title new-toggle new-single-toggle"\n\t\t\t\t\t\t\t\t   placeholder="New Link">\n\t\t\t\t\t\t\t<input type="text" class="new-url new-single-url" placeholder="URL">\n\t\t\t\t\t\t\t<button class="button new-group-toggle new-footer"><span class="icon">+</span> Open Multiple\n\t\t\t\t\t\t\t\tTabs\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\x3c!--\n\n\n\t\t\t--\x3e<div class="subview add-subview links-add">\n\t\t\t\t\t<header class="header">\n\t\t\t\t\t\t<span class="control icon-wrapper back"><i class="icon icon-left"></i></span>\n\n\t\t\t\t\t\t<span class="title add-mode">Add Tab Group</span>\n\t\t\t\t\t\t<span class="title edit-mode">Edit Tab Group</span>\n\n\t\t\t\t\t\t<div class="edit-mode controls">\n\t\t\t\t\t\t\t<div class="control more">\n\t\t\t\t\t\t\t\t<div class="icon-wrapper more-toggle">\n\t\t\t\t\t\t\t\t\t<i class="icon-ellipsis more-icon"></i>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class="dropdown more-dropdown">\n\t\t\t\t\t\t\t\t\t<ul class="dropdown-list">\n\t\t\t\t\t\t\t\t\t\t<li class="delete">Delete</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</header>\n\n\t\t\t\t\t<div class="body">\n\t\t\t\t\t\t<div class="input-group">\n\t\t\t\t\t\t\t<label for="new-title">Name</label>\n\t\t\t\t\t\t\t<input type="text" id="new-title" class="new-title new-group-title">\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<label>Links</label>\n\t\t\t\t\t\t<ol class="urls">\n\t\t\t\t\t\t</ol>\n\n\t\t\t\t\t\t<input type="text" id="new-url" class="new-url new-group-url" placeholder="URL">\n\t\t\t\t\t\t<span class=\'add-tab\'>+ Add Tab</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n\t\t\t</div>\x3c!--\n\t --\x3e</div>\n\t</div>\n</div>\n'},useData:!0}),s.styles=s.styles||{},s.styles.style=function(){var t=document.createElement("style");t.type="text/css",t.innerHTML=".links{--app-width:260px}.links.wide{--app-width:310px}.links.wider{--app-width:360px}.links.widest{--app-width:410px}.links-wrapper{position:absolute;top:100%;left:7px;display:none}.links-app{width:var(--app-width);min-width:200px;padding:0;overflow-y:hidden;transition-property:opacity,height}.links .links-list{overflow-y:auto}.links .links-list .optional-link.show{display:flex}.links input:hover{opacity:1}.links li{position:relative}.links li .link-wrapper{display:flex;justify-content:space-between}.links li .status{opacity:0;position:absolute;top:0;right:10px;font-size:.9rem;padding:4px;font-style:italic;transition:opacity .2s;z-index:-1}.links li.opening .status{opacity:.7;z-index:1}.links li a{min-width:125px;max-width:calc(var(--app-width) - 67px);padding:5px 10px 5px var(--app-padding);display:inline-block;flex:1 0 auto;cursor:pointer;font-size:1rem;line-height:100%;opacity:.75;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.links li.placeholder a{display:inherit}.links li a:hover{opacity:1}.light .app .links li a{opacity:.8}.links .folder-icon{fill:#fff}.light .links .app .folder-icon{fill:#000}.links .first-link .link-wrapper .icon-wrapper,.links .first-link a{padding-top:calc(var(--app-padding) - 1px)}.links.show-message .first-link a{margin-top:-20px}.links .first-link .destroy{top:auto;bottom:2px}.links .dropdown-wrapper{display:flex;align-item:flex-end;position:relative}.links .icon-wrapper,.links li.opening .dropdown-wrapper{opacity:0}.links .link-wrapper .icon-wrapper{padding:4px;padding-right:calc(var(--app-padding) - 1px);opacity:0}.links .icon{opacity:.4;margin:0}.links li.active .icon-wrapper,.links li:hover .icon-wrapper{opacity:1}.links .more-dropdown{margin-top:3px;right:calc(50% + 8px)}.links .icon-wrapper:hover .icon{opacity:.8}.links .dropdown-wrapper .icon-wrapper{padding:4px;padding-right:calc(var(--app-padding) - 5px)}.links .new{--margin-left:calc(var(--app-padding) - 3px);display:none;overflow:visible}.links .new input{padding:4px var(--padding-right) calc(var(--app-padding) - 3px) var(--margin-left);cursor:pointer}.links .open.new input{padding:4px var(--padding-right) 4px var(--margin-left);cursor:pointer}.links .open.new>.new-single-url{padding-bottom:var(--app-padding)}.links .open.new>.new-single-title{display:block;text-align:left}.links .new .icon-wrapper{position:absolute;right:13px;z-index:10;top:2px}.links .new-url{padding-top:3px!important}.links .new-single-url{display:none}.links .open>.new-single-url{display:block}.links:not(.teamlinks).is-empty .footer-input{position:absolute;right:0;bottom:0;left:0}.links:not(.teamlinks).is-empty .footer-input .new-title{display:none}.links:not(.teamlinks).is-empty .new.open .new-title{display:block}.links .new-hide:after{height:22px;width:22px}.links .new.open .icon-wrapper{margin-top:3px;opacity:1}.links .new-group-toggle{margin-left:var(--margin-left);margin-bottom:var(--app-padding);padding:4px 14px;display:none;opacity:.7;font-size:.8rem}.links .new-group-toggle .icon{margin-top:-2px;display:inline-block;opacity:1;vertical-align:10%}.links .message{margin:15px 0;display:none}.links.show-message .message{display:block}.links.show-message .empty{margin-top:-25px}.links .header .icon-wrapper{opacity:inherit}.links .header .filler{width:20px}.links .link-pin.active .pin,.links .unpin{display:none}.links .link-pin.active .unpin{display:inline-block}.links-add .urls .link-icon-placeholder,.links-add .urls img,.links:not(.teamlinks).is-empty .new-footer{display:none}.links .subviews{width:calc(var(--app-width) * 4);transition:all .3s ease}.links .subviews.no-transition{transition:none}.links .subview{width:var(--app-width)}.links .main-subview .body{padding:0;position:relative}.links-add .body{max-height:calc(100% - var(--header-height) - var(--app-padding));padding:0 var(--app-padding) calc(var(--app-padding) + 8px);box-sizing:border-box;overflow-y:auto}.links-add .header .title{position:absolute;left:0;right:0;z-index:-1;text-align:center}.links-add .urls{margin:8px 0 4px}.links-add .urls li a{padding:4px 0;opacity:1;box-sizing:border-box}.links-add .urls .destroy{margin-right:-5px;padding-right:5px;font-size:11px;line-height:12px;opacity:1}.links-add .edit-mode{visibility:hidden}.links-add.editing .edit-mode{visibility:visible}.links-add.editing .add-mode{visibility:hidden}.links-add .add-tab{display:inline-block;margin-top:var(--app-padding);cursor:pointer;font-size:.9rem;opacity:.6}.links-add .add-tab:hover{opacity:.8}.teamlinks{padding-left:0}.team-dash-links-wrapper{--first-link-top-padding:9px;--more-links-vert-padding:7px;position:absolute;top:100%;left:0;z-index:4}.has-no-logo .team-dash-links-wrapper{top:calc(100% - var(--more-links-vert-padding))}.team-dash-links li a{padding-top:4px;padding-bottom:4px;padding-left:var(--dash-side-margin);color:#fff;font-size:.9375rem;font-weight:400;opacity:.85}.show .team-dash-links li:hover .icon-wrapper,.team-dash-links li a:hover{opacity:1}.team-dash-links .first-link a{padding-top:var(--first-link-top-padding)}.team-dash-links .first-link .link-wrapper .icon-wrapper{padding-top:calc(var(--first-link-top-padding) - 4px)}.team-dash-links .icon-hide{fill:#fff}.team-dash-links .icon-wrapper:hover:after{background:rgba(255,255,255,.12)}.team-dash-links .icon-wrapper:active:after{background:rgba(255,255,255,.18)}.teamlinks .more-links{width:125px;padding:var(--more-links-vert-padding) var(--dash-side-margin);display:block;opacity:0;cursor:pointer;font-size:.75rem;font-weight:500;line-height:100%;text-transform:uppercase;transition:opacity ease;transition-duration:.1s}.teamlinks .more-links:hover{opacity:.8!important}.team-dash-links-wrapper:hover .more-links,.top-left:hover .team-links .more-links{opacity:.6}.teamlinks.show-fade-in .more-links{opacity:.6!important}.teamlinks .more-links .icon{margin-left:2px;opacity:1;font-size:.8125rem}.teamlinks .app-wrapper{position:absolute;transition-property:opacity,height,transform;z-index:5}.teamlinks .app li a{padding:6px calc(var(--app-padding) - 3px)}.teamlinks .app li:first-child .icon-wrapper,.teamlinks .app li:first-child a{padding-top:calc(var(--app-padding) - 3px)}.team-dash-links li a img{display:none}.teamlinks .no-extra .footer-input .new-hide{top:16px}.teamlinks .no-extra .footer-input .new-title{padding-top:16px}",document.getElementsByTagName("head")[0].appendChild(t)},s.models.QuickLinks=Backbone.Model.extend({defaults:function(){return{url:"",local:!1,order:0,type:0,deleted:!1}},initialize:function(t){t=t||{},this.idAttribute=this.collection&&this.collection.idAttribute||"csid",this.serverIdAttribute=this.collection&&this.collection.serverIdAttribute||"id",this.attributes.linksOrder&&(this.isGroup=!0),Backbone.Model.prototype.initialize.call(this,t)},saveHandler:function(e){this.sublinks&&this.sublinks.map(function(t){t.save({parentLinkId:e.id,unsyncable:!1},{silent:!0}),t.collection.onAdd(t)})},getFriendlyUrl:function(){var t=this.get("url");return t.substr(Math.max(t.indexOf("://")+3,0))},saveOptions:function(){return this.collection&&this.collection.saveOptions},isChild:function(){return!!this.group},delete:function(){this.group&&this.group.removeChild(this),this.save("deleted",!0)},removeChild:function(t){this.sublinks.splice(this.sublinks.indexOf(t),1)},saveNewOrder:function(t){this.save({order:t},this.saveOptions())},comparator:"order"}),o.models.TeamLink=s.models.QuickLinks.extend({}),s.collect.SyncedQuickLinksBase=o.collect.SyncedCollection.extend({initialize:function(t){(t=t||{}).name=t.name||"quicklinks",t.model=t.model||s.models.QuickLinks,t.localProps=["unsyncable"],t.apiUrl=o.globals.urlRoot+"links",this.listenTo(this,"reorder",this.reorderItem),o.collect.SyncedCollection.prototype.initialize.call(this,t)},saveOptions:{},nextOrder:function(){return this.length?this.last().get("order")+100:100},comparator:"order",reorderItem:function(t){}}),s.collect.QuickLinks=s.collect.SyncedQuickLinksBase.extend({saveOptions:{patch:!0},reorderItem:function(t){var e={operations:[{REORDER:{move_id:t.move_id,move_target_id:t.move_target_id,move_offset:t.move_offset}}]},i=this;r.ajax({type:"PATCH",contentType:"application/json",data:JSON.stringify(e),beforeSend:setMomentumAuthHeader,url:o.globals.urlRootApi+"links"}).done(function(t){i.fetchFromServer()}).fail(function(t,e){})}}),s.collect.QuickLinksLegacy=Backbone.Collection.extend({model:s.models.QuickLinks,saveOptions:{},comparator:"order",localStorage:new Backbone.LocalStorage("momentum-quicklinks"),isLegacy:!0,initialize:function(){this.idAttribute="csid",this.serverIdAttribute=null,this.listenTo(this,"reorder",this.reorderItem),this.listenTo(this,"reset",this.migrate)},nextOrder:function(){return this.length?this.last().get("order")+100:100},fetch:function(t){return Backbone.Collection.prototype.fetch.call(this,t)},createOrderGaps:function(){var e=100;this.each(function(t){t.save({order:e},{silent:!0}),e+=100})},migrate:function(){this.each(function(t){t.get("csid")||t.save("csid",t.get("id")),t.id=t.get("csid")})},reorderItem:function(t){var e=this.findWhere({csid:t.move_id}),i=this.findWhere({csid:t.move_target_id}),n=0<t.move_offset?1:-1,s=this.indexOf(i),l=1;if(0<=s+n&&s+n<this.length){var a=this.at(s+n);(l=Math.abs(a.get("order")-i.get("order")))<=20&&(this.createOrderGaps(),l=Math.abs(a.get("order")-i.get("order")))}var o=i.get("order")+Math.ceil(l/2)*n;e.save({order:o},{silent:!0})}}),s.views.QuickLink=Backbone.View.extend({tagName:"li",template:s.templates["quicklinks-item-template"],events:{"keypress .todo-input":"updateOnEnter","click .destroy":"delete",dragstart:"dragstart",dragenter:"dragenter","click a":"handleClick","click .more":"toggleDropdown","click .detail":"showDetail","click .link-pin":"togglePin"},initialize:function(t){this.dropdownOpen=!1,_.bindAll(this,"dragstart","dragenter"),this.parent=t.parent,this.noIcon=t.noIcon,this.listenTo(this.model,"change",this.onChange),this.listenTo(this.model,"change:archive destroy",this.remove),this.listenTo(o,"globalEvent:click globalEvent:esc",this.hideDropdown)},onChange:function(){this.model.get("deleted")?this.destroy():this.render()},render:function(){var i=this,n=this.model.get("url");this.moreIsSet=!1;var s=getFavIcon(n);if(this.noIcon)this.loadLink(!1);else{var l=new Image;this.loadLink(!1),isChrome()?getBrowser().permissions.contains(o.models.bookmarksSettings.permissions,function(t){if(t){var e="chrome://favicon/size/16@2x/"+n;r.ajax({url:e}).done(function(t){t===i.parent.notFoundIcon?l.src=s:i.loadLink(e)})}else l.src=s}):l.src=s,l.onload=function(){i.loadLink(s)}}return i},hideDropdown:function(t){this.dropdownOpen&&!r.contains(this.$el[0],t.target)&&this.toggleDropdown()},showDetail:function(t){t.stopPropagation(),this.toggleDropdown(),this.parent.showDetail(this.model,t)},toggleDropdown:function(t){var e;if(t?(e=r(t.currentTarget).closest("li")).toggleClass("active",!this.dropdownOpen):e=this.$el,e.toggleClass("active",!this.dropdownOpen),e.find(".dropdown-wrapper").toggleClass("active",!this.dropdownOpen),this.dropdownOpen=!this.dropdownOpen,this.dropdownOpen){this.model.get("pinned")&&this.parent.forceHidePopup(!0);var i=this.$el.find(".dropdown"),n=i[0].getBoundingClientRect().bottom,s=i.closest(".links-list");if(0===s.length&&(s=i.closest(".more-links-list")),0===s.length)return;var l=s[0].getBoundingClientRect().bottom-n-5,a=i.css("margin-top");a=a.substring(0,a.length-2);var o=Math.min(a,l);i.css({"margin-top":o}),3!==o?i.css({right:"calc(100% + 5px)"}):i.css({right:"calc(var(--app-padding)"})}},loadLink:function(t){var e=o.utils.captionFormatter(this.model.get("title")||this.model.getFriendlyUrl()),i=this.model.get("url"),n=this.model.get("local"),s=this.model.get("readOnly"),l=!!this.model.get("pinned"),a={title:e,url:i,showPinOption:!!this.parent.team,noMenu:!!this.model.get("parentLinkId")||!this.parent.team&&!this.model.sublinks,noIcon:this.noIcon,hasUrls:!!this.model.sublinks,local:n,readOnly:s,favicon_url:t,pinnedClass:l?"active":"",team:this.parent.team};this.$el.html(this.template(a)),this.$el.prop("draggable","true")},destroy:function(){this.remove(),this.unbind()},delete:function(t){t.stopPropagation(),o.sendEvent("Quick Links","Delete"),this.model.delete()},dragstart:function(t){t.originalEvent.dataTransfer.effectAllowed="move",t.originalEvent.dataTransfer.setData("text","dummy"),this.parent.dragmode="quicklink",this.parent.dragging=this},dragenter:function(t){if("quicklink"===this.parent.dragmode){this.parent.dragging.$el.hide(),this.parent.$placeholder||this.parent.addPlaceholder();var e=this.model.get(this.model.collection.serverIdAttribute||this.model.collection.idAttribute);this.parent.li_index(this.parent.$placeholder)<this.parent.li_index(this.$el)?(this.$el.after(this.parent.$placeholder),this.parent.move_target_id=e,this.parent.move_offset=1):(this.$el.before(this.parent.$placeholder),this.parent.move_target_id=e,this.parent.move_offset=-1);var i=this.parent.$placeholder;this.parent.$placeholder.css("display","list-item"),i.after(this.parent.dragging.$el),this.$el.toggleClass("first-link",0===this.parent.li_index(this.$el))}},handleClick:function(t){t.stopPropagation(),t.preventDefault();var e=this,i=this.model.get("url"),n=this.model.sublinks;if(n){e.$el.addClass("opening"),setTimeout(function(){e.$el.removeClass("opening")},1e3);var s=!0,l=getBrowser();t.metaKey?l.windows.create({url:n.map(function(t){return t.get("url")})}):n.map(function(t){l.tabs.create({url:t.get("url"),active:s}),s=!1})}else o.models.bookmarksSettings.get("openInNewTab")||t.metaKey?getBrowser().tabs.create({url:i}):getBrowser().tabs.update({url:i})},togglePin:function(t){this.model.set("pinned",!this.model.get("pinned")),this.model.collection.trigger("refresh")},updateOnEnter:function(t){13===t.keyCode&&this.close(r(t.currentTarget).data("field"))}}),s.views.QuickLinks=Backbone.View.extend({attributes:{id:"quicklinks",class:"app-container"},offline:!0,initialFetchStarted:!1,events:{"click .toggle":"toggleShow","click .more-links":"toggleShow","click a":"handleClick","blur .new-group-title":"saveTitle","keypress .new-group-url":"saveUrl","click .add-tab":"saveUrlByClick","keypress .new-single-title":"createLink","keydown .new-single-url":"createLink","click .new-toggle":"showAdd","click .new-hide":"hideAdd","click .delete":"deleteGroup","click .new-group-toggle":"showAddGroup","click .save-link":"saveLink","click .more-toggle":"toggleDropdown","click .retry":"retryConnection","click .retry-add":"retryAdd","click .new":"inputsClicked",dragover:"dragover",dragend:"dragend",drop:"drop"},initialize:function(t){this.LinkTypes={Link:0,Group:1,Sublink:2};var e=this;this.subViews=[],_.bindAll(this,"addOne","addAll","dragover","dragend","li_index"),this.renderedOnce=!1,this.name=this.options.name,this.linksOpenKey=this.name+"Open",this.team=this.options.team,this.template=this.team?s.templates.teamlinks:s.templates.quicklinks,this.linksLimit=3,this.attributes.id=this.options.id,this.isOpen=!this.team,this.$el.addClass(this.options.class),this.listenTo(o,"globalEvent:click globalEvent:esc",this.hidePopup),this.listenTo(o,"globalEvent:toggleQuickLinks",this.toggleShow),this.listenTo(this.collection,"remove",this.checkOptionalLinks),this.listenTo(this.collection,"change",this.handleDelete),this.listenTo(this.collection,"add",this.added),this.listenTo(this.collection,"reset refresh",this.collectionReset),this.listenTo(this.collection,"error",this.collectionError),this.listenTo(o.models.customization,"change:linksVisible",this.visibleChanged),this.listenTo(o.models.customization,"change:linksKeepOpen",this.keepOpenChanged),this.listenTo(o.models.bookmarksSettings,"change:appsLocation",this.checkOptionalLinks),this.listenTo(o.models.bookmarksSettings,"change:chromeTabLocation",this.checkOptionalLinks),this.listenTo(o,"globalEvent:window:resize",this.handleResize),this.listenTo(o,"appsReady",this.appsLoaded),this.render(),this.doFetchIfNeeded(),void 0!==getBrowser().topSites?r.ajax({url:"chrome://favicon/size/16@2x/http://notfoundurl.com"}).done(function(t){e.notFoundIcon=t}):this.notFoundIcon=""},deleteGroup:function(){this.activeModel&&this.activeModel.delete(),this.showMain(),this.toggleDropdown()},handleDelete:function(t){t&&t.changed.deleted&&(this.checkOptionalLinks(),this.team&&this.isOpen&&this.setAppPosition())},toggleDropdown:function(t){var e;t?(t.stopPropagation(),(e=r(t.currentTarget).parent()).toggleClass("active",!this.dropdownOpen)):e=this.$el,e.find(".more").toggleClass("active",!this.dropdownOpen),this.dropdownOpen=!this.dropdownOpen},checkOptionalLinks:function(){var i=this;this.$el.find("li").removeClass("first-link"),this.$el.find(".optional-link").each(function(t,e){i.checkInclusion(e)}),this.$el.find(".optional-link.show").first().addClass("first-link"),0===this.$el.find(".first-link").length&&this.$el.find("li").not(".optional-link").not(".placeholder").first().addClass("first-link"),i.toggleEmptyState(i.checkEmpty()),this.team&&this.$app.toggleClass("no-extra",!this.checkLinksInMoreDropdown())},checkEmpty:function(){return!this.$el.find(".optional-link.show").length&&(0===this.collection.size()||this.collection.every(function(t){return t.attributes.deleted}))},checkLinksInMoreDropdown:function(){var e=0;return this.collection.map(function(t){t.attributes.deleted||e++}),this.linksLimit<e},toggleEmptyState:function(t){this.$el.toggleClass("is-empty",t),this.$moreLinksButton.text(this.getLinkDropdownText()),this.hideAdd()},checkInclusion:function(t){var e=o.models.bookmarksSettings,i=r(t);i.toggleClass("show",e.get(i.attr("data-momo-id")+"Location")===i.attr("data-place"))},addPlaceholder:function(){"second"===this.currentSubview?this.$placeholder=r("<li><a>&nbsp;</a></li>").addClass("placeholder"):this.$placeholder=r('<li><div class="link-wrapper"><a>&nbsp;</a><div class="icon-wrapper more"><i class="icon-ellipsis more-icon"></i></div></div></li>').addClass("placeholder"),this.$placeholder.appendTo(this.el)},removePlaceholder:function(){this.$placeholder.remove(),this.$placeholder=void 0},getLinkDropdownText:function(){return this.checkEmpty()?"Add Link":this.hasPinned()?"More":"Links"},hasPinned:function(){return this.collection.some(function(t){return t.get("pinned")})},render:function(){var t={isChrome:isChrome(),moreDropdownText:this.getLinkDropdownText()};return this.$el.hasClass("app")&&(this.$el[0].style.width="",this.$el=this.$el.closest(".links")),this.$app=this.$el.find(".app"),this.$el.hasClass("app")?this.$app=this.$el:this.team||(this.$app=this.$el.find(".app")),this.team?(this.$el.html(this.template(t)),this.$app=this.$el.find(".app")):this.$app.html(this.template(t)),this.$connectionMessage=this.$(".message"),this.$connectionMessage.css("display","block"),this.$baseLinks=this.$(".team-dash-links").first(),this.$appWrapper=this.$el.find(".app-wrapper"),this.$otherLinks=this.$app.find(".main-subview ol"),this.renderedOnce=!0,o.models.customization.get("linksKeepOpen")&&"true"===localStorage.getItem(this.linksOpenKey)&&this.showPopup(),this.$list=this.$(".links-list"),this.$moreLinksButton=this.$(".more-links"),this.$app.toggleClass("no-extra",!this.checkLinksInMoreDropdown()),this.team&&!this.loadTriggered&&(o.widgetManager.appReady(s.info.id),this.loadTriggered=!0),this.setMaxWidgetHeight(),o.appsReady&&this.$el.find(".subviews").removeClass("no-transition"),this},destroy:function(){this.remove(),this.unbind()},keepOpenChanged:function(t){this.hidePopup()},visibleChanged:function(t){if(o.models.customization.get("linksVisible"))this.renderedOnce?(this.$el.mFadeIn(),this.$el.addClass("app-container")):this.render();else{var e=this;this.$el.mFadeOut(null,null,function(){e.$el.removeClass("app-container")})}},doFetch:function(){this.initialFetchStarted=!0,this.collection.fetch({reset:!0})},doFetchIfNeeded:function(){this.initialFetchStarted||this.doFetch()},collectionError:function(t,e,i){200!==e.status?this.failedConnection():this.successfulConnection()},switchTo:function(t){this.$subviews=this.$el.find(".subviews");var e=this;this.switching=!0,this.currentSubview!==t?(this.$el.addClass("hide-scroll"),setTimeout(function(){e.switching=!1,e.$el.removeClass("hide-scroll")},400)):this.switching=!1,this.$subviews.removeClass("second").addClass(t),this.currentSubview=t,this.setHeight()},addUrl:function(t){var e=new s.views.QuickLink({model:t,parent:this,noIcon:!0});this.$el.find(".urls").append(e.render().$el)},handleBack:function(t){t&&(t.preventDefault(),t.stopPropagation()),this.dashDetail?this.toggleShow():this.showMain()},showMain:function(t){t&&(t.preventDefault(),t.stopPropagation()),this.hideAdd(),this.switchTo("first")},clearUrl:function(){this.$el.find(".new-url").val("")},clearAdd:function(){this.$el.find(".new-title").val(""),this.$el.find(".add-subview .urls").html(""),this.clearUrl()},createLink:function(t){if(9===t.keyCode&&!t.shiftKey)return t.preventDefault(),void t.stopPropagation();13===t.keyCode&&this.addLink()},showAdd:function(t){t.preventDefault(),t.stopPropagation();var e=this.$el.find(".new");e.is(":visible")||e.css("display","block"),r(t.target).hasClass("empty-toggle")&&r(t.target).css({opacity:0}),e.hasClass("open")||e.addClass("open"),this.$el.find(".new-single-title").attr("placeholder","Name").trigger("focus"),this.handleResize()},hideAdd:function(){this.$el.find(".new").removeClass("open"),this.$el.find(".new-single-title").val("").attr("placeholder","New Link"),this.$el.find(".new-single-url").val(""),this.checkEmpty()&&this.$el.find(".empty-toggle").css({opacity:1}),this.handleResize()},showAddGroup:function(t){t.preventDefault(),t.stopPropagation(),this.switchTo("second"),this.activeModel=null;var e=this.$el.find(".new-single-title").val();this.clearAdd(),this.$el.find(".new-group-title").val(e),this.$el.find(".links-add").removeClass("editing");var i=this;setTimeout(function(){i.$el.find(".new-group-title").trigger("focus")},300)},inputsClicked:function(t){t.stopPropagation()},retryConnection:function(t){t.preventDefault(),t.stopPropagation(),this.collection.fetch({reset:!0})},collectionReset:function(){this.addAll()},revealConnectionError:function(){this.$connectionMessage.mShow(),this.$el.addClass("show-message")},dismissConnectionError:function(){this.$connectionMessage.mHide(),this.$el.removeClass("show-message")},added:function(t){t.get("type")!==this.LinkTypes.Sublink&&(this.addOne(t),this.checkOptionalLinks(),this.team&&this.setAppPosition(),this.setHeight())},addOne:function(t){var e=null;this.team&&t.get("pinned")?e=this.$baseLinks:(e=this.$otherLinks,this.team&&!this.moreIsSet&&(this.$moreLinksButton.addClass("active"),this.$moreLinksButton.css("top",30+this.$el.outerHeight(!0)-this.$moreLinksButton.outerHeight(!0)/2+"px")));var i=new s.views.QuickLink({model:t,parent:this,noIcon:e===this.$baseLinks});this.subViews.push(i),e.append(i.render().$el)},getHierarchy:function(){var e=[],i=this;return this.collection.where({type:this.LinkTypes.Group,deleted:!1}).map(function(t){t.sublinks=i.collection.where({deleted:!1,parentLinkId:t.get("id")||t.get("csid")}),t.sublinks.sort(n),e.push(t)}),(e=e.concat(this.collection.where({type:this.LinkTypes.Link,deleted:!1}))).sort(n),e;function n(t,e){return t.get("order")+(t.get("pinned")?0:1e5)-(e.get("order")+(e.get("pinned")?0:1e5))}},addAll:function(){this.offline=!1,_.each(this.subViews,function(t){t&&t.destroy&&t.destroy()}),this.subViews=[];var e=this,t=this.getHierarchy(),i=0;t.map(function(t){if(t.get("title")){var e=t.get("title").length;i<e&&(i=e)}});var n=i<22?"":i<29?"wide":i<35?"wider":"widest";this.$el.addClass(n),t.map(function(t){e.addOne(t)}),this.successfulConnection(),this.checkOptionalLinks(),this.team&&!this.isOpen&&this.setAppPosition(),this.loadTriggered||(o.trigger(s.info.id+":loadedComplete"),this.loadTriggered=!0),this.$el.find(".app").first().css("height","auto"),this.setHeight()},setAppPosition:function(){var t=this,e=this.$el.find(".team-dash-links-wrapper"),i=e.outerHeight(!0)+e.offset().top;20<i?this.$appWrapper.css({top:i+6+"px",left:0}):setTimeout(function(){t.setAppPosition()},100)},successfulConnection:function(){this.$el.find(".new").css("display","block"),this.dismissConnectionError()},failedConnection:function(t){var e=t?"retry-add":"retry";this.$connectionMessage.html('<span class="title">Trouble connectingâ€¦</span><span class="action '+e+'">Retry</span>'),this.revealConnectionError()},retryAdd:function(t){this.addLink()},addLink:function(t){var e=this.$el.find(".new-single-title")[0].value,i=this.$el.find(".new-single-url")[0].value,n=this;if(!e)return this.$el.find(".new-single-title").addClass("pulse"),void _.delay(function(){n.$el.find(".new-single-title").removeClass("pulse")},1e3);if(!i)return this.$el.find(".new-single-url").addClass("pulse"),void _.delay(function(){n.$el.find(".new-single-url").removeClass("pulse")},1e3);var s=/^chrome|chrome-extension|chrome-search:\/\//i.test(i);i=ensureUrlScheme(i),o.sendEvent("Quick Links","Add");var l=0;0<this.collection.length&&(l=this.collection.max(function(t){return t.get("order")}).get("order")+100);this.collection.create({title:e,url:i,local:s,order:l},{wait:!0,success:function(){n.successfulConnection(),n.$el.find(".new").addClass("open"),n.$el.find(".new input").val(""),n.setHeight(),n.$el.find(".new-single-title").attr("placeholder","Name").trigger("focus")},error:function(t,e,i){n.failedConnection(!0)}})},setHeightLimit:function(t){var e=r(".top-row").outerHeight(!0)+r(".bottom").outerHeight(!0),i=r(".bookmarks-wrapper"),n=0;i.css("transform")&&(n=parseInt(i.css("height"))-parseInt(i.css("transform").split(",")[5])),this.heightLimit=document.body.getBoundingClientRect().height-(e+n+4)},setHeight:function(){if(this.$subviews=this.$el.find(".subviews"),0!==this.$subviews.length&&this.$app.is(":visible")){var t=this.$subviews.hasClass("second")?1:0,e=r(this.$subviews.children()[t]),i=e.find(".body");i.css("max-height","none");var n=0<e.find(".header").length?e.find(".header").outerHeight(!0):0,s=i.outerHeight(!0)+n;i.css("max-height",""),s=s>this.heightLimit?this.heightLimit:s,localStorage.setItem("links-height",s),this.$subviews.css("max-height",Math.max(50,s)+"px"),this.$el.find(".subview").css("height",this.heightLimit+"px")}},saveTitle:function(t){t.stopPropagation(),t.preventDefault();var e=this.activeModel,i=this.$(".new-group-url"),n=i.val();if(e){var s=this.$el.find(".new-group-title").val();if(!s||0===s.length)return;e.set("title",s)}else n&&0!==n.length?this.saveLinkGroup(t):i.trigger("focus")},saveUrlByClick:function(t){t.stopPropagation(),this.saveUrl()},saveUrl:function(t){if(!t||13===t.keyCode){var e=this.activeModel;if(e){var i=this.$el.find(".new-group-url").val(),n=this;if(0===i.length)return this.$el.find(".new-group-url").first().addClass("pulse"),void _.delay(function(){n.$el.find(".new-group-url").first().removeClass("pulse")},1e3);o.sendEvent("Quick Links","Add"),this.collection.create(n.createUrl(i,this.activeModel),{success:function(t){e.sublinks.push(t),t.group=e,n.addUrl(t)}}),this.clearUrl(),this.setHeight()}else this.saveLinkGroup(t)}},createUrl:function(t,e){return{title:null,url:ensureUrlScheme(t),local:/^chrome|chrome-extension|chrome-search:\/\//i.test(t),csid:uuidv4(),parentLinkId:e?e.get("id")||e.get("csid"):null,unsyncable:!!e&&!e.get("id"),position:e&&e.sublinks?e.sublinks.length-1:0,type:e?2:0}},saveLinkGroup:function(t){t&&t.preventDefault&&(t.stopImmediatePropagation(),t.preventDefault()),this.activeModel=null;var e=this.$el.find(".new-group-url"),i=this.$el.find(".new-group-title").val(),n=e.val(),s=this;if(!i)return this.$el.find(".new-group-title").addClass("pulse"),void _.delay(function(){s.$el.find(".new-group-title").removeClass("pulse")},1e3);if(0===n.length)return this.$el.find(".new-group-url").first().addClass("pulse"),void _.delay(function(){s.$el.find(".new-group-url").first().removeClass("pulse")},1e3);o.sendEvent("Quick Links","Add");var l=0;0<this.collection.length&&(l=this.collection.max(function(t){return t.get("order")}).get("order")+100);this.collection.create({title:i,linksOrder:[],order:l,type:this.LinkTypes.Group},{success:function(e){s.activeModel=e,s.collection.create(s.createUrl(n,e),{success:function(t){e.sublinks=[t],e.group=e,s.addUrl(t)}})}}),this.setHeight(),this.clearUrl()},showDetail:function(t,e){if(e)if(this.isOpen)r.contains(this.$el.find(".links-app")[0],e.target)||this.toggleShow();else{var i=r(e.currentTarget);i.closest("li").addClass("active");var n=i.closest(".link-wrapper").children(".icon-wrapper")[0].getBoundingClientRect(),s=n.top;this.$appWrapper.css({top:s+i.outerHeight(!0)+"px",left:n.left+n.width/2-47+"px"});var l=this.$el.find(".subviews");l.addClass("no-transition"),setTimeout(function(){l.removeClass("no-transition")},10),this.showPopup(!0)}this.activeModel=t;var a=this;this.clearAdd(),this.$el.find(".add-subview .new-group-title").val(t.get("title")),t.sublinks.map(function(t){t.get("deleted")||a.addUrl(t)}),this.switchTo("second"),this.$el.find(".links-add").addClass("editing")},dragover:function(t){return t.preventDefault(),t.stopPropagation(),!(t.originalEvent.dataTransfer.dropEffect="move")},drop:function(t){t.preventDefault(),t.stopPropagation(),this.checkOptionalLinks()},dragend:function(t){if(t.originalEvent.dataTransfer.dropEffect="move",t.preventDefault(),t.stopPropagation(),"quicklink"===this.dragmode){var e=this.dragging.model,i=t.target.closest("ol").classList.contains("more-links-list")&&e.get("pinned"),n=t.target.closest("ol").classList.contains("team-dash-links")&&!e.get("pinned");(n||i)&&e.set("pinned",n),this.dragging.$el.css("display","list-item"),this.removePlaceholder(),this.collection.trigger("reorder",{move_id:e.get([e.collection.serverIdAttribute||e.collection.idAttribute]),move_target_id:this.move_target_id,move_offset:this.move_offset})}return this.checkOptionalLinks(),!1},toggleHandler:function(t){return this.toggleShow(t)},toggleShow:function(){return this.isOpen?this.forceHidePopup():this.showPopup(),this.doFetchIfNeeded(),this.isOpen},showPopup:function(t){if(this.dashDetail=!!t,this.isOpen=!0,localStorage.setItem(this.linksOpenKey,"true"),this.$el.addClass("show").outerWidth(),this.$el.addClass("show-fade-in"),!t){this.team&&this.setAppPosition();var e=this.$el.find(".subviews");e.addClass("no-transition"),setTimeout(function(){e.removeClass("no-transition")},10),this.showMain()}},forceHidePopup:function(t){this.dashDetail=!1,(self=this).isOpen=!1,t||this.$el.find(".team-dash-links > li").removeClass("active"),this.hideAdd(),localStorage.setItem(this.linksOpenKey,"false"),this.$el.removeClass("show-fade-in").bind("transitionend webkitTransitionEnd",function(){r(this).unbind("transitionend webkitTransitionEnd"),self.$el.removeClass("show")})},hidePopup:function(t){if(t!==this&&!(t&&t.originalEvent&&"click"===t.type&&t.target&&r.contains(this.$el[0],t.target)))if(this.$el.removeClass("active"),this.$el.find(".new").is(".open"))this.hideAdd();else{var e=this;setTimeout(function(){e.showMain()},50),this.isOpen&&!o.models.customization.get("linksKeepOpen")&&this.forceHidePopup()}},preventCloseOnEsc:function(){return o.models.customization.get("linksKeepOpen")},handleClick:function(t){t.stopPropagation(),t.preventDefault();var e=t.currentTarget.href;o.models.bookmarksSettings.get("openInNewTab")||t.metaKey?getBrowser().tabs.create({url:e}):getBrowser().tabs.update({url:e})},li_index:function(t){return this.$("li").index(t)},urlInvalid:function(){var t=this;this.$el.find(".new-url").addClass("pulse"),_.delay(function(){t.$el.find(".new-url").removeClass("pulse")},1e3)},getMaxHeight:function(){return this.setHeightLimit(),this.heightLimit},setMaxWidgetHeight:function(){var t=this.getMaxHeight()-(this.$el.find(".new").hasClass("open")?100:50);this.$list&&this.$list.css("max-height",t)},appsLoaded:function(){this.handleResize();var t=this.$el.find(".subviews");setTimeout(function(){t.removeClass("no-transition")},10)},handleResize:function(){this.isOpen&&(this.setMaxWidgetHeight(),this.setHeight())}}),s.styles.style(),s};m.addinManager&&m.addinManager.registerAddinFn("417829ca-7ff0-4089-b265-f775180c843e",fn_addin);