!function(a){"use strict";function b(b,c){return function(){if(void 0!==b){var d=Array.prototype.slice.call(arguments),e=(new Date).toUTCString();a.console.logs.push([c,e].concat(d));try{b.apply(a.console,d)}catch(c){Function.prototype.apply.call(b,a.console,d)}}}}if("undefined"!=typeof console){var c,d={error:a.console.error,warn:a.console.warn,info:a.console.info,debug:a.console.debug,log:a.console.log};a.console.logs=[];for(c in d)d.hasOwnProperty(c)&&(a.console[c]=b(d[c],c))}}(this),function(a){"use strict";function b(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")&&parseInt(a.split("msie")[1])}function c(a){if(b()&&b()<=9)return void f("MSIE 9 and lower is not supported. Please install a newer browser!");var c=a.configUrl,d=window.trezor.http(c);e(a.extensionId).then(function(a){return d.then(function(b){return a.configure(b)}).then(function(){f(null,a)})}).catch(function(a){f(a)})}function d(){return a.injector(["webwalletApp"]).get("config")}function e(a){function b(){return c.ChromeExtensionTransport.create(a)}var c=window.trezor;return b().catch(function(a){throw console.log(a),a})}function f(b,c){var d=a.module("webwalletApp"),e=document.getElementById("webwalletApp-container");b?console.error(b):d.config(g).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension):/)}]),d.value("trezorError",b).value("trezorApi",window.trezor).value("trezor",c);try{a.bootstrap(e,["webwalletApp"])}catch(a){console.error("[app] Error occured while bootstrapping the Angular.js app."),console.error(a),e.innerHTML=['<div class="page-container container">','  <div class="row" ng-if="installed">','    <div class="col-md-6 col-md-offset-3">','      <div class="alert alert-danger">',"        <h4>Plugin loading failed :(</h4>","        <textarea>",b||"",a,"        </textarea>","      </div>","    </div>","  </div>","</div>"].join(""),e.removeAttribute("ng-cloak")}}function g(a){a.when("/",{templateUrl:"views/main.html"}).when("/import",{templateUrl:"views/import.html"}).when("/device/:deviceId",{templateUrl:"views/device/index.html"}).when("/device/:deviceId/advanced",{templateUrl:"views/device/advanced.html"}).when("/device/:deviceId/settings",{templateUrl:"views/device/settings.html"}).when("/device/:deviceId/recovery",{templateUrl:"views/device/recovery.html"}).when("/device/:deviceId/wipe",{templateUrl:"views/device/wipe.html"}).when("/send/:uri*",{resolve:{uriRedirect:"uriRedirect"}}).otherwise({redirectTo:"/"})}function h(){var a,b="bitcoin",c="/#/send/%s",d="MyTrezor: Send Bitcoins to address";a=location.protocol+"//"+location.host+c,!navigator.registerProtocolHandler||navigator.isProtocolHandlerRegistered&&navigator.isProtocolHandlerRegistered(b,a)||navigator.registerProtocolHandler(b,a,d)}console.log("[app] User agent : ",window.navigator.userAgent),a.module("webwalletApp",["ngRoute","ngSanitize","ui.bootstrap","ja.qr"]),a.element(document).ready(function(){c(d()),h()}),g.$inject=["$routeProvider"]}(this.angular),angular.module("webwalletApp").constant("config",{debug:!1,features:{getFeatures:"1.3.3",cacheInFeatures:"1.3.3"},configUrl:"/data/config_signed.bin",extensionId:"jcjjhjgimijdkoamemaghajlhegmoclj",useBip44:!0}),angular.module("webwalletApp").filter("password",function(){"use strict";return function(a){return a.replace(/./g,"âœ±")}}),angular.module("webwalletApp").value("bip39",{english:["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]}),angular.module("webwalletApp").value("_",window._).value("Buffer",window.vendor.Buffer).value("ecurve",window.vendor.ecurve).value("bitcoin",window.vendor.bitcoin).value("base58check",window.vendor.bs58check),angular.module("webwalletApp").factory("selecter",function(){return{selectRange:function(a){var b,c,d=window.document,e=d.body;return e.createTextRange?(c=e.createTextRange(),c.moveToElementText(a),void c.select()):window.getSelection?(b=window.getSelection(),c=d.createRange(),c.selectNodeContents(a),b.removeAllRanges(),void b.addRange(c)):void 0}}}),angular.module("webwalletApp").directive("debug",function(){return{restrict:"E",transclude:!0,template:'<div class="debug" ng-if="debug" ng-transclude></div>',controller:["config","$scope",function(a,b){b.debug=a.debug}]}}),angular.module("webwalletApp").filter("amount",["utils",function(a){var b=2;return function(c,d){var e=a.amount2str(c),f=e.indexOf(".");f<0&&(e+=".",f=e.length-1);var g=e.length-f-1;g<b&&(e+=new Array(b-g+1).join("0"),g=b);var h=8-g;return h>0&&(e+=new Array(h+1).join(" ")),d&&e>=0&&(e="+"+e),e}}]),angular.module("webwalletApp").filter("ordinal",function(){return function(a){var b="th";switch(+a%10){case 1:b="st";break;case 2:b="nd";break;case 3:b="rd"}switch(+a%100){case 11:case 12:case 13:b="th"}return""+a+b}}),angular.module("webwalletApp").filter("bip32Path",function(){return function(a){return"m/"+a.map(function(a){return 2147483648&a?(2147483647&a)+"'":a}).join("/")}}),angular.module("webwalletApp").service("utils",["config","trezor","trezorApi","ecurve","bitcoin","base58check","Buffer","_","$q","$log","$http","$interval","$timeout","$location","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a){return new g(a,"binary")}function q(a){return new g(a).toString("binary")}function r(a){return new g(a,"base64")}function s(a){return new g(a).toString("base64")}function t(a){return new g(a,"hex")}function u(a){return new g(a).toString("hex")}function v(a){return u(p(unescape(encodeURIComponent(a))))}function w(a){var b=q(t(a));return decodeURIComponent(escape(b))}function x(a){return(a/1e8).toString()}function y(a){var b=a.split(".");if(2===b.length){if(b[1].length>8)throw new TypeError("Amount has too many decimals")}var c=+a,d=Math.round(1e8*c);if(isNaN(d))throw new TypeError("Amount is not a number");return d}function z(a){return e.crypto.hash256(a)}function A(a,b){var c,d=i.defer(),e=d.promise,f=!1;return e.cancel=function(){f=!0},c=h.throttle(function(){k(a).then(function(a){f||(d.notify(a),c())}).catch(d.reject)},b),c(),e}function B(a){var b=f.decode(a),c=u(b),d={};if("00"!==c.substring(90,92))throw new Error("Contains invalid private key");return d.depth=parseInt(c.substring(8,10),16),d.fingerprint=parseInt(c.substring(10,18),16),d.child_num=parseInt(c.substring(18,26),16),d.chain_code=c.substring(26,90),d.private_key=c.substring(92,156),d}function C(a){var b=f.decode(a),c=u(b),d={};return d.depth=parseInt(c.substring(8,10),16),d.fingerprint=parseInt(c.substring(10,18),16),d.child_num=parseInt(c.substring(18,26),16),d.chain_code=c.substring(26,90),d.public_key=c.substring(90,156),d}function D(a,b){function c(a,b){for(var c=parseInt(a).toString(16);c.length<b;)c="0"+c;return c}var d,e;return d=c(b,8)+c(a.depth,2)+c(a.fingerprint,8)+c(a.child_num,8)+a.chain_code+a.public_key,e=t(d),f.encode(e)}function E(a,b){var c=a.public_key,d=t(c);return F(e.crypto.hash160(d),b)}function F(a,b){var c,d=new g(1);return d[0]=+b,c=g.concat([d,a]),f.encode(c)}function G(a){var b;return b=f.decode(a),b.slice(0,21),{version:b[0],hash:b.slice(1)}}function H(a,d){var e,f;if(e=J(a,d),I(e),b instanceof c.PluginTransport&&(f=b.deriveChildNode(a,d),I(f),!h.isEqual(e,f)))throw j.error("CKD check failed",{parent:a,jsChild:e,pluginChild:f}),new Error("Child node derivation failed");return e}function I(a){a.public_key=a.public_key.toUpperCase(),a.chain_code=a.chain_code.toUpperCase(),a.fingerprint=a.fingerprint.toString(),a.child_num=a.child_num.toString(),a.depth=a.depth.toString()}function J(a,b){var c=K(a),d=L(c.derive(b));return d.path=a.path.concat([b]),d}function K(a){var b=new g(a.chain_code,"hex"),c=new g(a.public_key,"hex"),f=d.Point.decodeFrom(e.ECPubKey.curve,c),h=new e.HDNode(f,b);return h.path=a.path,h.depth=+a.depth,h.index=a.child_num,h.parentFingerprint=a.fingerprint,h}function L(a){return{path:a.path,depth:a.depth,child_num:a.index,fingerprint:a.parentFingerprint,public_key:a.pubKey.toHex(),chain_code:a.chainCode.toString("hex")}}function M(a){return l(null,a)}function N(a,b,c){var d=a();return d?d.then(null,function(d){if(void 0!==c&&c<1)throw d;return m(function(){return N(a,b,c?c-1:c)},b)}):i.reject("Cancelled")}function O(a){var b,c=i.defer();return n.path()!==a?(n.path(a),b=o.$on("$locationChangeSuccess",function(){c.resolve(),b()})):c.resolve(),c.promise}this.stringToBytes=p,this.bytesToString=q,this.base64ToBytes=r,this.bytesToBase64=s,this.hexToBytes=t,this.bytesToHex=u,this.utf8ToHex=v,this.hexToUtf8=w,this.amount2str=x,this.str2amount=y,this.sha256x2=z,this.httpPoll=A,this.xprv2node=B,this.xpub2node=C,this.node2xpub=D,this.node2address=E,this.address2str=F,this.decodeAddress=G,this.deriveChildNode=H,this.tick=M,this.endure=N,this.redirect=O}]),function(){function a(a,b,c){return void 0===c||0==+c?Math[a](b):(b=+b,c=+c,isNaN(b)||"number"!=typeof c||c%1!=0?NaN:(b=b.toString().split("e"),b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-c:-c))),b=b.toString().split("e"),+(b[0]+"e"+(b[1]?+b[1]+c:c))))}Math.round10||(Math.round10=function(b,c){return a("round",b,c)}),Math.floor10||(Math.floor10=function(b,c){return a("floor",b,c)}),Math.ceil10||(Math.ceil10=function(b,c){return a("ceil",b,c)})}(),angular.module("webwalletApp").directive("slider",function(){"use strict";return{require:"ngModel",link:function(a,b,c,d){b.on("slide",function(a){d.$setViewValue(a.value)}).trigger({type:"slide",value:b.attr("data-slider-value")}).slider()}}}),angular.module("webwalletApp").service("udevError",["trezor","trezorApi","flash","$q",function(a,b,c,d){"use strict";this._makesSenseAsking=function(){return a instanceof b.ChromeExtensionTransport&&(0===window.navigator.platform.lastIndexOf("Linux")&&-1===window.navigator.userAgent.indexOf("CrOS"))},this.errorStatus=!1,this.getCurrentErrorStatus=function(){var b;return b=this._makesSenseAsking()?a.udevStatus().then(function(a){return"display"===a}):d.when(!1),b.then(function(a){this.errorStatus=a}.bind(this)),b},this.getCurrentErrorStatus()}]),angular.module("webwalletApp").service("deviceService",["trezor","trezorApi","TrezorDevice","deviceList","$rootScope","$location",function(a,b,c,d,e,f){"use strict";function g(e){a instanceof b.PluginTransport&&(e.on(c.EVENT_SEND,d.pauseWatch.bind(d)),e.on(c.EVENT_ERROR,d.resumeWatch.bind(d)),e.on(c.EVENT_RECEIVE,d.resumeWatch.bind(d)))}function h(a){c.EVENT_TYPES.forEach(function(b){i(e,a,b)})}function i(a,b,d){b.on(d,function(){var e=[].slice.call(arguments);e.unshift(b),e.unshift(c.EVENT_PREFIX+d),a.$broadcast.apply(a,e)})}function j(){var a=d.getDefault();if(a)return void d.navigateTo(a);f.path("/")}function k(a){if(a.dev){if(!a.dev.isConnected())return void e.$broadcast(o,a);m=!0,e.$broadcast(n,a),d.abortHook()}}function l(a){d.forget(a)}var m=!1,n="device.askDisconnect",o="device.closeDisconnect";this.EVENT_ASK_FORGET="device.askForget",this.EVENT_ASK_DISCONNECT=n,this.EVENT_CLOSE_DISCONNECT=o,d.registerBeforeInitHook(g),d.registerBeforeInitHook(h),d.registerBeforeInitHook(d.navigateTo.bind(d),20),d.registerDisconnectHook(l),d.registerForgetHook(k),d.registerAfterForgetHook(j),d.watch(d.POLLING_PERIOD)}]),angular.module("webwalletApp").value("FIRMWARE_LIST_URL","/data/releases.json"),angular.module("webwalletApp").service("firmwareService",["FIRMWARE_LIST_URL","$http","$rootScope","deviceList",function(a,b,c,d){"use strict";function e(a){return[+a.major_version,+a.minor_version,+a.patch_version]}function f(){return k.then(function(a){return a.data[0]})}function g(a){return k.then(function(b){return i(a,b.data)})}function h(a){var b="54525a52";return a.substr(0,b.length)===b&&a.length>=8192&&a.length<=917504}function i(a,b){var c,d=b[0],f=e(a);if(d&&!(j(d.version,f)<1)){for(c=0;c<b.length&&0!==j(b[c],a);c+=1)if(b[c].required){d.required=!0;break}return d}}function j(a,b){return a[0]-b[0]?a[0]-b[0]:a[1]-b[1]?a[1]-b[1]:a[2]-b[2]?a[2]-b[2]:0}var k=((new Date).getTime(),b.get(a)),l=!1;this.EVENT_CONNECT="firmware.connect",this.EVENT_DISCONNECT="firmware.disconnect",this.EVENT_BOOTLOADER="firmware.bootloader",this.EVENT_NORMAL="firmware.normal",this.EVENT_CANDIDATE="firmware.candidate",this.EVENT_OUTDATED="firmware.outdated",d.registerBeforeInitHook(function(a){c.$broadcast(this.EVENT_CONNECT,a)}.bind(this),5),d.registerDisconnectHook(function(a){c.$broadcast(this.EVENT_DISCONNECT,a)}.bind(this),5),d.registerAfterInitHook(function(a){return a.features.bootloader_mode?(c.$broadcast(this.EVENT_BOOTLOADER,a),l&&d.abortHook(),f().then(function(b){l=!0,c.$broadcast(this.EVENT_CANDIDATE,{dev:a,firmware:b}),d.abortHook()}.bind(this))):(c.$broadcast(this.EVENT_NORMAL,a),l&&d.abortHook(),g(a.features).then(function(b){b&&(b.required&&(l=!0),c.$broadcast(this.EVENT_OUTDATED,{dev:a,firmware:b,version:e(a.features)}),b.required&&d.abortHook())}.bind(this)))}.bind(this),10),d.registerDisconnectHook(function(a){l&&d.abortHook()},10),this.check=g,this.download=function(a){return b.get(a.url).then(function(a){if(!h(a.data))throw new Error("Downloaded firmware is invalid");return a.data})},this.setModalOpen=function(a){l=a},this.isModalOpen=function(){return l}}]),angular.module("webwalletApp").factory("deviceList",["_","$q","config","utils","flash","trezor","trezorApi","TrezorDevice","modalOpener","udevError","$location",function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(){this._devices=[],this._watchPaused=!1,this._enumerateInProgress=!1,this._enumerateCanWait=!1,this._beforeInitHooks=[],this._afterInitHooks=[],this._disconnectHooks=[],this._forgetHooks=[],this._afterForgetHooks=[]}return l.prototype.POLLING_PERIOD=1e3,l.prototype.DEFAULT_HOOK_PRIORITY=50,l.prototype.DEFAULT_HOOK_NAME="anonymous",l.prototype.get=function(b){var c;if(b.id)c={id:b.id};else if(b.path)c={path:b.path};else{if(!b)return;c={id:b}}return a.find(this._devices,c)},l.prototype.existsConnected=function(a){var b=this.get(a);return void 0!==b&&!!b.isConnected()},l.prototype.add=function(a){this._devices.push(a)},l.prototype.getDefault=function(){return this.all()[0]},l.prototype.all=function(){return a.filter(this._devices,function(a){return a.shouldShow()})},l.prototype.count=function(){return this.all().length},l.prototype.remove=function(b,c){void 0===c&&(c=!1);var d={};c||b.destroy(),b.id?d.id=b.id:b.path&&(d.path=b.path),a.remove(this._devices,d)},l.prototype.forget=function(a,c,d){return b.when({dev:a,requireDisconnect:c,customText:d}).then(this._execHooks(this._forgetHooks)).then(function(a){this.remove(a.dev)}.bind(this)).then(this._execHooks(this._afterForgetHooks))},l.prototype.watch=function(a){var c,e=d.tick(a),f=b.defer();return this._progressWithConnected(f),e.then(null,null,function(){this._progressWithConnected(f)}.bind(this)),c=this._progressWithDescriptorDelta(f.promise),c.then(null,null,function(a){a&&(a.added.forEach(this._connect.bind(this)),a.removed.forEach(this._disconnect.bind(this)))}.bind(this)),e},
l.prototype.pauseWatch=function(){this._watchPaused=!0},l.prototype.resumeWatch=function(){this._watchPaused=!1},l.prototype._progressWithConnected=function(a){this._watchPaused||this._enumerateInProgress||(this._enumerateInProgress=!0,f.enumerate(this._enumerateCanWait).then(function(b){a.notify(b),this._enumerateCanWait=!0,this._enumerateInProgress=!1}.bind(this)))},l.prototype._progressWithDescriptorDelta=function(a){var b,c=[];return a.then(null,null,function(a){if(a)return b=c,c=a,this._computeDescriptorDelta(b,a)}.bind(this))},l.prototype._computeDescriptorDelta=function(b,c){return{added:a.filter(c,function(c){return!a.find(b,{path:c.path})}),removed:a.filter(b,function(b){return!a.find(c,{path:b.path})})}},l.prototype._connect=function(a){var c=new h({path:a.path});f.acquire(a).then(function(a){var b=new g.Session(f,a.session);return c.connect(b),c.initializeDevice()}.bind(this)).catch(function(a){throw c.disconnect(),a}).then(function(){return j.getCurrentErrorStatus()}).then(function(){return this.add(c),c}.bind(this)).then(function(a){return a.addSessionListeners(),a}).then(function(a){return a.withLoading(function(){return b.when(a).then(this._execHooks(this._beforeInitHooks)).then(this._execHooks(this._afterInitHooks))}.bind(this))}.bind(this)).catch(function(a){a instanceof this.DeviceListException||(j.getCurrentErrorStatus().then(function(b){!1===b&&e.error(a.message||"Loading device failed")}),console.log("[deviceList] Catched error, printing stack"),console.log(a),console.log(a.stack))}.bind(this))},l.prototype._registerHook=function(a,b,c,d){a.push({fn:b,priority:c||this.DEFAULT_HOOK_PRIORITY,name:d||b.name||this.DEFAULT_HOOK_NAME})},l.prototype._execHooks=function(a){return function(c){function d(g){var h;if(g===f)return void e.resolve(c);h=a[g].fn.apply(window,[c]),void 0!==h?b.when(h).then(function(){d(g+1)},function(a){e.reject(a)}):d(g+1)}var e=b.defer(),f=a.length;return a=this._sortHooks(a),d(0),e.promise}.bind(this)},l.prototype.registerBeforeInitHook=function(a,b,c){this._registerHook(this._beforeInitHooks,a,b,c)},l.prototype.registerAfterInitHook=function(a,b,c){this._registerHook(this._afterInitHooks,a,b,c)},l.prototype.registerDisconnectHook=function(a,b,c){this._registerHook(this._disconnectHooks,a,b,c)},l.prototype.registerForgetHook=function(a,b,c){this._registerHook(this._forgetHooks,a,b,c)},l.prototype.registerAfterForgetHook=function(a,b,c){this._registerHook(this._afterForgetHooks,a,b,c)},l.prototype._disconnect=function(a){var c={path:a.path},d=this.get(c);if(d)return d.disconnect(),b.when(d).then(this._execHooks(this._disconnectHooks))},l.prototype.navigateTo=function(a,b){if(a.shouldShow()){var c="/device/"+a.id;(b||0!==k.path().indexOf(c))&&k.path(c)}},l.prototype._sortHooks=function(b){return a.sortBy(b,function(a){return a.priority})},l.prototype.abortHook=function(){throw new this.DeviceListException},l.prototype.DeviceListException=function(){},l.prototype.runOnClose=function(){console.log("[deviceList] runOnClose()"),this.all().forEach(function(a){a.runOnClose()})},new l}]),angular.module("webwalletApp").factory("TrezorDevice",["_","$q","$log","config","utils","$timeout","$interval",function(a,b,c,d,e,f,g){"use strict";function h(a){this.id=a.id||null,this.path=a.path||null,this.features=null,this.error=null,this.forgetOnDisconnect=null,this._passphrase=null,this._session=null,this._desc=null,this._loadingLevel=0}return h.prototype.DEFAULT_LABEL="My TREZOR",h.prototype.LABEL_MAX_LENGTH=16,h.prototype.SESSION_TTL=12e4,h.EVENT_PIN="pin",h.EVENT_BUTTON="button",h.EVENT_PASSPHRASE="passphrase",h.EVENT_WORD="word",h.EVENT_SEND="send",h.EVENT_ERROR="error",h.EVENT_RECEIVE="receive",h.EVENT_CONNECT="connect",h.EVENT_DISCONNECT="disconnect",h.EVENT_PREFIX="device.",h.EVENT_TYPES=[h.EVENT_PIN,h.EVENT_PASSPHRASE,h.EVENT_BUTTON,h.EVENT_WORD,h.EVENT_SEND,h.EVENT_ERROR,h.EVENT_RECEIVE],h.REQ_BUTTON_FIRMWARE="ButtonRequest_FirmwareCheck",h.prototype.STATUS_LOADING="loading",h.prototype.STATUS_CONNECTED="connected",h.prototype.STATUS_DISCONNECTED="disconnected",h.prototype.destroy=function(){this.disconnect()},h.deserialize=function(a){var b=new h(a);if("string"==typeof a.passphrase){console.log("[device] converting from old to new passphrase..."),console.log("[device] old: ",a.passphrase);var c=e.hexToBytes(a.passphrase);c=Array.prototype.slice.call(c),console.log("[device] new: ",c),b._passphrase=c}else b._passphrase=a.passphrase;return b.features=a.features,b.forgetOnDisconnect=a.forgetOnDisconnect,b},h.prototype.serialize=function(){return{id:this.id,path:this.path,passphrase:this._passphrase,features:this.features,forgetOnDisconnect:this.forgetOnDisconnect}},h.prototype.clearSessionAndReleaseSync=function(){this._session.clearSessionSync(),this._session.releaseSync()},h.prototype.clearSession=function(){console.log("[device] clearing session");var a=this;return this._session.clearSession().then(function(){a.maybeReloadFeatures()})},h.prototype.runOnClose=function(){null!=this._session&&(this._session.supportsSync?this._callInProgress||this.clearSessionAndReleaseSync():this.clearSession())},h.prototype.setClearTimeout=function(){this.cancelClearTimeout(),this._lastActivityStamp=Math.floor(Math.floor(Date.now()/1e3)),this._checkActivityTimeout=f(function(){this.isConnected()&&(this._callInProgress||this.clearSession())}.bind(this),this.SESSION_TTL),this._lastActivityInterval=g(function(){var a=Math.floor(Math.floor(Date.now()/1e3));this._activityDiff=a-this._lastActivityStamp}.bind(this),1e3)},h.prototype.timeToClear=function(){var a=this._activityDiff;null==this._activityDiff&&(a=0);var b=this.SESSION_TTL/1e3-a;if(b<0)return"soon";var c=Math.floor(b/60);return"in "+c+":"+(b-60*c)},h.prototype.cancelClearTimeout=function(){null!=this._checkActivityTimeout&&(f.cancel(this._checkActivityTimeout),g.cancel(this._lastActivityInterval))},h.prototype.reloadFeatures=function(){return null!=this.features&&this.supports("getFeatures")?this._session.getFeatures().then(function(a){this.features=a.message}.bind(this)):b.when()},h.prototype.maybeReloadFeatures=function(){return null!=this.features?this.supports("getFeatures")?this.reloadFeatures():this.initializeDevice():b.when()},h.prototype.displayLock=function(){return"unlocked"===this.lockStatus()},h.prototype.lockStatus=function(){return this._lockMakesSense()?this._isUnlocked()?"unlocked":"locked":"NA"},h.prototype._isUnlocked=function(){return this.features.passphrase_protection?this.features.pin_protection?this.features.pin_cached&&this.features.passphrase_cached:this.features.passphrase_cached:!!this.features.pin_protection&&this.features.pin_cached},h.prototype._lockMakesSense=function(){return!!this.supports("cacheInFeatures")&&(this.status()===this.STATUS_CONNECTED&&(this.features.passphrase_protection||this.features.pin_protection))},h.prototype.isLoading=function(){return!!this._loadingLevel},h.prototype.withLoading=function(a){var c=this;c._loadingLevel++;var d=a();return b.when(d).finally(function(){return c._loadingLevel--,0===c._loadingLevel?c.maybeReloadFeatures():b.when()}).then(function(){return d})},h.prototype.status=function(){return this.isLoading()?this.STATUS_LOADING:this.isConnected()?this.STATUS_CONNECTED:this.STATUS_DISCONNECTED},h.prototype.canSendTx=function(){return this.isConnected()&&!this.isLoading()},h.prototype.label=function(){return this.features&&this.features.label?this.features.label:this.DEFAULT_LABEL},h.prototype.defaultCoin=function(){return a.find(this.features.coins,{coin_name:d.coin})},h.prototype.supports=function(a){return!(!this.features||!d.features[a])&&[this.features.major_version,this.features.minor_version,this.features.patch_version].join(".")>=d.features[a]},h.prototype.hasSavedPassphrase=function(){return!!this._passphrase},h.prototype.checkPassphraseAndSave=function(a){var b=this._hashPassphrase(a);return this._passphrase?JSON.stringify(this._passphrase)===JSON.stringify(b):(this._passphrase=b,!0)},h.prototype._hashPassphrase=function(a){var b="TREZOR#"+this.id+"#"+a,c=e.sha256x2(b,{asBytes:!0});return Array.prototype.slice.call(c)},h.prototype.isConnected=function(){return!!this._session},h.prototype.connect=function(a){this._session=a,this.on=this._session.on.bind(this._session),this.once=this._session.once.bind(this._session),this.removeListener=this._session.removeListener.bind(this._session),this._callInProgress=!1},h.prototype.addSessionListeners=function(){var a=function(){this._callInProgress=!0}.bind(this),b=function(){this.setClearTimeout(),this._callInProgress=!1}.bind(this);this.on("send",a),this.on("receive",b),this.on("error",b)},h.prototype.disconnect=function(){this.cancelClearTimeout(),this._session&&this._session.release(),this._session=null},h.prototype.isEmpty=function(){return!this.features||!this.features.initialized},h.prototype.initializeDevice=function(){function a(){return!!b.isConnected()&&b._session.initialize().then(function(a){var c=a.message;return c.bootloader_mode?b.id=b.path:b.id=c.device_id,b.error=null,a},function(a){throw b.error=a.message||"Failed to initialize the device.",a})}var b=this;return e.endure(a,3e3,60).then(function(a){return b.features=a.message},function(a){throw b.features=null,a})},h.prototype.flash=function(a){var b=this;return b._session.eraseFirmware().then(function(){return b._session.uploadFirmware(a)})},h.prototype.wipe=function(){var a=this;return a.withLoading(function(){return a._session.initialize().then(function(){return a._session.wipeDevice()})})},h.prototype.reset=function(a){var b=this,c=angular.copy(a);return b.withLoading(function(){return b._session.initialize().then(function(){return b._session.resetDevice(c)}).then(function(){return b.initializeDevice()})})},h.prototype.load=function(a){var b=this,c=angular.copy(a);try{c.node=e.xprv2node(c.payload)}catch(a){c.mnemonic=c.payload}return delete c.payload,b.withLoading(function(){return b._session.initialize().then(function(){return b._session.loadDevice(c)}).then(function(){return b.initializeDevice()})})},h.prototype.recover=function(a){var b=this,c=angular.copy(a);return c.enforce_wordlist=!0,b.withLoading(function(){return b._session.initialize().then(function(){return b._session.recoverDevice(c)}).then(function(){return b.initializeDevice()})})},h.prototype.changeLabel=function(a){var b=this;return a.length>this.LABEL_MAX_LENGTH&&(a=a.slice(0,this.LABEL_MAX_LENGTH)),b.withLoading(function(){return b.maybeReloadFeatures().then(function(){return b._session.applySettings({label:a})}).then(function(){return b.maybeReloadFeatures()})})},h.prototype.togglePassphrase=function(a){var b=this;return b.withLoading(function(){return b.maybeReloadFeatures().then(function(){return b._session.applySettings({use_passphrase:!!a})}).then(function(){return b.maybeReloadFeatures()})})},h.prototype.changePin=function(a){var b=this;return b.withLoading(function(){return b.maybeReloadFeatures().then(function(){return b._session.changePin(a)}).then(function(){return b.maybeReloadFeatures()})})},h.prototype.ratePin=function(b){function c(a){var b,c=1;for(b=2;b<=a;b++)c*=b;return c}var d;return b.length>9?0:(d=a.uniq(b.split("")).length,c(9)/c(9-d))},h.prototype.shouldShow=function(){return!0!==this.features.bootloader_mode&&"bitcointrezor.com"===this.features.vendor},h.prototype.firmwareString=function(){return this.features.major_version+"."+this.features.minor_version+"."+this.features.patch_version},h}]),angular.module("webwalletApp").service("modalOpener",["$rootScope","$timeout","selecter","$document","$modal",function(a,b,c,d,e){"use strict";function f(){$(document).unbind("keydown.modalOpener").bind("keydown.modalOpener",function(a){var b=!1;if(8===a.keyCode){var c=a.srcElement||a.target;b=("INPUT"!==c.tagName.toUpperCase()||"TEXT"!==c.type.toUpperCase()&&"PASSWORD"!==c.type.toUpperCase()&&"FILE"!==c.type.toUpperCase()&&"EMAIL"!==c.type.toUpperCase()&&"SEARCH"!==c.type.toUpperCase()&&"DATE"!==c.type.toUpperCase())&&"TEXTAREA"!==c.tagName.toUpperCase()||(c.readOnly||c.disabled)}b&&a.preventDefault()})}function g(){$(document).unbind("keydown.modalOpener").bind("keydown.modalOpener",function(a){})}this.currentlyOpenedModal=null,this.isModalOpened=function(){return null!=this.currentlyOpenedModal},this.openModal=function(a,f,g,h,i,j){var k=f.replace(".","-","g")+"modal";void 0===h&&(h={}),void 0===i&&(i=!1),a=angular.extend(a.$new(),h);var l=e.open({templateUrl:"views/modal/"+f+".html",backdrop:"static",keyboard:!1,scope:a,size:g,windowClass:k}),m=this;return l.opened.then(function(){m.currentlyOpenedModal=l,a.$emit("modal."+f+".show",j),b(function(){},1).then(function(){angular.element("input[autofocus]").trigger("focus")}).then(function(){a.autoselect=function(){var a=d.find(".autoselect");a.length&&c.selectRange(a[0])},a.autoselect()})}),l.result.finally(function(){m.currentlyOpenedModal=null,a.$emit("modal."+f+".hide",j)}),i||this.stopBackpaceOnModal(l),{result:l.result,modal:l,scope:a}},this.stopBackpaceOnModal=function(a){a.opened.then(function(){f()}),a.result.finally(function(){g()})}}]),angular.module("webwalletApp").service("pinModalService",["$rootScope","$document","modalOpener","$modal",function(a,b,c,d){"use strict";this.openedModal=null,this.closeOpen=function(){null!=this.openedModal&&this.openedModal.modal.close(),this.openedModal=null},this.showModal=function(a,d,e,f,g){function h(a){var b,c=a.which;return 8===c?(k.scope.delPin(),k.scope.$digest(),!1):13===c?(k.modal.close(k.scope.pin),!1):void(i(c)&&(b=j(c),k.scope.addPin(String.fromCharCode(b)),k.scope.$digest()))}function i(a){return a>=49&&a<=57||a>=97&&a<=105}function j(a){return a>=97?a-48:a}if(e.id===a.device.id){var k=c.openModal(a,"pin","sm",{pin:"",type:f},!0);this.openedModal=k,k.scope.addPin=function(a){k.scope.pin=k.scope.pin+a.toString(),b.focus()},k.scope.delPin=function(){k.scope.pin=k.scope.pin.slice(0,-1)},k.scope.isPinSet=function(){return k.scope.pin.length>0},b.on("keydown",h),b.focus(),k.result.then(function(a){b.off("keydown",h),g(null,a)},function(a){b.off("keydown",h),g(a)})}}}]),angular.module("webwalletApp").service("passphraseModalService",["$rootScope","$document","modalOpener","$modal",function(a,b,c,d){"use strict";this.openedModal=null,this.closeOpen=function(){null!=this.openedModal&&this.openedModal.modal.close(),this.openedModal=null},this.showModal=function(a,b,d,e){function f(){var a=i.scope.values;if(!i.scope.check)return void(i.scope.checkCorrect=!0);i.scope.checkCorrect=a.passphrase===a.passphraseCheck&&a.passphrase.length<=50}function g(){function a(){return i.modal.close(i.scope.values.passphrase),!1}var b=document.getElementById("passphrase-submit"),c=document.getElementById("passphrase-form");b.addEventListener("submit",a,!1),b.addEventListener("click",a,!1),c.addEventListener("submit",a,!1),c.addEventListener("keypress",function(b){13===b.keyCode&&i.scope.checkCorrect&&a()},!0)}if(d.id===a.device.id){var h=a.device.hasSavedPassphrase();h||(d.forgetOnDisconnect=!0);var i=c.openModal(a,"passphrase","sm",{check:!h,checkCorrect:!1,values:{passphrase:"",passphraseCheck:""},installHandler:g});this.openedModal=i,i.result.then(function(b){a.device.checkPassphraseAndSave(b)?e(null,b):e(new Error("Invalid passphrase")),h||(d.forgetOnDisconnect=null)},function(a){e(a)}),i.scope.$watch("values.passphrase",f),i.scope.$watch("values.passphraseCheck",f)}}}]),angular.module("webwalletApp").service("setupModalService",["$rootScope","modalOpener","$modal",function(a,b,c){"use strict";this.openedModal=null,this.closeOpen=function(){null!=this.openedModal&&this.openedModal.close(),this.openedModal=null},this.showModal=function(a){this.openedModal=c.open({templateUrl:"views/modal/setup.html",size:"lg",windowClass:"buttonmodal",backdrop:"static",keyboard:!1,scope:a}),b.stopBackpaceOnModal(this.openedModal)}}]),angular.module("webwalletApp").factory("flash",["$rootScope","$timeout","$interpolate",function(a,b,c){"use strict";function d(){b.cancel(h),h=b(function(){i=[]})}function e(){a.$emit("flash:message",i,d)}function f(a,b){if(b){if(b.template)return{html:c(b.template)(b),level:a}}else b=a,a="success";return{level:a,text:b}}function g(a,b){return a instanceof Array?a.map(function(a){return a.level||a.text?f(a.level,a.text):f(a)}):[f(a,b)]}var h,i=[];a.$on("$locationChangeSuccess",e);var j=function(a,b){i=g(a,b),e(i)};return["error","warning","info","success"].forEach(function(a){j[a]=function(b){j(a,b)}}),j.clear=function(){e(null)},j}]).directive("flashMessages",function(){return{controller:["$scope","$rootScope",function(a,b){b.$on("flash:message",function(b,c,d){a.messages=c,d()})}],restrict:"EA",replace:!0,template:"<span ng-transclude></span>",transclude:!0}}),angular.module("webwalletApp").directive("focus",function(){return function(a,b){b[0].focus()}}),angular.module("webwalletApp").controller("DebugCtrl",["trezor","trezorApi","$rootScope","$scope","deviceList",function(a,b,c,d,e){"use strict";function f(){return(window.console.logs||[]).map(JSON.stringify).join("\n")}c.debug={},c.debug.toggle=function(){if(c.debug.visible)return void(c.debug.visible=!1);c.debug.logs=f(),c.debug.visible=!0},c.debug.focus=function(a){$(a.target).select()}}]),angular.module("webwalletApp").value("bowser",window.bowser),angular.module("webwalletApp").controller("ErrorCtrl",["config","trezor","trezorApi","trezorError","udevError","$scope",function(a,b,c,d,e,f){"use strict";f.udevError=e,null===d?f.error=!1:(f.error=!0,f.errorMessage=d.message)}]),angular.module("webwalletApp").controller("MainCtrl",["$scope","deviceList","deviceService","udevError","firmwareService",function(a,b,c,d,e){"use strict";if(a.closeApp=function(){chrome.app.window.current().close()},a.isConnected=function(){return b.all().some(function(a){return a.isConnected()})},a.isEmpty=function(){return 0===b.count()},!a.isEmpty()&&!a.isConnected()){var f=b.all()[0];b.navigateTo(f)}a.udevError=d}]),angular.module("webwalletApp").controller("NavbarCtrl",["$scope",function(a){"use strict";a.closeApp=function(){chrome.app.window.current().close()}}]),angular.module("webwalletApp").controller("DeviceCtrl",["$scope","$location","$routeParams","$document","flash","TrezorDevice","deviceList","modalOpener","setupModalService","pinModalService","passphraseModalService","deviceService",function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a,b){g.forget(b),i.closeOpen(),j.closeOpen(),k.closeOpen()}function n(b,c,d,e){j.showModal(a,b,c,d,e)}function o(b,c,d){k.showModal(a,b,c,d)}function p(b,c,d){var e=["ButtonRequest_ConfirmWord","ButtonRequest_FirmwareCheck"];c.id===a.device.id&&e.indexOf(d)<0&&q(d)}function q(b){var c=h.openModal(a,"button",r(b),{code:b},void 0,b);a.device.once(f.EVENT_RECEIVE,function(){c.modal.close()}),a.device.once(f.EVENT_ERROR,function(){c.modal.close()})}function r(a){return"ButtonRequest_Address"===a?"md":"lg"}if(a.device=g.get(c.deviceId),!a.device)return void b.path("/");a.isActive=function(a){return b.path().match(a)},a.$on(f.EVENT_PREFIX+f.EVENT_PIN,n),a.$on(f.EVENT_PREFIX+f.EVENT_BUTTON,p),a.$on(f.EVENT_PREFIX+f.EVENT_PASSPHRASE,o),a.$on(l.EVENT_ASK_FORGET,m)}]),angular.module("webwalletApp").controller("DeviceInfoCtrl",["flash","$scope","$rootScope","$timeout","$document","selecter","modalOpener","deviceList","firmwareService","$location",function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(a,c){a.targetScope.changing=b._changing}function l(){return g.openModal(b,"label","md",{label:b.device.features.label||""}).result}b.learnMorePassDisplayed=!1,b.learnMorePass=function(){b.learnMorePassDisplayed=!0},b._changing=null,c.$on("modal.button.show",k),b.isLatestFirmware=!1,i.check(b.device.features).then(function(a){b.isLatestFirmware=!a}),b.changePin=function(c){b._changing="pin";var d=c?"removed":"changed";b.device.changePin(c).then(function(){a.success("PIN was successfully "+d)},function(b){a.error(b.message||"PIN change failed")}).finally(function(){b._changing=null})},b.togglePassphrase=function(c){b._changing="passphrase";var d="Disconnect your Trezor to "+(c?"enable":"disable")+" passphrase.";b.device.togglePassphrase(c).then(function(){h.forget(b.device,!0,d)},function(b){a.error(b.message||"Passphrase toggle failed")}).finally(function(){b._changing=null})},b.changeLabel=function(){l().then(function(a){return a=a.trim()||b.device.DEFAULT_LABEL,b.device.changeLabel(a)}).then(function(){a.success("Label was successfully changed")},function(b){b&&a.error(b.message||"Failed to change the device label")})}}]),angular.module("webwalletApp").controller("FirmwareCtrl",["$modal","$scope","$rootScope","$routeParams","deviceList","firmwareService","modalOpener","TrezorDevice",function(a,b,c,d,e,f,g,h){"use strict";function i(a,b,c){return b.required?l(a,b,c):j(a,b,c)}function j(a,b,d){c.optionalFirmware={device:a,firmware:b,version:d,update:function(){l(a,b,d)}}}function k(a,b){c.optionalFirmware&&c.optionalFirmware.device.id===b.id&&delete c.optionalFirmware}function l(a,b,c){n(a,b,c,u)}function m(a,b){n(a,b,void 0,x)}function n(b,d,h,i){return s=angular.extend(c.$new(),{firmware:d,version:h,device:b,update:function(){o(d)}}),q(i),f.setModalOpen(!0),r=a.open({templateUrl:"views/modal/firmware.html",size:"lg",backdrop:"static",keyboard:!1,scope:s}),g.stopBackpaceOnModal(r),r.result.then(function(){f.setModalOpen(!1)},function(){f.setModalOpen(!1),d.required&&e.forget(b,!0)}),r.result}function o(a){function b(a,b,c){c===h.REQ_BUTTON_FIRMWARE&&q(C)}var d;s.firmware=a,q(y),f.download(a).then(function(a){return d=c.$on(h.EVENT_PREFIX+h.EVENT_BUTTON,b),q(z),s.device.flash(a)}).then(function(){q(A),d()},function(a){q(B),s.error=a.message,d()})}function p(a,b){return t===A||t===B||t===x?(e.forget(b,!0),s.previousDevice&&e.forget(s.previousDevice,!0),void r.close()):t===u||t===w?void q(v):void q(u)}function q(a){t=a,s&&(s.state=a)}var r=null,s=null,t=null,u="initial",v="initial-disconnected",w="device-normal",x="device-bootloader",y="update-downloading",z="update-flashing",A="update-success",B="update-error",C="update-check";b.$on(f.EVENT_CONNECT,k),b.$on(f.EVENT_DISCONNECT,k),b.$on(f.EVENT_DISCONNECT,k),b.$on(f.EVENT_DISCONNECT,p,10),b.$on(f.EVENT_BOOTLOADER,function(a,b){s&&(s.previousDevice=s.device,s.device=b),q(x)}),b.$on(f.EVENT_NORMAL,function(){q(w)}),b.$on(f.EVENT_CANDIDATE,function(a,b){m(b.dev,b.firmware)}),b.$on(f.EVENT_OUTDATED,function(a,b){i(b.dev,b.firmware,b.version)})}]),angular.module("webwalletApp").controller("DeviceRecoveryCtrl",["bip39","flash","$scope","$location",function(a,b,c,d){"use strict";function e(a,b,d){b.id===c.device.id&&(c.seedFocus=!0,c.seedWord="",c.wordCallback=function(a){c.seedFocus=!1,c.wordCallback=null,c.seedWord="",d(null,a)})}c.recovering=!1,c.seedFocus=!1,c.seedWord="",c.seedWords=null,c.seedWordlist=a.english,c.settings={pin_protection:!0,word_count:24},c.$on("device.word",e),c.startsWith=function(a,b){return a.substr(0,b.length).toLowerCase()===b.toLowerCase()},c.recoverDevice=function(){c.settings.label&&(c.settings.label=c.settings.label.trim()),c.settings.word_count=+c.settings.word_count,c.seedWords=[],b.clear(),c.recovering=!0,c.device.recover(c.settings).then(function(){c.recovering=!1,d.path("/device/"+c.device.id+"/")},function(a){c.recovering=!1,b.error(a.message||"Recovery failed")})},c.recoverWord=function(){c.seedWords.push(c.seedWord),c.wordCallback(c.seedWord)}}]),angular.module("webwalletApp").controller("DeviceSetupCtrl",["utils","flash","$scope","modalOpener","deviceList","deviceService","setupModalService","$modal",function(a,b,c,d,e,f,g,h){"use strict";function i(a){return(a+a/32)/11}function j(){g.closeOpen()}function k(){g.showModal(c)}c.advanced=!1,c.settings={strength:256,pin_protection:!0},c.recoveryStarted=!1,c.recoveryWords=null,c.recoveryWordsDone=0,c.recoveryCurrentWord=1,c.$on("device.button",function(a,b,d){b.id===c.device.id&&"ButtonRequest_ConfirmWord"===d&&c.setupRecoveryNext()}),c.setupDevice=function(){var d=c.settings,e=c.device;d.strength=+d.strength,d.label?d.label=d.label.trim()||e.DEFAULT_LABEL:d.label=e.DEFAULT_LABEL,c.recoveryWords=i(d.strength),e.reset(d).then(function(){a.redirect("/device/"+e.id+"/").then(function(){b.success("Congratulations! Your device is now ready to use.")})},function(a){b.error(a.message||"Setup failed")})},c.setupRecoveryNext=function(){if(!c.recoveryStarted)return c.recoveryStarted=!0,c.stage="writeFirst",void k();c.recoveryWordsDone=c.recoveryWordsDone+1,c.recoveryCurrentWord=c.recoveryCurrentWord+1,c.recoveryWordsDone<c.recoveryWords?c.stage="write":c.recoveryWordsDone===c.recoveryWords?(c.recoveryCurrentWord=1,c.stage="checkFirst"):c.recoveryWordsDone<2*c.recoveryWords-1?c.stage="check":c.device.once("receive",function(){j()})}}]),angular.module("webwalletApp").controller("DeviceWipeCtrl",["$scope","$rootScope","flash","deviceList","modalOpener",function(a,b,c,d,e){"use strict";function f(a){var b;i&&(i=!1,b=null!==j,j&&(j.close(),j=null),h(b).then(function(){d.forget(a)},function(){d.navigateTo(a,!0)}),d.abortHook())}function g(){var b=e.openModal(a,"disconnect.wipe","sm");return j=b.modal,b.result}function h(b){return e.openModal(a,"forget.wipe",null,{hideSuccessMsg:b}).result}var i=!1,j=null;d.registerDisconnectHook(f,10),a.wipeDevice=function(){i=!0,a.device.wipe().then(function(){g()},function(a){i=!1,c.error(a.message||"Wiping failed")})}}]),angular.module("webwalletApp").controller("ModalPinCtrl",["$scope","deviceService","deviceList",function(a,b,c){"use strict";a.ratePin=function(b){var c=a.device.ratePin(b);return 0===c?"long":c<3e3?"weak":c<6e4?"fine":c<36e4?"strong":"ultimate"}}]),angular.module("webwalletApp").run(["$templateCache",function(a){"use strict";a.put("views/debug.button.html",'<span ng-controller=DebugCtrl ng-if=!debug.visible><button class="btn btn-xs btn-link pull-right" ng-click=debug.toggle() tooltip="Show log"><span class="glyphicon glyphicon-list"></span> <span class=sr-only>Show log</span></button></span>'),a.put("views/debug.link.html",'<span ng-controller=DebugCtrl ng-cloak><a href="" ng-click=debug.toggle()>Show log</a></span>'),a.put("views/debug.log.html",'<div ng-controller=DebugCtrl ng-cloak><div class="alert alert-flash alert-info alert-logs" ng-if=debug.visible><button type=button class=close ng-click=debug.toggle()><span aria-hidden=true>&times;</span> <span class=sr-only>Close</span></button><h4>Log</h4><textarea ng-click=debug.focus($event)>{{debug.logs}}</textarea><p>Warning: This log can contain your XPUB. When you give it to a third party, you allow it to see your whole transaction history.</p></div></div>'),a.put("views/device/advanced.html",'<div ng-controller=DeviceCtrl><div ng-controller=DeviceInfoCtrl><ng-include src="\'views/device/nav.html\'"></ng-include><div class=tab-content ng-hide=device.isEmpty()><div class=row><div class="col-xs-2 settings-left">Firmware</div><div class="col-xs-6 settings-right"><p>{{device.firmwareString()}}</p><p ng-if=isLatestFirmware>Your device has the latest firmware. If you still want to load the latest firmware to your device again, disconnect your device and then plug it in while holding both device buttons pressed.</p></div></div><div class=row><div class="col-xs-2 settings-left">Passphrase</div><div class="col-xs-6 settings-right" ng-hide=device.features.passphrase_protection ng-init="userUnderstandsPassphrase = false"><p>Passphrase encryption allows you to access new wallets, each hidden behind a particular passphrase. Your old accounts will be accessible behind an empty passphrase.</p><p><b>If you forget your passphrase, your wallet is lost for good. There is no way to recover your funds.</b></p><p><a href=https://doc.satoshilabs.com/trezor-user/advanced_settings.html#using-passphrase-encrypted-seeds>Read more in user manual</a></p><p class=checkbox><label><input type=checkbox ng-model=userUnderstandsPassphrase> OK, I understand</label></p><span tooltip="{{\n                        device.isConnected() ? null : \'Connect the device to enable passphrase.\'\n                        }}" tooltip-trigger=mouseenter tooltip-placement=right tooltip-append-to-body=true class=tooltip-trigger><button class="btn btn-default btn-sm" ng-click=togglePassphrase(true) ng-disabled="!device.isConnected() || !userUnderstandsPassphrase"><span class="glyphicon glyphicon-ok"></span> <span>Enable passphrase encryption</span></button></span></div><div class="col-xs-6 settings-right" ng-show=device.features.passphrase_protection ng-init="userUnderstandsPassphrase = false"><p><b>If you disable the passphrase encryption, your current funds will not appear.</b> You will have to enable the passphrase encryption again to see your current wallet.</p><p><a href=https://doc.satoshilabs.com/trezor-user/advanced_settings.html#using-passphrase-encrypted-seeds>Read more in user manual</a></p><p class=checkbox><label><input type=checkbox ng-model=userUnderstandsPassphrase> OK, I understand</label></p><span tooltip="{{\n                        device.isConnected() ? null : \'Connect the device to disable passphrase.\'\n                        }}" tooltip-trigger=mouseenter tooltip-placement=right tooltip-append-to-body=true class=tooltip-trigger><button class="btn btn-default btn-sm" ng-click=togglePassphrase(false) ng-disabled="!device.isConnected() || !userUnderstandsPassphrase"><span class="glyphicon glyphicon-remove hidden-xs hidden-sm hidden-md"></span> <span>Disable passphrase encryption</span></button></span></div></div><hr><div class=row ng-show=device.features.pin_protection><div class="col-xs-2 settings-left">Disable PIN</div><div class="col-xs-2 settings-btn" tooltip="{{device.isConnected()?\n                      null\n                      :\'Connect the device to disable PIN.\'\n                      }}" tooltip-trigger=mouseenter tooltip-placement=right tooltip-append-to-body=true><button class="btn btn-default btn-sm" ng-click=changePin(true) ng-disabled=!device.isConnected()><span class="glyphicon glyphicon-remove hidden-xs hidden-sm hidden-md"></span> <span>Disable PIN</span></button></div></div><div class=row ng-enabled=!device.isConnected() ng-show=device.features.pin_protection><div class=col-xs-2></div><p class="text-muted col-xs-6">Using PIN protection is highly recommended. PIN prevents unauthorized persons from stealing your bitcoins even when they get physical access to your device.</p></div><hr ng-show=device.features.pin_protection><div class=row><div class="col-xs-2 settings-left">Wipe device</div><div class="col-xs-6 wipe-text"><p>Wiping the device <b>removes all its information.</b></p><p>Use this feature only if you have your Recovery Seed or you don\'t have any coins on your device.</p><div ng-controller=DeviceWipeCtrl><div class=pull-left tooltip="{{!device.isConnected() ? \'Device needs to be connected in order to wipe it.\' : null}}" tooltip-trigger=mouseenter tooltip-placement=bottom tooltip-append-to-body=true><a class="btn btn-danger wipe-button" href="" ng-click=wipeDevice() ng-disabled=!device.isConnected()><span class="glyphicon glyphicon-fire"></span> Wipe device</a></div></div></div></div></div></div></div>'),
a.put("views/device/index.basic.html",'<div ng-controller=DeviceInfoCtrl><div class=row><div class="col-xs-2 settings-left">Label</div><div class="col-xs-2 settings-right">{{device.label()}}</div><div class="col-xs-2 settings-btn" tooltip="{{device.isConnected()?null: \'Connect the device to change the label.\'}}" tooltip-trigger=mouseenter tooltip-placement=right tooltip-append-to-body=true><button class="btn btn-default btn-sm" ng-click=changeLabel(device) ng-disabled=!device.isConnected()><span class="glyphicon glyphicon-pencil hidden-xs hidden-sm hidden-md"></span> Change label</button></div></div><div class=row><div class="col-xs-2 settings-left">PIN protection</div><div class="col-xs-2 settings-right"><span ng-show=device.features.pin_protection class=text-success>Enabled</span> <span ng-hide=device.features.pin_protection class=text-danger>Disabled</span></div><div class="col-xs-2 settings-btn" tooltip="{{device.isConnected()? \n                  null:\n                (device.features.pin_protection ? \n                    \'Connect the device to change PIN.\'\n                   :\'Connect the device to enable PIN.\'\n                )}}" tooltip-trigger=mouseenter tooltip-placement=right tooltip-append-to-body=true><button class="btn btn-default btn-sm" ng-click=changePin() ng-disabled=!device.isConnected()><span class="glyphicon glyphicon-pencil hidden-xs hidden-sm hidden-md" ng-show=device.features.pin_protection></span> <span class="glyphicon glyphicon-ok hidden-xs hidden-sm hidden-md" ng-hide=device.features.pin_protection></span> <span ng-show=device.features.pin_protection>Change PIN</span> <span ng-hide=device.features.pin_protection>Enable PIN</span></button></div></div><div class=row ng-enabled=!device.isConnected() ng-show="\n            !(device.features.pin_protection)\n            "><div class=col-xs-2></div><p class="text-muted col-xs-6">Using PIN protection is highly recommended. PIN prevents unauthorized persons from stealing your bitcoins even when they get physical access to your device.</p></div></div>'),a.put("views/device/index.html",'<div ng-controller=DeviceCtrl><fieldset class=row ng-disabled="device.status() !== \'connected\'"><div class="devsetup col-xs-8" ng-show=device.isEmpty()><ng-include src="\'views/device/index.setup.html\'"></ng-include></div><div class="devrestore col-xs-4 text-center" ng-show=device.isEmpty()><p class=help-block>Want to restore your wallet from recovery seed?</p><a class="btn btn-default" ng-href=#/device/{{device.id}}/recovery>TREZOR Recovery</a></div></fieldset><div ng-if=!(shouldDisplayLoading())><ng-include src="\'views/device/nav.html\'"></ng-include><div class=tab-content ng-hide=device.isEmpty()><ng-include src="\'views/device/index.basic.html\'"></ng-include></div></div></div>'),a.put("views/device/index.setup.html",'<form ng-controller=DeviceSetupCtrl><h3>Welcome to TREZOR Setup!</h3><p class=lead>Please take your time to read all of the instructions. Setting up your TREZOR will take only a few minutes. When you\'re done, you can start using your TREZOR.</p><div class=form-group><label for=label>Device label</label><input name=label id=label class=form-control placeholder="My TREZOR" ng-model=settings.label><p class=help-block>This label will be shown on the display when you plug your TREZOR in. This is useful if you have more than one device.</p></div><div class="form-group text-center"><button class="btn btn-lg btn-success" ng-click=setupDevice()>Continue</button></div></form>'),a.put("views/device/nav.html",'<ul class="nav nav-tabs" ng-hide=device.isEmpty()><li ng-class="{ active: isActive(\'/device/{{device.id}}$\') }"><a class=btn href=#/device/{{device.id}}><span class=glyphicon-trezor></span> Basic</a></li><li ng-class="{ active: isActive(\'/device/{{device.id}}/advanced$\') }"><a class=btn href=#/device/{{device.id}}/advanced><span class="glyphicon glyphicon-stats"></span> Advanced</a></li></ul>'),a.put("views/device/recovery.html",'<div ng-controller=DeviceCtrl><div ng-if=!device.isConnected() class="alert alert-warning"><strong>Please connect your device</strong> to access this section.</div><div ng-controller=DeviceRecoveryCtrl class=row><fieldset class=col-md-12 ng-show=recovering ng-disabled=!device.isConnected()><h4>Seed recovery</h4><div class="alert alert-info">Please follow the instructions on your device. Words are going to be entered in shuffled order.<br>Also you\'ll be asked to retype some words that are not part of your recovery seed.</div><form class=form-inline><div class=form-group><input class="form-control input-lg" ng-if=!wordCallback placeholder=Processing... disabled> <input class="input-seedword form-control input-lg" placeholder="Enter seed word" ng-model=$parent.seedWord ng-if=wordCallback focus typeahead-editable=false typeahead-on-select=recoverWord() typeahead="word for word in seedWordlist | filter:$viewValue:startsWith | limitTo:10"> <span ng-if=wordCallback class=help-block>Confirm choice by pressing enter.</span></div></form><h5 ng-show=seedWords.length>Recovered seed words:</h5><ul class="list-group seed-words"><li class=list-group-item ng-repeat="word in seedWords track by $index">{{word}}</li></ul></fieldset><fieldset class=col-md-6 ng-show=!recovering ng-disabled=!device.isConnected()><form name=form class=devrecover><div class=form-group><label for=label class=control-label>Device label</label><input name=label id=label class=form-control placeholder="My TREZOR" ng-model=settings.label></div><div class=form-group><label for=word_count class=control-label>Number of words in your recovery seed</label><input name=word_count id=word_count class=form-control slider data-slider-value=24 data-slider-min=12 data-slider-max=24 data-slider-step=6 data-slider-tooltip=hide ng-model=settings.word_count><div class="row devsetup-strength"><div class="col-sm-4 text-left">12 words</div><div class="col-sm-4 text-center">18 words</div><div class="col-sm-4 text-right">24 words</div></div></div><div class=checkbox><label><input type=checkbox name=pin-protection ng-model=settings.pin_protection> Enable PIN protection</label></div><div class=checkbox><label><input type=checkbox name=passphrase-protection ng-model=settings.passphrase_protection> Additional passphrase encryption</label></div><div class=form-group><button class="btn btn-primary" ng-disabled=!form.$valid ng-click=recoverDevice()>Continue</button> <a href=#/device/{{device.id}} class="btn btn-link">Cancel</a></div></form></fieldset></div></div>'),a.put("views/device/wipe.html",'<div ng-controller=DeviceCtrl><div ng-if=!device.isConnected() class="alert alert-warning"><strong>Please connect your device</strong> to access this section.</div><div ng-controller=DeviceWipeCtrl><fieldset ng-disabled=!device.isConnected()><div class="alert alert-danger alert-withicon alert-lg"><span class="glyphicon glyphicon-warning-sign alert-icon"></span><h4>Do you really want to wipe the device?</h4><p>All data from the device will be lost! You can recover your funds using recovery seed.<br></p><p class=alert-buttons><button class="btn btn-danger" ng-click=wipeDevice()>Wipe</button> <a href=#/device/{{device.id}} class="btn btn-link">Cancel</a></p></div></fieldset></div></div>'),a.put("views/deviceDetails.link.html",'<span ng-controller=DebugCtrl ng-cloak><a href="" ng-click=deviceDetails.toggle()>Device details</a> |</span>'),a.put("views/error.html",'<div class=row ng-if=installed><div class="col-md-6 col-md-offset-3"><div class="alert alert-danger clearfix"><h4>Transport loading failed</h4>{{errorMessage}}<ng-include src="\'views/debug.button.html\'"></ng-include></div><ng-include src="\'views/debug.log.html\'"></ng-include></div></div>'),a.put("views/error.udev.html",'<div class=row><div class="jumbotron installers col-md-6 col-md-push-3"><h3>One last step</h3><div><p>Linux users need to do one last step to get started. You can:</p><ul style="font-size: 21px"><li>Go to <a href=https://wallet.trezor.io target=_blank ng-click=closeApp()>TREZOR Wallet</a> and follow instructions there</li><li>Alternatively, you can do the following:<ol class="arabic simple"><li>Disconnect your TREZOR device.</li><li>Create new file <cite>/etc/udev/rules.d/51-trezor.rules</cite> in your favourite text editor (root privileges are necessary).</li><li>Copy the following two lines, paste them into the file and save it.</li></ol><div style="margin-top: 15px;  -webkit-user-select: text"><pre>SUBSYSTEM=="usb", ATTR{idVendor}=="534c", ATTR{idProduct}=="0001", MODE="0666", GROUP="dialout", SYMLINK+="trezor%n"\nKERNEL=="hidraw*", ATTRS{idVendor}=="534c", ATTRS{idProduct}=="0001",  MODE="0666", GROUP="dialout"</pre></div><ol class="arabic simple" start=4><li>Reconnect your device.</li></ol></li></ul></div></div></div>'),a.put("views/main.html",'<div class=row ng-controller=MainCtrl><div class="jumbotron text-center col-xs-7 col-xs-offset-2" ng-if="isEmpty() && !(udevError.errorStatus)"><p>This app is intended for a simple device management.</p><span class="glyphicon-connect-trezor main-connect-icon"></span><p>Connect your TREZOR to start.</p></div></div>'),a.put("views/modal/button.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class="modal-body text-center" ng-switch=code><div ng-switch-when=ButtonRequest_FeeOverThreshold class="alert alert-block alert-info"><h4>Fee is over threshold.</h4>Please confirm the action on your device.</div><div ng-switch-when=ButtonRequest_ConfirmWord class="alert alert-block alert-info"><h4>Please write down the recovery seed from your device.</h4></div><div ng-switch-when=ButtonRequest_Address class=address-modal><h5>Check address on TREZOR display</h5><p class=text-muted>If the address matches your TREZOR display, you can be sure it is genuine.</p><div class="list-group address-list"><span class="list-group-item address-list-item active"><span class=address-list-index>/{{address.path[address.path.length-1]}}</span> <span class=address-list-address>{{address.address}}</span></span></div><div class=address-qr><qr size=210 text=address.address correction-level="\'M\'" type-number=0 input-mode="\'8bit\'"></qr></div></div><div ng-switch-when=ButtonRequest_ProtectCall class="alert alert-warning alert-withicon alert-lg text-left" ng-if="!(device.features.passphrase_protection) && changing===\'passphrase\'"><span class="glyphicon glyphicon-warning-sign alert-icon"></span><h4>Confirm passphrase encryption</h4><p>If you forget your passphrase, you will lose your coins.</p></div><div ng-switch-when=ButtonRequest_ProtectCall class="alert alert-block alert-info" ng-if="(device.features.passphrase_protection) || changing!==\'passphrase\'"><h4>Please confirm the action on your device.</h4></div><div ng-switch-when=ButtonRequest_WipeDevice class="alert alert-warning alert-withicon alert-lg text-left"><span class="glyphicon glyphicon-warning-sign alert-icon"></span><h4>All data on your device will be deleted.</h4><p>This action cannot be undone. Please <strong>confirm on your device</strong>.</p><p>Never do this action with TREZOR holding coins unless you have your recovery seed at hand.</p></div><div ng-switch-default class="alert alert-block alert-info"><h4>Please confirm the action on your device.</h4></div></div>'),a.put("views/modal/disconnect.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><button type=button class=close title=Cancel ng-if=!disableCancel ng-click=$dismiss()>&times;</button><h4 class=modal-title>Disconnect your Trezor now</h4></div><div class=modal-body ng-if="customText==null"></div><div class=modal-body ng-if="customText!=null">{{customText}}</div><div class=modal-footer ng-if=!disableCancel><button type=button class="btn btn-default" ng-click=$dismiss()>Cancel</button></div>'),a.put("views/modal/disconnect.wipe.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><h4 class=modal-title>Wipe finished</h4></div><div class=modal-body><p class="alert alert-success">Your Trezor was successfully wiped.</p><p>Please <strong>disconnect</strong> it now.</p></div>'),a.put("views/modal/firmware.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div ng-switch=state><div ng-switch-when=initial><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title>Your device firmware is outdated</h4></div><div class=modal-body><p>Our team is constantly working on adding new features to TREZOR. To enjoy full functionality and security of your device, we strongly recommend you to update.</p><p></p><p><strong>To update the firmware, please disconnect your device and then plug it in while holding both device buttons pressed</strong>.</p><p class="alert alert-info alert-withicon"><span class="glyphicon glyphicon-info-sign alert-icon"></span> For more information <a href=http://doc.satoshilabs.com/trezor-user/updatingfirmware.html target=_blank>see the user manual</a>.</p><div class=firmware-info><h5>Firmware info</h5><dl><dt>Current firmware:</dt><dd>{{version[0]}}.{{version[1]}}.{{version[2]}}</dd><dt>Available firmware:</dt><dd>{{firmware.version[0]}}.{{firmware.version[1]}}.{{firmware.version[2]}}</dd></dl><div ng-if=firmware.changelog><h5>Changelog</h5><p class=firmware-changelog>{{firmware.changelog}}</p></div><p ng-if=firmware.notes><a ng-href={{firmware.notes}} target=_blank>Read the full release notes</a></p></div><a class="btn btn-link" href=mailto:support@bitcointrezor.com>Support needed?</a></div><div class=modal-footer ng-if=!firmware.required><button type=button class="btn btn-default" ng-click=$dismiss()>Cancel</button></div></div><div ng-switch-when=initial-disconnected><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title>Your device firmware is outdated</h4></div><div class=modal-body><p>Now plug your device in with <strong>both device buttons pressed</strong>.</p><p class="alert alert-info alert-withicon"><span class="glyphicon glyphicon-info-sign alert-icon"></span> For more information <a href=http://doc.satoshilabs.com/trezor-user/updatingfirmware.html target=_blank>see the user manual.</a></p></div></div><div ng-switch-when=device-bootloader><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title ng-if=(version)>Do you want to update the device firmware?</h4><h4 class=modal-title ng-if=!(version)>The device was plugged in a bootloader mode</h4></div><div class=modal-body><p ng-if=!(version)>You have plugged in a device in a bootloader mode. That is a special mode intended for updating the firmware. If you don\'t want to change the firmware, just unplug the device and plug it in again.</p><div class="alert alert-warning alert-withicon"><span class="glyphicon glyphicon-warning-sign alert-icon"></span><h4>Caution!</h4><p><strong>If your TREZOR is already initialized always have your Recovery seed with you before updating the firmware!</strong></p><p>In very rare cases, a firmware update might result in the need to recover the wallet from Recovery seed.</p><p><strong>For more information, <a href=http://doc.satoshilabs.com/trezor-user/updatingfirmware.html target=_blank>visit the user manual.</a></strong></p></div><div class=firmware-info><h5>Firmware info</h5><dl><dt ng-if=version>Current firmware:</dt><dd ng-if=version>{{version[0]}}.{{version[1]}}.{{version[2]}}</dd><dd ng-if=!(version)>(Current firmware version can\'t be determined in bootloader mode)</dd><dt ng-if=firmware>Available firmware:</dt><dd ng-if=firmware>{{firmware.version[0]}}.{{firmware.version[1]}}.{{firmware.version[2]}}</dd></dl><div ng-if=firmware.changelog><h5>Changelog</h5><p class=firmware-changelog>{{firmware.changelog}}</p></div><p ng-if=firmware.notes><a ng-href={{firmware.notes}} target=_blank>Read the full release notes</a></p></div></div><div class=modal-footer><a class="btn btn-link pull-left" href=mailto:support@bitcointrezor.com>Support needed?</a> <button type=button class="btn btn-primary" ng-click=update()>Yes, update</button> <button type=button class="btn btn-default" ng-if=!firmware.required ng-click=$close()>Cancel</button></div></div><div ng-switch-when=device-normal><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title>Your device firmware is outdated</h4></div><div class=modal-body><div class="alert alert-warning alert-withicon"><span class="glyphicon glyphicon-warning-sign alert-icon"></span><h4>Your TREZOR is not in the firmware update mode.</h4><p>Please reconnect it <strong>while pressing both buttons simultaneously.</strong></p></div></div><div class=modal-footer ng-if=!firmware.required><button type=button class="btn btn-default" ng-click=$close()>Cancel</button></div></div><div ng-switch-when=update-downloading><div class=modal-body><div class="alert alert-info text-center"><h4>Downloading firmware...</h4></div></div></div><div ng-switch-when=update-flashing><div class=modal-body><div class="alert alert-info text-center"><h4>Uploading firmware...</h4><p>If asked, please confirm the update on your device.</p></div></div></div><div ng-switch-when=update-check><div class=modal-body><div class="alert alert-info text-center"><h4>Please confirm the firmware fingerprint.</h4><p>Make sure the same fingerprint is displayed on the device screen.</p><div class=row><div class="col-md-6 col-md-offset-3"><samp class=samp-screen ng-if="firmware && firmware.fingerprint">{{firmware.fingerprint.substr(0, 16)}}<br>{{firmware.fingerprint.substr(16, 16)}}<br>{{firmware.fingerprint.substr(32, 16)}}<br>{{firmware.fingerprint.substr(48, 16)}}</samp></div></div></div></div></div><div ng-switch-when=update-success><div class=modal-body><div class="alert alert-success text-center"><h4>Update was successful</h4><p>Please unplug the device now.</p></div></div></div><div ng-switch-when=update-error><div class=modal-body><div class="alert alert-danger text-center"><h4>Update failed</h4><p>{{error}}</p></div></div></div></div>'),a.put("views/modal/forget.disconnected.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><h4 class=modal-title>Forget device?</h4></div><div class=modal-body></div><div class=modal-footer><button type=button class="btn btn-default" ng-click="$close(\'remember\')">Remember</button> <button type=button class="btn btn-primary" ng-click="$close(\'forget\')">Forget</button></div>'),a.put("views/modal/forget.requested.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><h4 class=modal-title>Forget device?</h4></div><div class=modal-body><p>Do you want to forget your device?</p><p class=text-muted>Forgetting only removes the device from the list on the left, your bitcoins are still safe and you can access them by reconnecting your Trezor again.</p></div><div class=modal-footer><button type=button class="btn btn-default" ng-click="$close(\'dont-forget\')">Don\'t forget</button> <button type=button class="btn btn-primary" ng-click="$close(\'forget\')">Forget</button></div>'),a.put("views/modal/forget.wipe.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><h4 class=modal-title>Wipe finished</h4></div><div class=modal-body><p class="alert alert-success" ng-if=hideSuccessMsg>Your Trezor was successfully wiped.</p></div><div class=modal-footer><button type=button class="btn btn-primary" ng-click=$close()>OK</button></div>'),a.put("views/modal/label.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title>Please enter the device label</h4></div><div class=modal-body><form class=form-inline ng-submit=$close(label)><div class=form-group><input class="form-control input-lg" size=20 autofocus placeholder={{device.DEFAULT_LABEL}} maxlength={{device.LABEL_MAX_LENGTH}} ng-model=label></div><div class=form-group><button type=submit class="btn btn-primary btn-lg">Change</button></div></form></div>'),a.put("views/modal/passphrase.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title>Please enter your passphrase</h4></div><div class=modal-body><form id=passphrase-form ng-init=installHandler()><div class=form-group><input class="form-control input-lg" size=12 autocomplete=off ng-model=values.passphrase ng-show=showPassphrase> <input type=password id=passphrase-input class="form-control input-lg" size=12 autofocus autocomplete=off ng-model=values.passphrase ng-hide=showPassphrase><div ng-show=check style="margin-top: -1px"><input class="form-control input-lg" size=12 autocomplete=off placeholder="Re-type for control" ng-model=values.passphraseCheck ng-show=showPassphrase> <input type=password class="form-control input-lg" size=12 autocomplete=off placeholder="Re-type for control" ng-model=values.passphraseCheck ng-hide=showPassphrase></div><span class=help-block>Note that passphrase is case-sensitive.</span></div><div class=form-group><div class=checkbox><label><input type=checkbox ng-model=showPassphrase ng-checked=false> Show passphrase</label></div></div><p class=text-danger ng-show="\n        check &&\n        values.passphrase &&\n        values.passphraseCheck &&\n        values.passphrase !== values.passphraseCheck">Passphrases do not match!</p><p class=text-danger ng-show="\n        values.passphrase.length > 50 ||\n        values.passphraseCheck.length > 50">Passphrase is too long!</p></form></div><div class=modal-footer><button type=button id=passphrase-submit class="btn btn-block btn-primary btn-lg" ng-disabled=!checkCorrect>Enter</button></div>'),a.put("views/modal/pin.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><form class=form-horizontal ng-submit=$close(pin) ng-controller=ModalPinCtrl><div class=modal-header><button type=button class=close title=Cancel ng-click=$dismiss()>&times;</button><h4 class=modal-title ng-switch=type><span ng-switch-when=PinMatrixRequestType_Current>Please enter current PIN:<br><small class=text-info>Look at the device for number positions.</small></span> <span ng-switch-when=PinMatrixRequestType_NewFirst>Please enter new PIN:<br><small class=text-info>Look at the device for number positions.</small></span> <span ng-switch-when=PinMatrixRequestType_NewSecond>Please re-enter new PIN:<br><small class=text-danger>Note that the positions of numbers shown on the device have changed!</small></span></h4></div><div class=modal-body><div class=pinmodal-dial><div class=form-group><span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(7)>&#9679;</button></span> <span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(8)>&#9679;</button></span> <span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(9)>&#9679;</button></span></div><div class=form-group><span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(4)>&#9679;</button></span> <span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(5)>&#9679;</button></span> <span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(6)>&#9679;</button></span></div><div class=form-group><span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(1)>&#9679;</button></span> <span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(2)>&#9679;</button></span> <span class=col-sm-4><button type=button class="btn btn-block btn-lg" ng-click=addPin(3)>&#9679;</button></span></div></div><div class=form-group><div class=pinmodal-pin><div class=pinmodal-pin-value>{{pin|password}}</div><button type=button class="btn btn-link btn-back" ng-click=delPin() ng-show=isPinSet()><span class=arrow></span> <span class="glyphicon glyphicon-remove"></span> <span class=sr-only>del</span></button></div><input type=hidden autocomplete=off ng-model=pin><div class=pinmodal-rating ng-if="pin && type !== \'PinMatrixRequestType_Current\'" ng-controller=DeviceCtrl ng-switch=ratePin(pin)><span ng-switch-when=long class=text-danger>Too Long</span> <span ng-switch-when=weak class=text-danger>Weak</span> <span ng-switch-when=fine class=text-warning>Fine</span> <span ng-switch-when=strong class=text-success>Strong</span> <span ng-switch-when=ultimate class=text-success>Ultimate</span></div></div></div><div class=modal-footer><button type=submit class="btn btn-primary btn-block btn-lg" ng-disabled="(ratePin(pin) === \'long\') || (pin.length === 0)">Enter</button><br><small class=text-muted>Lost? Check our <a href=http://doc.satoshilabs.com/trezor-user/enteringyourpin.html target=_blank>user manual</a>.</small></div></form>'),a.put("views/modal/setup.html",'<ng-include src="\'views/modal/upperheader.html\'"></ng-include><div class=modal-header><h4 class=modal-title>Recovery seed setup</h4></div><div class=modal-body ng-switch=stage><div ng-switch-when=writeFirst class="alert alert-block alert-info"><p>We will now show you {{recoveryWords}} words that will allow you to recover your accounts in case you lose your device. <strong>Please write down all these words carefully.</strong></p><hr><h4>Please write down the {{recoveryCurrentWord | ordinal}} word of your recovery seed.</h4></div><div ng-switch-when=write class="alert alert-block alert-info"><h4>Please write down the {{recoveryCurrentWord | ordinal}} word of your recovery seed.</h4></div><div ng-switch-when=checkFirst class="alert alert-block alert-info"><p>We will now show you the {{recoveryWords}} words again. <strong>Please check carefully that you wrote them down correctly.</strong></p><hr><h4>Please check the {{recoveryCurrentWord | ordinal}} word of your recovery seed.</h4></div><div ng-switch-when=check class="alert alert-block alert-info"><h4>Please check the {{recoveryCurrentWord | ordinal}} word of your recovery seed.</h4></div></div>'),a.put("views/modal/upperheader.html",'<div class=modal-upper-header><p><span class=glyphicon-trezor></span> {{device.isEmpty() ? "New device setup" : device.label()}}</p></div>'),a.put("views/topBars.html",'<div ng-controller=FirmwareCtrl><div class="alert alert-warning alertbar" ng-if=optionalFirmware><div class=container><strong>New TREZOR firmware is available.</strong> Upgrade for the newest features and bug fixes. <button class="btn btn-sm btn-warning" ng-click=optionalFirmware.update()>Show details</button></div></div></div>')}]);